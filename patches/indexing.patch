diff --git a/diagrams/dia_to_sml.dia b/diagrams/dia_to_sml.dia
index 4ae78f0..86db5a4 100644
--- a/diagrams/dia_to_sml.dia
+++ b/diagrams/dia_to_sml.dia
@@ -940,7 +940,7 @@ into its SML representation.#</dia:string>
         <dia:point val="35.1846,52.9802"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="35.1346,52.9302;66.1496,61.4302"/>
+        <dia:rectangle val="35.1346,52.9302;66.1496,59.8302"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
         <dia:point val="35.1846,52.9802"/>
@@ -949,7 +949,7 @@ into its SML representation.#</dia:string>
         <dia:real val="30.914999999999999"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="8.4000000000000004"/>
+        <dia:real val="6.8000000000000007"/>
       </dia:attribute>
       <dia:attribute name="name">
         <dia:string>#context#</dia:string>
@@ -1133,52 +1133,6 @@ into its SML representation.#</dia:string>
         </dia:composite>
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#original_parent#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::unordered_map&lt;sml::qname,sml::qname&gt;#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="value">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>#Maps a QName to its corresponding top-most parent in an inheritance tree.#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umlattribute">
-          <dia:attribute name="name">
-            <dia:string>#leaves#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::unordered_map&lt;sml::qname,std::list&lt;sml::qname&gt;&gt;#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="value">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>#All outermost derived objects in an inheritance tree.#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umlattribute">
-          <dia:attribute name="name">
             <dia:string>#top_level_module_names#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
@@ -1519,7 +1473,7 @@ into its SML representation.#</dia:string>
         <dia:point val="73.7709,62.2969"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="50.5921,61.3302;74.5209,64.6958"/>
+        <dia:rectangle val="50.5921,59.7302;74.5209,64.6958"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -1528,7 +1482,7 @@ into its SML representation.#</dia:string>
         <dia:point val="73.7709,62.2969"/>
         <dia:point val="73.7709,64.6458"/>
         <dia:point val="50.6421,64.6458"/>
-        <dia:point val="50.6421,61.3802"/>
+        <dia:point val="50.6421,59.7802"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
diff --git a/diagrams/sml.dia b/diagrams/sml.dia
index 508745e..83dffdb 100644
--- a/diagrams/sml.dia
+++ b/diagrams/sml.dia
@@ -65,13 +65,13 @@
   <dia:layer name="Background" visible="true" active="true">
     <dia:object type="UML - Class" version="0" id="O0">
       <dia:attribute name="obj_pos">
-        <dia:point val="-21,70"/>
+        <dia:point val="-20,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-21.05,69.95;-10.055,76.85"/>
+        <dia:rectangle val="-20.05,71.95;-9.055,78.85"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-21,70"/>
+        <dia:point val="-20,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="10.895"/>
@@ -296,13 +296,13 @@ representation of the primitive type.#</dia:string>
     </dia:object>
     <dia:object type="UML - Class" version="0" id="O1">
       <dia:attribute name="obj_pos">
-        <dia:point val="85.872,29.5203"/>
+        <dia:point val="104,30"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="85.822,29.4703;92.8595,32.5703"/>
+        <dia:rectangle val="103.95,29.95;110.987,33.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="85.872,29.5203"/>
+        <dia:point val="104,30"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="6.9375"/>
@@ -622,18 +622,18 @@ representation of the primitive type.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-10.105,70"/>
+        <dia:point val="-9.105,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-10.855,54.35;5.995,70.8"/>
+        <dia:rectangle val="-9.855,54.35;5.995,72.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-10.105,70"/>
-        <dia:point val="-10.105,60"/>
-        <dia:point val="5.795,60"/>
+        <dia:point val="-9.105,72"/>
+        <dia:point val="-9.105,62"/>
+        <dia:point val="5.795,62"/>
         <dia:point val="5.795,54.4"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
@@ -837,13 +837,13 @@ representation of the primitive type.#</dia:string>
     </dia:object>
     <dia:object type="UML - Class" version="0" id="O5">
       <dia:attribute name="obj_pos">
-        <dia:point val="47,30"/>
+        <dia:point val="62,30"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="46.95,29.95;75.27,41.45"/>
+        <dia:rectangle val="61.95,29.95;90.27,41.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="47,30"/>
+        <dia:point val="62,30"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="28.219999999999999"/>
@@ -1347,7 +1347,7 @@ representation of the primitive type.#</dia:string>
         <dia:point val="49.45,50"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.4,40.65;61.86,50.8"/>
+        <dia:rectangle val="49.4,40.65;76.86,50.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -1355,8 +1355,8 @@ representation of the primitive type.#</dia:string>
       <dia:attribute name="orth_points">
         <dia:point val="49.45,50"/>
         <dia:point val="49.45,46"/>
-        <dia:point val="61.11,46"/>
-        <dia:point val="61.11,41.4"/>
+        <dia:point val="76.11,46"/>
+        <dia:point val="76.11,41.4"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -1373,109 +1373,23 @@ representation of the primitive type.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="2"/>
+        <dia:connection handle="0" to="O73" connection="2"/>
         <dia:connection handle="1" to="O5" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Note" version="0" id="O7">
+    <dia:object type="UML - Message" version="0" id="O7">
       <dia:attribute name="obj_pos">
-        <dia:point val="43,16"/>
+        <dia:point val="93.385,45"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="42.95,15.95;63.585,18.55"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="43,16"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="20.535"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="2.5"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_colour">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text">
-        <dia:composite type="text">
-          <dia:attribute name="string">
-            <dia:string>#These factories generate all of the system models
-and all of the supported types within those models.#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="font">
-            <dia:font family="monospace" style="0" name="Courier"/>
-          </dia:attribute>
-          <dia:attribute name="height">
-            <dia:real val="0.80000000000000004"/>
-          </dia:attribute>
-          <dia:attribute name="pos">
-            <dia:point val="43.35,17.245"/>
-          </dia:attribute>
-          <dia:attribute name="color">
-            <dia:color val="#000000"/>
-          </dia:attribute>
-          <dia:attribute name="alignment">
-            <dia:enum val="0"/>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-    </dia:object>
-    <dia:object type="UML - Message" version="0" id="O8">
-      <dia:attribute name="obj_pos">
-        <dia:point val="43,17.25"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="34.6182,16.4983;43.0521,17.7749"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="conn_endpoints">
-        <dia:point val="43,17.25"/>
-        <dia:point val="34.685,16.9"/>
-      </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="text">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="type">
-        <dia:enum val="0"/>
-      </dia:attribute>
-      <dia:attribute name="text_pos">
-        <dia:point val="38.8426,17.5749"/>
-      </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O7" connection="3"/>
-        <dia:connection handle="1" to="O13" connection="11"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Message" version="0" id="O9">
-      <dia:attribute name="obj_pos">
-        <dia:point val="78.385,45"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="74.8866,41.0983;78.4556,45.0706"/>
+        <dia:rectangle val="89.8866,41.0983;93.4556,45.0706"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="conn_endpoints">
-        <dia:point val="78.385,45"/>
-        <dia:point val="75.22,41.4"/>
+        <dia:point val="93.385,45"/>
+        <dia:point val="90.22,41.4"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -1490,25 +1404,25 @@ and all of the supported types within those models.#</dia:string>
         <dia:enum val="0"/>
       </dia:attribute>
       <dia:attribute name="text_pos">
-        <dia:point val="76.8025,43.6999"/>
+        <dia:point val="91.8025,43.6999"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O10" connection="1"/>
+        <dia:connection handle="0" to="O8" connection="1"/>
         <dia:connection handle="1" to="O5" connection="7"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Note" version="0" id="O10">
+    <dia:object type="UML - Note" version="0" id="O8">
       <dia:attribute name="obj_pos">
-        <dia:point val="66,45"/>
+        <dia:point val="81,45"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="65.95,44.95;90.82,49.15"/>
+        <dia:rectangle val="80.95,44.95;105.82,49.15"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="66,45"/>
+        <dia:point val="81,45"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="24.77"/>
@@ -1540,7 +1454,7 @@ all types in the combined model.#</dia:string>
             <dia:real val="0.80000000000000004"/>
           </dia:attribute>
           <dia:attribute name="pos">
-            <dia:point val="66.35,46.245"/>
+            <dia:point val="81.35,46.245"/>
           </dia:attribute>
           <dia:attribute name="color">
             <dia:color val="#000000"/>
@@ -1551,7 +1465,7 @@ all types in the combined model.#</dia:string>
         </dia:composite>
       </dia:attribute>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O11">
+    <dia:object type="UML - Association" version="2" id="O9">
       <dia:attribute name="name">
         <dia:string>#throws on failure &gt;#</dia:string>
       </dia:attribute>
@@ -1589,19 +1503,19 @@ all types in the combined model.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="75.22,30"/>
+        <dia:point val="90.22,30"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="74.47,23.7234;89.5408,30.8"/>
+        <dia:rectangle val="89.47,25.25;107.669,30.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="75.22,30"/>
-        <dia:point val="75.22,24.4734"/>
-        <dia:point val="89.3408,24.4734"/>
-        <dia:point val="89.3408,29.5203"/>
+        <dia:point val="90.22,30"/>
+        <dia:point val="90.22,26"/>
+        <dia:point val="107.469,26"/>
+        <dia:point val="107.469,30"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -1622,7 +1536,7 @@ all types in the combined model.#</dia:string>
         <dia:connection handle="1" to="O1" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O12">
+    <dia:object type="UML - Class" version="0" id="O10">
       <dia:attribute name="obj_pos">
         <dia:point val="-16,-6"/>
       </dia:attribute>
@@ -1877,7 +1791,7 @@ all types in the combined model.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O13">
+    <dia:object type="UML - Class" version="0" id="O11">
       <dia:attribute name="obj_pos">
         <dia:point val="3,13"/>
       </dia:attribute>
@@ -2244,7 +2158,7 @@ all types in the combined model.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O14">
+    <dia:object type="UML - Association" version="2" id="O12">
       <dia:attribute name="name">
         <dia:string>#merges models using &gt;#</dia:string>
       </dia:attribute>
@@ -2285,7 +2199,7 @@ all types in the combined model.#</dia:string>
         <dia:point val="34.685,20.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="33.935,19.85;61.31,30.7498"/>
+        <dia:rectangle val="33.935,19.85;76.31,30.7498"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -2293,8 +2207,8 @@ all types in the combined model.#</dia:string>
       <dia:attribute name="orth_points">
         <dia:point val="34.685,20.6"/>
         <dia:point val="34.685,26"/>
-        <dia:point val="61.11,26"/>
-        <dia:point val="61.11,29.9498"/>
+        <dia:point val="76.11,26"/>
+        <dia:point val="76.11,29.9498"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -2311,11 +2225,11 @@ all types in the combined model.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O13" connection="7"/>
+        <dia:connection handle="0" to="O11" connection="7"/>
         <dia:connection handle="1" to="O5" connection="30"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O15">
+    <dia:object type="UML - Association" version="2" id="O13">
       <dia:attribute name="name">
         <dia:string>#injects system types for &gt;#</dia:string>
       </dia:attribute>
@@ -2382,11 +2296,11 @@ all types in the combined model.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O13" connection="0"/>
-        <dia:connection handle="1" to="O12" connection="6"/>
+        <dia:connection handle="0" to="O11" connection="0"/>
+        <dia:connection handle="1" to="O10" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O16">
+    <dia:object type="UML - Association" version="2" id="O14">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -2454,10 +2368,10 @@ all types in the combined model.#</dia:string>
       </dia:attribute>
       <dia:connections>
         <dia:connection handle="0" to="O2" connection="1"/>
-        <dia:connection handle="1" to="O76" connection="7"/>
+        <dia:connection handle="1" to="O74" connection="7"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Note" version="0" id="O17">
+    <dia:object type="UML - Note" version="0" id="O15">
       <dia:attribute name="obj_pos">
         <dia:point val="-123,-22"/>
       </dia:attribute>
@@ -2566,7 +2480,7 @@ All of these steps are encompassed in the SML @ref workflow.
         </dia:composite>
       </dia:attribute>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O18">
+    <dia:object type="UML - Class" version="0" id="O16">
       <dia:attribute name="obj_pos">
         <dia:point val="-32,-6"/>
       </dia:attribute>
@@ -2676,7 +2590,7 @@ All of these steps are encompassed in the SML @ref workflow.
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O19">
+    <dia:object type="UML - Association" version="2" id="O17">
       <dia:attribute name="name">
         <dia:string>#&lt; throws on failure#</dia:string>
       </dia:attribute>
@@ -2743,11 +2657,11 @@ All of these steps are encompassed in the SML @ref workflow.
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O12" connection="1"/>
-        <dia:connection handle="1" to="O18" connection="1"/>
+        <dia:connection handle="0" to="O10" connection="1"/>
+        <dia:connection handle="1" to="O16" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O20">
+    <dia:object type="UML - Association" version="2" id="O18">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -2814,11 +2728,11 @@ All of these steps are encompassed in the SML @ref workflow.
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O43" connection="1"/>
+        <dia:connection handle="0" to="O41" connection="1"/>
         <dia:connection handle="1" to="O4" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O21">
+    <dia:object type="UML - Association" version="2" id="O19">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -2885,19 +2799,19 @@ All of these steps are encompassed in the SML @ref workflow.
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O40" connection="10"/>
-        <dia:connection handle="1" to="O76" connection="5"/>
+        <dia:connection handle="0" to="O38" connection="10"/>
+        <dia:connection handle="1" to="O74" connection="5"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O22">
+    <dia:object type="UML - Class" version="0" id="O20">
       <dia:attribute name="obj_pos">
-        <dia:point val="51,121"/>
+        <dia:point val="51,124"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="50.95,120.95;57.6725,126.25"/>
+        <dia:rectangle val="50.95,123.95;57.6725,129.25"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="51,121"/>
+        <dia:point val="51,124"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="6.6225000000000005"/>
@@ -3069,15 +2983,15 @@ All of these steps are encompassed in the SML @ref workflow.
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O23">
+    <dia:object type="UML - Class" version="0" id="O21">
       <dia:attribute name="obj_pos">
-        <dia:point val="0,70"/>
+        <dia:point val="0,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-0.05,69.95;10.56,73.65"/>
+        <dia:rectangle val="-0.05,71.95;10.56,75.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="0,70"/>
+        <dia:point val="0,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="10.51"/>
@@ -3205,15 +3119,15 @@ Aggregates a group of logically related types into a unit.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O24">
+    <dia:object type="UML - Class" version="0" id="O22">
       <dia:attribute name="obj_pos">
-        <dia:point val="83,106"/>
+        <dia:point val="83,109"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="82.95,105.95;95.1,109.65"/>
+        <dia:rectangle val="82.95,108.95;95.1,112.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="83,106"/>
+        <dia:point val="83,109"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="12.050000000000001"/>
@@ -3387,15 +3301,15 @@ a concept, parent or the main properties container.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O25">
+    <dia:object type="UML - Class" version="0" id="O23">
       <dia:attribute name="obj_pos">
-        <dia:point val="41,106"/>
+        <dia:point val="41,109"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="40.95,105.95;51.56,109.65"/>
+        <dia:rectangle val="40.95,108.95;51.56,112.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="41,106"/>
+        <dia:point val="41,109"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="10.51"/>
@@ -3525,21 +3439,21 @@ generation constraints, services tend to be where all the behaviour sits.#</dia:
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O26">
+    <dia:object type="UML - Generalization" version="1" id="O24">
       <dia:attribute name="obj_pos">
-        <dia:point val="58.9125,94.6"/>
+        <dia:point val="61.9175,96.8"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="46.205,94.55;59.7625,106.05"/>
+        <dia:rectangle val="46.205,96.75;62.7675,109.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="58.9125,94.6"/>
-        <dia:point val="58.9125,101"/>
-        <dia:point val="46.255,101"/>
-        <dia:point val="46.255,106"/>
+        <dia:point val="61.9175,96.8"/>
+        <dia:point val="61.9175,104"/>
+        <dia:point val="46.255,104"/>
+        <dia:point val="46.255,109"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -3562,11 +3476,11 @@ generation constraints, services tend to be where all the behaviour sits.#</dia:
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O64" connection="6"/>
-        <dia:connection handle="1" to="O25" connection="1"/>
+        <dia:connection handle="0" to="O62" connection="6"/>
+        <dia:connection handle="1" to="O23" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O27">
+    <dia:object type="UML - Association" version="2" id="O25">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -3604,19 +3518,19 @@ generation constraints, services tend to be where all the behaviour sits.#</dia:
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="46.255,109.6"/>
+        <dia:point val="46.255,112.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="45.505,108.85;54.5113,121.8"/>
+        <dia:rectangle val="45.505,111.85;54.5113,124.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="46.255,109.6"/>
-        <dia:point val="46.255,116"/>
-        <dia:point val="54.3113,116"/>
-        <dia:point val="54.3113,121"/>
+        <dia:point val="46.255,112.6"/>
+        <dia:point val="46.255,119"/>
+        <dia:point val="54.3113,119"/>
+        <dia:point val="54.3113,124"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -3633,19 +3547,19 @@ generation constraints, services tend to be where all the behaviour sits.#</dia:
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O25" connection="6"/>
-        <dia:connection handle="1" to="O22" connection="1"/>
+        <dia:connection handle="0" to="O23" connection="6"/>
+        <dia:connection handle="1" to="O20" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O28">
+    <dia:object type="UML - Class" version="0" id="O26">
       <dia:attribute name="obj_pos">
-        <dia:point val="59,106"/>
+        <dia:point val="59,109"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="58.95,105.95;63.4,109.05"/>
+        <dia:rectangle val="58.95,108.95;63.4,112.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="59,106"/>
+        <dia:point val="59,109"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="4.3499999999999996"/>
@@ -3747,21 +3661,21 @@ generation constraints, services tend to be where all the behaviour sits.#</dia:
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O29">
+    <dia:object type="UML - Generalization" version="1" id="O27">
       <dia:attribute name="obj_pos">
-        <dia:point val="58.9125,94.6"/>
+        <dia:point val="61.9175,96.8"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="58.0625,94.55;61.225,106.05"/>
+        <dia:rectangle val="61.0675,96.75;62.7675,109.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="58.9125,94.6"/>
-        <dia:point val="58.9125,101"/>
-        <dia:point val="61.175,101"/>
-        <dia:point val="61.175,106"/>
+        <dia:point val="61.9175,96.8"/>
+        <dia:point val="61.9175,104"/>
+        <dia:point val="61.175,104"/>
+        <dia:point val="61.175,109"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -3784,19 +3698,19 @@ generation constraints, services tend to be where all the behaviour sits.#</dia:
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O64" connection="6"/>
-        <dia:connection handle="1" to="O28" connection="1"/>
+        <dia:connection handle="0" to="O62" connection="6"/>
+        <dia:connection handle="1" to="O26" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O30">
+    <dia:object type="UML - Class" version="0" id="O28">
       <dia:attribute name="obj_pos">
-        <dia:point val="70,106"/>
+        <dia:point val="70,109"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="69.95,105.95;75.21,109.05"/>
+        <dia:rectangle val="69.95,108.95;75.21,112.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="70,106"/>
+        <dia:point val="70,109"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="5.1600000000000001"/>
@@ -3903,21 +3817,21 @@ underlying storage (for example, a relational database).#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O31">
+    <dia:object type="UML - Generalization" version="1" id="O29">
       <dia:attribute name="obj_pos">
-        <dia:point val="58.9125,94.6"/>
+        <dia:point val="61.9175,96.8"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="58.0625,94.55;72.63,106.05"/>
+        <dia:rectangle val="61.0675,96.75;72.63,109.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="58.9125,94.6"/>
-        <dia:point val="58.9125,101"/>
-        <dia:point val="72.58,101"/>
-        <dia:point val="72.58,106"/>
+        <dia:point val="61.9175,96.8"/>
+        <dia:point val="61.9175,104"/>
+        <dia:point val="72.58,104"/>
+        <dia:point val="72.58,109"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -3940,19 +3854,19 @@ underlying storage (for example, a relational database).#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O64" connection="6"/>
-        <dia:connection handle="1" to="O30" connection="1"/>
+        <dia:connection handle="0" to="O62" connection="6"/>
+        <dia:connection handle="1" to="O28" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O32">
+    <dia:object type="UML - Class" version="0" id="O30">
       <dia:attribute name="obj_pos">
-        <dia:point val="47,70"/>
+        <dia:point val="47,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="46.95,69.95;57.56,73.65"/>
+        <dia:rectangle val="46.95,71.95;57.56,75.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="47,70"/>
+        <dia:point val="47,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="10.51"/>
@@ -4078,7 +3992,7 @@ underlying storage (for example, a relational database).#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Message" version="0" id="O33">
+    <dia:object type="UML - Message" version="0" id="O31">
       <dia:attribute name="obj_pos">
         <dia:point val="25.225,38"/>
       </dia:attribute>
@@ -4108,11 +4022,11 @@ underlying storage (for example, a relational database).#</dia:string>
         <dia:point val="25.7425,37.0999"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O34" connection="1"/>
-        <dia:connection handle="1" to="O36" connection="6"/>
+        <dia:connection handle="0" to="O32" connection="1"/>
+        <dia:connection handle="1" to="O34" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Note" version="0" id="O34">
+    <dia:object type="UML - Note" version="0" id="O32">
       <dia:attribute name="obj_pos">
         <dia:point val="19,38"/>
       </dia:attribute>
@@ -4165,7 +4079,7 @@ all types in the merged model.#</dia:string>
         </dia:composite>
       </dia:attribute>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O35">
+    <dia:object type="UML - Association" version="2" id="O33">
       <dia:attribute name="name">
         <dia:string>#resolves all types using &gt;#</dia:string>
       </dia:attribute>
@@ -4232,11 +4146,11 @@ all types in the merged model.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O13" connection="5"/>
-        <dia:connection handle="1" to="O36" connection="1"/>
+        <dia:connection handle="0" to="O11" connection="5"/>
+        <dia:connection handle="1" to="O34" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O36">
+    <dia:object type="UML - Class" version="0" id="O34">
       <dia:attribute name="obj_pos">
         <dia:point val="16,30"/>
       </dia:attribute>
@@ -4491,7 +4405,7 @@ all types in the merged model.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O37">
+    <dia:object type="UML - Association" version="2" id="O35">
       <dia:attribute name="name">
         <dia:string>#&lt; resolves types in#</dia:string>
       </dia:attribute>
@@ -4558,11 +4472,11 @@ all types in the merged model.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O36" connection="7"/>
-        <dia:connection handle="1" to="O75" connection="0"/>
+        <dia:connection handle="0" to="O34" connection="7"/>
+        <dia:connection handle="1" to="O73" connection="0"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O38">
+    <dia:object type="UML - Class" version="0" id="O36">
       <dia:attribute name="obj_pos">
         <dia:point val="-2,30"/>
       </dia:attribute>
@@ -4672,7 +4586,7 @@ all types in the merged model.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O39">
+    <dia:object type="UML - Association" version="2" id="O37">
       <dia:attribute name="name">
         <dia:string>#&lt; throws on failure#</dia:string>
       </dia:attribute>
@@ -4739,11 +4653,11 @@ all types in the merged model.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O36" connection="5"/>
-        <dia:connection handle="1" to="O38" connection="6"/>
+        <dia:connection handle="0" to="O34" connection="5"/>
+        <dia:connection handle="1" to="O36" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O40">
+    <dia:object type="UML - Class" version="0" id="O38">
       <dia:attribute name="obj_pos">
         <dia:point val="-39,50"/>
       </dia:attribute>
@@ -4879,7 +4793,7 @@ all types in the merged model.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O41">
+    <dia:object type="UML - Class" version="0" id="O39">
       <dia:attribute name="obj_pos">
         <dia:point val="-21,50"/>
       </dia:attribute>
@@ -5017,7 +4931,7 @@ for Java, etc.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O42">
+    <dia:object type="UML - Class" version="0" id="O40">
       <dia:attribute name="obj_pos">
         <dia:point val="-66,50"/>
       </dia:attribute>
@@ -5151,7 +5065,7 @@ for Java, etc.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O43">
+    <dia:object type="UML - Class" version="0" id="O41">
       <dia:attribute name="obj_pos">
         <dia:point val="-92,50"/>
       </dia:attribute>
@@ -5285,12 +5199,12 @@ for Java, etc.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O44">
+    <dia:object type="UML - Generalization" version="1" id="O42">
       <dia:attribute name="obj_pos">
         <dia:point val="-15.5525,53.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-60.795,53.55;-14.7025,69.9998"/>
+        <dia:rectangle val="-70.795,53.55;-14.7025,71.9999"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -5298,8 +5212,8 @@ for Java, etc.#</dia:string>
       <dia:attribute name="orth_points">
         <dia:point val="-15.5525,53.6"/>
         <dia:point val="-15.5525,60"/>
-        <dia:point val="-60.745,60"/>
-        <dia:point val="-60.745,69.9498"/>
+        <dia:point val="-70.745,60"/>
+        <dia:point val="-70.745,71.9499"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -5322,16 +5236,16 @@ for Java, etc.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O41" connection="6"/>
-        <dia:connection handle="1" to="O47" connection="10"/>
+        <dia:connection handle="0" to="O39" connection="6"/>
+        <dia:connection handle="1" to="O45" connection="10"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O45">
+    <dia:object type="UML - Generalization" version="1" id="O43">
       <dia:attribute name="obj_pos">
         <dia:point val="-58.2425,53.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-60.795,53.55;-57.3925,70.05"/>
+        <dia:rectangle val="-70.795,53.55;-57.3925,72.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -5339,8 +5253,8 @@ for Java, etc.#</dia:string>
       <dia:attribute name="orth_points">
         <dia:point val="-58.2425,53.6"/>
         <dia:point val="-58.2425,60"/>
-        <dia:point val="-60.745,60"/>
-        <dia:point val="-60.745,70"/>
+        <dia:point val="-70.745,60"/>
+        <dia:point val="-70.745,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -5363,16 +5277,16 @@ for Java, etc.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O42" connection="6"/>
-        <dia:connection handle="1" to="O47" connection="1"/>
+        <dia:connection handle="0" to="O40" connection="6"/>
+        <dia:connection handle="1" to="O45" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O46">
+    <dia:object type="UML - Generalization" version="1" id="O44">
       <dia:attribute name="obj_pos">
         <dia:point val="-36.44,53.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-60.795,53.55;-35.59,70.05"/>
+        <dia:rectangle val="-70.795,53.55;-35.59,72.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -5380,8 +5294,8 @@ for Java, etc.#</dia:string>
       <dia:attribute name="orth_points">
         <dia:point val="-36.44,53.6"/>
         <dia:point val="-36.44,60"/>
-        <dia:point val="-60.745,60"/>
-        <dia:point val="-60.745,70"/>
+        <dia:point val="-70.745,60"/>
+        <dia:point val="-70.745,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -5404,19 +5318,19 @@ for Java, etc.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O40" connection="6"/>
-        <dia:connection handle="1" to="O47" connection="1"/>
+        <dia:connection handle="0" to="O38" connection="6"/>
+        <dia:connection handle="1" to="O45" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O47">
+    <dia:object type="UML - Class" version="0" id="O45">
       <dia:attribute name="obj_pos">
-        <dia:point val="-66,70"/>
+        <dia:point val="-76,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-66.05,69.95;-55.44,73.65"/>
+        <dia:rectangle val="-76.05,71.95;-65.44,75.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-66,70"/>
+        <dia:point val="-76,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="10.51"/>
@@ -5542,12 +5456,12 @@ for Java, etc.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O48">
+    <dia:object type="UML - Generalization" version="1" id="O46">
       <dia:attribute name="obj_pos">
         <dia:point val="-85.205,53.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-86.055,53.55;-60.695,70.05"/>
+        <dia:rectangle val="-86.055,53.55;-70.695,72.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
@@ -5555,8 +5469,8 @@ for Java, etc.#</dia:string>
       <dia:attribute name="orth_points">
         <dia:point val="-85.205,53.6"/>
         <dia:point val="-85.205,60"/>
-        <dia:point val="-60.745,60"/>
-        <dia:point val="-60.745,70"/>
+        <dia:point val="-70.745,60"/>
+        <dia:point val="-70.745,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -5579,25 +5493,25 @@ for Java, etc.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O43" connection="6"/>
-        <dia:connection handle="1" to="O47" connection="1"/>
+        <dia:connection handle="0" to="O41" connection="6"/>
+        <dia:connection handle="1" to="O45" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O49">
+    <dia:object type="UML - Class" version="0" id="O47">
       <dia:attribute name="obj_pos">
-        <dia:point val="-47,70"/>
+        <dia:point val="-56,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-47.05,69.95;-34.13,73.65"/>
+        <dia:rectangle val="-56.05,71.95;-29.27,77.25"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-47,70"/>
+        <dia:point val="-56,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="12.82"/>
+        <dia:real val="26.68"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="3.6000000000000001"/>
+        <dia:real val="5.2000000000000011"/>
       </dia:attribute>
       <dia:attribute name="name">
         <dia:string>#Stateful#</dia:string>
@@ -5689,7 +5603,7 @@ for Java, etc.#</dia:string>
       <dia:attribute name="attributes">
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#properties#</dia:string>
+            <dia:string>#all_properties#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
             <dia:string>#std::list&lt;property&gt;#</dia:string>
@@ -5698,9 +5612,62 @@ for Java, etc.#</dia:string>
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#State of this entity.
+            <dia:string>#All the properties associated with this type.
+
+This is a union of the following sets:
+
+@li the set of all properies obtained via inheritance relationships;
+@li the set of all properies obtained via modeling of concepts, including any refinements;
+@li the set of all properies directly associated with the type (local).
 
-Does not include inherited attributes.#</dia:string>
+The first and third sets are cached in this object. The second isn't as we do
+not have a need for it.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#local_properties#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#std::list&lt;property&gt;#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#The set of all properies directly associated with the type.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#inherited_properties#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#std::unordered_map&lt;qname,std::list&lt;property&gt;&gt;#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string># The set of all properies obtained via inheritance, by parent name.#</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -5719,7 +5686,7 @@ Does not include inherited attributes.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O50">
+    <dia:object type="UML - Class" version="0" id="O48">
       <dia:attribute name="obj_pos">
         <dia:point val="-69,87"/>
       </dia:attribute>
@@ -5829,20 +5796,20 @@ Does not include inherited attributes.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O51">
+    <dia:object type="UML - Generalization" version="1" id="O49">
       <dia:attribute name="obj_pos">
-        <dia:point val="-40.59,73.6"/>
+        <dia:point val="-42.66,77.2"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-66.6825,73.55;-39.74,87.05"/>
+        <dia:rectangle val="-66.6825,77.15;-41.81,87.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-40.59,73.6"/>
-        <dia:point val="-40.59,81"/>
-        <dia:point val="-66.6325,81"/>
+        <dia:point val="-42.66,77.2"/>
+        <dia:point val="-42.66,83"/>
+        <dia:point val="-66.6325,83"/>
         <dia:point val="-66.6325,87"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
@@ -5866,24 +5833,24 @@ Does not include inherited attributes.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O49" connection="6"/>
-        <dia:connection handle="1" to="O50" connection="1"/>
+        <dia:connection handle="0" to="O47" connection="6"/>
+        <dia:connection handle="1" to="O48" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O52">
+    <dia:object type="UML - Generalization" version="1" id="O50">
       <dia:attribute name="obj_pos">
-        <dia:point val="-60.745,73.6"/>
+        <dia:point val="-70.745,75.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-66.6825,73.55;-59.895,87.05"/>
+        <dia:rectangle val="-71.595,75.55;-66.5825,87.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-60.745,73.6"/>
-        <dia:point val="-60.745,81"/>
-        <dia:point val="-66.6325,81"/>
+        <dia:point val="-70.745,75.6"/>
+        <dia:point val="-70.745,83"/>
+        <dia:point val="-66.6325,83"/>
         <dia:point val="-66.6325,87"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
@@ -5907,11 +5874,11 @@ Does not include inherited attributes.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O47" connection="6"/>
-        <dia:connection handle="1" to="O50" connection="1"/>
+        <dia:connection handle="0" to="O45" connection="6"/>
+        <dia:connection handle="1" to="O48" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O53">
+    <dia:object type="UML - Association" version="2" id="O51">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -5952,16 +5919,16 @@ Does not include inherited attributes.#</dia:string>
         <dia:point val="22,58.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="5.205,57.65;22.75,70.7502"/>
+        <dia:rectangle val="5.205,57.65;22.75,72.7528"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
         <dia:point val="22,58.4"/>
-        <dia:point val="22,65"/>
-        <dia:point val="5.255,65"/>
-        <dia:point val="5.255,69.9502"/>
+        <dia:point val="22,66"/>
+        <dia:point val="5.255,66"/>
+        <dia:point val="5.255,71.9528"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -5978,11 +5945,11 @@ Does not include inherited attributes.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="5"/>
-        <dia:connection handle="1" to="O23" connection="10"/>
+        <dia:connection handle="0" to="O73" connection="5"/>
+        <dia:connection handle="1" to="O21" connection="10"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O54">
+    <dia:object type="UML - Association" version="2" id="O52">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -6023,16 +5990,16 @@ Does not include inherited attributes.#</dia:string>
         <dia:point val="49.45,58.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="48.7,57.65;52.455,70.8"/>
+        <dia:rectangle val="48.7,57.65;52.455,72.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
         <dia:point val="49.45,58.4"/>
-        <dia:point val="49.45,65"/>
-        <dia:point val="52.255,65"/>
-        <dia:point val="52.255,70"/>
+        <dia:point val="49.45,66"/>
+        <dia:point val="52.255,66"/>
+        <dia:point val="52.255,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -6049,19 +6016,19 @@ Does not include inherited attributes.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="7"/>
-        <dia:connection handle="1" to="O32" connection="1"/>
+        <dia:connection handle="0" to="O73" connection="7"/>
+        <dia:connection handle="1" to="O30" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O55">
+    <dia:object type="UML - Class" version="0" id="O53">
       <dia:attribute name="obj_pos">
-        <dia:point val="33,83"/>
+        <dia:point val="30,86"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="32.95,82.95;37.6225,86.05"/>
+        <dia:rectangle val="29.95,85.95;34.6225,89.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="33,83"/>
+        <dia:point val="30,86"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="4.5724999999999998"/>
@@ -6163,15 +6130,15 @@ Does not include inherited attributes.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O56">
+    <dia:object type="UML - Class" version="0" id="O54">
       <dia:attribute name="obj_pos">
-        <dia:point val="26,70"/>
+        <dia:point val="26,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="25.95,69.95;35.02,73.05"/>
+        <dia:rectangle val="25.95,71.95;35.02,75.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="26,70"/>
+        <dia:point val="26,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="8.9700000000000006"/>
@@ -6273,21 +6240,21 @@ Does not include inherited attributes.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O57">
+    <dia:object type="UML - Generalization" version="1" id="O55">
       <dia:attribute name="obj_pos">
-        <dia:point val="30.485,73"/>
+        <dia:point val="30.485,75"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="29.635,72.95;35.3363,83.05"/>
+        <dia:rectangle val="29.635,74.95;32.3363,86.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="30.485,73"/>
-        <dia:point val="30.485,78"/>
-        <dia:point val="35.2863,78"/>
-        <dia:point val="35.2863,83"/>
+        <dia:point val="30.485,75"/>
+        <dia:point val="30.485,81"/>
+        <dia:point val="32.2863,81"/>
+        <dia:point val="32.2863,86"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -6310,11 +6277,11 @@ Does not include inherited attributes.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O56" connection="6"/>
-        <dia:connection handle="1" to="O55" connection="1"/>
+        <dia:connection handle="0" to="O54" connection="6"/>
+        <dia:connection handle="1" to="O53" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O58">
+    <dia:object type="UML - Association" version="2" id="O56">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -6355,16 +6322,16 @@ Does not include inherited attributes.#</dia:string>
         <dia:point val="35.725,58.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="30.435,57.65;36.475,70.8"/>
+        <dia:rectangle val="30.435,57.65;36.475,72.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
         <dia:point val="35.725,58.4"/>
-        <dia:point val="35.725,65"/>
-        <dia:point val="30.485,65"/>
-        <dia:point val="30.485,70"/>
+        <dia:point val="35.725,66"/>
+        <dia:point val="30.485,66"/>
+        <dia:point val="30.485,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -6381,19 +6348,19 @@ Does not include inherited attributes.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="6"/>
-        <dia:connection handle="1" to="O56" connection="1"/>
+        <dia:connection handle="0" to="O73" connection="6"/>
+        <dia:connection handle="1" to="O54" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O59">
+    <dia:object type="UML - Class" version="0" id="O57">
       <dia:attribute name="obj_pos">
-        <dia:point val="7,83"/>
+        <dia:point val="4,86"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="6.95,82.95;21.795,87.45"/>
+        <dia:rectangle val="3.95,85.95;18.795,90.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="7,83"/>
+        <dia:point val="4,86"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="14.744999999999999"/>
@@ -6542,15 +6509,15 @@ Does not include inherited attributes.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O60">
+    <dia:object type="UML - Class" version="0" id="O58">
       <dia:attribute name="obj_pos">
-        <dia:point val="3,96"/>
+        <dia:point val="0,100"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="2.95,95.95;10.865,100.45"/>
+        <dia:rectangle val="-0.05,99.95;7.865,104.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="3,96"/>
+        <dia:point val="0,100"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="7.8150000000000004"/>
@@ -6703,7 +6670,7 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O61">
+    <dia:object type="UML - Association" version="2" id="O59">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -6741,19 +6708,19 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="14.3725,87.4"/>
+        <dia:point val="11.3725,90.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="6.8575,86.65;15.1225,96.8"/>
+        <dia:rectangle val="3.8575,89.65;12.1225,100.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="14.3725,87.4"/>
-        <dia:point val="14.3725,92"/>
-        <dia:point val="6.9075,92"/>
-        <dia:point val="6.9075,96"/>
+        <dia:point val="11.3725,90.4"/>
+        <dia:point val="11.3725,96"/>
+        <dia:point val="3.9075,96"/>
+        <dia:point val="3.9075,100"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -6770,25 +6737,25 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O59" connection="6"/>
-        <dia:connection handle="1" to="O60" connection="1"/>
+        <dia:connection handle="0" to="O57" connection="6"/>
+        <dia:connection handle="1" to="O58" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O62">
+    <dia:object type="UML - Generalization" version="1" id="O60">
       <dia:attribute name="obj_pos">
-        <dia:point val="30.485,73"/>
+        <dia:point val="30.485,75"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="14.3225,72.95;31.335,83.05"/>
+        <dia:rectangle val="11.3225,74.95;31.335,86.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="30.485,73"/>
-        <dia:point val="30.485,78"/>
-        <dia:point val="14.3725,78"/>
-        <dia:point val="14.3725,83"/>
+        <dia:point val="30.485,75"/>
+        <dia:point val="30.485,81"/>
+        <dia:point val="11.3725,81"/>
+        <dia:point val="11.3725,86"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -6811,25 +6778,25 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O56" connection="6"/>
-        <dia:connection handle="1" to="O59" connection="1"/>
+        <dia:connection handle="0" to="O54" connection="6"/>
+        <dia:connection handle="1" to="O57" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O63">
+    <dia:object type="UML - Generalization" version="1" id="O61">
       <dia:attribute name="obj_pos">
-        <dia:point val="30.485,73"/>
+        <dia:point val="30.485,75"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="29.635,72.95;58.9625,83.05"/>
+        <dia:rectangle val="29.635,74.95;61.9675,86.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="30.485,73"/>
-        <dia:point val="30.485,78"/>
-        <dia:point val="58.9125,78"/>
-        <dia:point val="58.9125,83"/>
+        <dia:point val="30.485,75"/>
+        <dia:point val="30.485,81"/>
+        <dia:point val="61.9175,81"/>
+        <dia:point val="61.9175,86"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -6852,25 +6819,25 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O56" connection="6"/>
-        <dia:connection handle="1" to="O64" connection="1"/>
+        <dia:connection handle="0" to="O54" connection="6"/>
+        <dia:connection handle="1" to="O62" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O64">
+    <dia:object type="UML - Class" version="0" id="O62">
       <dia:attribute name="obj_pos">
-        <dia:point val="50,83"/>
+        <dia:point val="48,86"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.95,82.95;67.875,94.65"/>
+        <dia:rectangle val="47.95,85.95;75.885,96.85"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="50,83"/>
+        <dia:point val="48,86"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="17.824999999999999"/>
+        <dia:real val="27.835000000000001"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="11.6"/>
+        <dia:real val="10.799999999999999"/>
       </dia:attribute>
       <dia:attribute name="name">
         <dia:string>#abstract_object#</dia:string>
@@ -6962,16 +6929,16 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
       <dia:attribute name="attributes">
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#parent_name#</dia:string>
+            <dia:string>#relationships#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
-            <dia:string>#boost::optional&lt;qname&gt;#</dia:string>
+            <dia:string>#std::unordered_map&lt;relationship_types,std::list&lt;qname&gt;&gt;#</dia:string>
           </dia:attribute>
           <dia:attribute name="value">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#Qualified name for the object's parent, if it it has one.#</dia:string>
+            <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -6985,16 +6952,16 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         </dia:composite>
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#original_parent_name#</dia:string>
+            <dia:string>#number_of_type_arguments#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
-            <dia:string>#boost::optional&lt;qname&gt;#</dia:string>
+            <dia:string>#unsigned int#</dia:string>
           </dia:attribute>
           <dia:attribute name="value">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#Qualified name for the root of the inheritance hierarchy, if the object is part of one.#</dia:string>
+            <dia:string>#How many type arguments does this type have#</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -7008,16 +6975,16 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         </dia:composite>
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#leaves#</dia:string>
+            <dia:string>#is_parent#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
-            <dia:string>#std::list&lt;qname&gt;#</dia:string>
+            <dia:string>#bool#</dia:string>
           </dia:attribute>
           <dia:attribute name="value">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#All concrete types which are indirectly or directly derived from this type.#</dia:string>
+            <dia:string>#True if this class is the parent of one or more classes, false otherwise.#</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -7031,7 +6998,7 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         </dia:composite>
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#is_parent#</dia:string>
+            <dia:string>#is_child#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
             <dia:string>#bool#</dia:string>
@@ -7040,7 +7007,7 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#True if this class is the parent of one or more classes, false otherwise.#</dia:string>
+            <dia:string>#If true, the type has at least one parent.#</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -7054,16 +7021,18 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         </dia:composite>
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#number_of_type_arguments#</dia:string>
+            <dia:string>#is_visitable#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
-            <dia:string>#unsigned int#</dia:string>
+            <dia:string>#bool#</dia:string>
           </dia:attribute>
           <dia:attribute name="value">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#How many type arguments does this type have#</dia:string>
+            <dia:string>#If true, a visitor is to be generated for this type and its descendants.
+
+Only applicable if is_parent is true.#</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -7077,7 +7046,7 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
         </dia:composite>
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#is_visitable#</dia:string>
+            <dia:string>#is_inheritance_root#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
             <dia:string>#bool#</dia:string>
@@ -7086,9 +7055,7 @@ It must be castable to instance of the type defined in the enumeration.#</dia:st
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="comment">
-            <dia:string>#If true, a visitor is to be generated for this type and its descendants.
-
-Only applicable if is_parent is true.#</dia:string>
+            <dia:string>#True if the type is at the top of an inheritance hierarchy.#</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -7195,29 +7162,6 @@ or other comparable model types.#</dia:string>
             <dia:boolean val="false"/>
           </dia:attribute>
         </dia:composite>
-        <dia:composite type="umlattribute">
-          <dia:attribute name="name">
-            <dia:string>#modeled_concepts#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::list&lt;qname&gt;#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="value">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>#List of concepts modeled by this object.#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-        </dia:composite>
       </dia:attribute>
       <dia:attribute name="operations"/>
       <dia:attribute name="template">
@@ -7225,15 +7169,15 @@ or other comparable model types.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O65">
+    <dia:object type="UML - Class" version="0" id="O63">
       <dia:attribute name="obj_pos">
-        <dia:point val="23,106"/>
+        <dia:point val="23,109"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="22.95,105.95;33.56,109.65"/>
+        <dia:rectangle val="22.95,108.95;33.56,112.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="23,106"/>
+        <dia:point val="23,109"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="10.51"/>
@@ -7363,15 +7307,15 @@ object.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O66">
+    <dia:object type="UML - Class" version="0" id="O64">
       <dia:attribute name="obj_pos">
-        <dia:point val="18,121"/>
+        <dia:point val="18,124"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="17.95,120.95;27.0925,129.45"/>
+        <dia:rectangle val="17.95,123.95;27.0925,132.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="18,121"/>
+        <dia:point val="18,124"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="9.0425000000000004"/>
@@ -7635,7 +7579,7 @@ object.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O67">
+    <dia:object type="UML - Association" version="2" id="O65">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -7673,19 +7617,19 @@ object.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="28.255,109.6"/>
+        <dia:point val="28.255,112.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="22.4713,108.85;29.005,121.8"/>
+        <dia:rectangle val="22.4713,111.85;29.005,124.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="28.255,109.6"/>
-        <dia:point val="28.255,116"/>
-        <dia:point val="22.5213,116"/>
-        <dia:point val="22.5213,121"/>
+        <dia:point val="28.255,112.6"/>
+        <dia:point val="28.255,119"/>
+        <dia:point val="22.5213,119"/>
+        <dia:point val="22.5213,124"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -7702,25 +7646,25 @@ object.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O65" connection="6"/>
-        <dia:connection handle="1" to="O66" connection="1"/>
+        <dia:connection handle="0" to="O63" connection="6"/>
+        <dia:connection handle="1" to="O64" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O68">
+    <dia:object type="UML - Generalization" version="1" id="O66">
       <dia:attribute name="obj_pos">
-        <dia:point val="58.9125,94.6"/>
+        <dia:point val="61.9175,96.8"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="28.205,94.55;59.7625,106.05"/>
+        <dia:rectangle val="28.205,96.75;62.7675,109.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="58.9125,94.6"/>
-        <dia:point val="58.9125,101"/>
-        <dia:point val="28.255,101"/>
-        <dia:point val="28.255,106"/>
+        <dia:point val="61.9175,96.8"/>
+        <dia:point val="61.9175,104"/>
+        <dia:point val="28.255,104"/>
+        <dia:point val="28.255,109"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -7743,25 +7687,25 @@ object.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O64" connection="6"/>
-        <dia:connection handle="1" to="O65" connection="1"/>
+        <dia:connection handle="0" to="O62" connection="6"/>
+        <dia:connection handle="1" to="O63" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O69">
+    <dia:object type="UML - Generalization" version="1" id="O67">
       <dia:attribute name="obj_pos">
-        <dia:point val="58.9125,94.6"/>
+        <dia:point val="61.9175,96.8"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="58.0625,94.55;89.075,106"/>
+        <dia:rectangle val="61.0675,96.75;89.075,109"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="58.9125,94.6"/>
-        <dia:point val="58.9125,101"/>
-        <dia:point val="89.025,101"/>
-        <dia:point val="89.025,105.95"/>
+        <dia:point val="61.9175,96.8"/>
+        <dia:point val="61.9175,104"/>
+        <dia:point val="89.025,104"/>
+        <dia:point val="89.025,108.95"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -7784,19 +7728,19 @@ object.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O64" connection="6"/>
-        <dia:connection handle="1" to="O24" connection="12"/>
+        <dia:connection handle="0" to="O62" connection="6"/>
+        <dia:connection handle="1" to="O22" connection="12"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O70">
+    <dia:object type="UML - Class" version="0" id="O68">
       <dia:attribute name="obj_pos">
-        <dia:point val="73,121"/>
+        <dia:point val="73,124"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="72.95,120.95;88.18,125.45"/>
+        <dia:rectangle val="72.95,123.95;88.18,128.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="73,121"/>
+        <dia:point val="73,124"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="15.130000000000001"/>
@@ -7952,21 +7896,21 @@ key and the @e unversioned key. The first will contain the version property.#</d
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O71">
+    <dia:object type="UML - Generalization" version="1" id="O69">
       <dia:attribute name="obj_pos">
-        <dia:point val="89.025,109.6"/>
+        <dia:point val="89.025,112.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="80.515,109.55;89.875,121"/>
+        <dia:rectangle val="80.515,112.55;89.875,124"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="89.025,109.6"/>
-        <dia:point val="89.025,116"/>
-        <dia:point val="80.565,116"/>
-        <dia:point val="80.565,120.95"/>
+        <dia:point val="89.025,112.6"/>
+        <dia:point val="89.025,119"/>
+        <dia:point val="80.565,119"/>
+        <dia:point val="80.565,123.95"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -7989,19 +7933,19 @@ key and the @e unversioned key. The first will contain the version property.#</d
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O24" connection="6"/>
-        <dia:connection handle="1" to="O70" connection="12"/>
+        <dia:connection handle="0" to="O22" connection="6"/>
+        <dia:connection handle="1" to="O68" connection="12"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O72">
+    <dia:object type="UML - Class" version="0" id="O70">
       <dia:attribute name="obj_pos">
-        <dia:point val="99,121"/>
+        <dia:point val="99,124"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="98.95,120.95;103.4,124.05"/>
+        <dia:rectangle val="98.95,123.95;103.4,127.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="99,121"/>
+        <dia:point val="99,124"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="4.3499999999999996"/>
@@ -8103,21 +8047,21 @@ key and the @e unversioned key. The first will contain the version property.#</d
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O73">
+    <dia:object type="UML - Generalization" version="1" id="O71">
       <dia:attribute name="obj_pos">
-        <dia:point val="89.025,109.6"/>
+        <dia:point val="89.025,112.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="88.175,109.55;101.225,121.05"/>
+        <dia:rectangle val="88.175,112.55;101.225,124.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="89.025,109.6"/>
-        <dia:point val="89.025,116"/>
-        <dia:point val="101.175,116"/>
-        <dia:point val="101.175,121"/>
+        <dia:point val="89.025,112.6"/>
+        <dia:point val="89.025,119"/>
+        <dia:point val="101.175,119"/>
+        <dia:point val="101.175,124"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -8140,11 +8084,11 @@ key and the @e unversioned key. The first will contain the version property.#</d
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O24" connection="6"/>
-        <dia:connection handle="1" to="O72" connection="1"/>
+        <dia:connection handle="0" to="O22" connection="6"/>
+        <dia:connection handle="1" to="O70" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O74">
+    <dia:object type="UML - Association" version="2" id="O72">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -8182,19 +8126,19 @@ key and the @e unversioned key. The first will contain the version property.#</d
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-34.18,70"/>
+        <dia:point val="-42.66,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-34.93,64.25;-20.8,70.8"/>
+        <dia:rectangle val="-43.41,66.25;-19.8,72.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-34.18,70"/>
-        <dia:point val="-34.18,65"/>
-        <dia:point val="-21,65"/>
-        <dia:point val="-21,70"/>
+        <dia:point val="-42.66,72"/>
+        <dia:point val="-42.66,67"/>
+        <dia:point val="-20,67"/>
+        <dia:point val="-20,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -8211,11 +8155,11 @@ key and the @e unversioned key. The first will contain the version property.#</d
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O49" connection="2"/>
+        <dia:connection handle="0" to="O47" connection="1"/>
         <dia:connection handle="1" to="O0" connection="0"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O75">
+    <dia:object type="UML - Class" version="0" id="O73">
       <dia:attribute name="obj_pos">
         <dia:point val="22,50"/>
       </dia:attribute>
@@ -8511,7 +8455,7 @@ Leaves are types concrete types which have a parent.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O76">
+    <dia:object type="UML - Class" version="0" id="O74">
       <dia:attribute name="obj_pos">
         <dia:point val="-32,29"/>
       </dia:attribute>
@@ -8715,15 +8659,15 @@ came from.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O77">
+    <dia:object type="UML - Class" version="0" id="O75">
       <dia:attribute name="obj_pos">
-        <dia:point val="-99,70"/>
+        <dia:point val="-108,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-99.05,69.95;-85.745,73.65"/>
+        <dia:rectangle val="-108.05,71.95;-94.745,75.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-99,70"/>
+        <dia:point val="-108,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="13.205"/>
@@ -8849,20 +8793,20 @@ came from.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O78">
+    <dia:object type="UML - Generalization" version="1" id="O76">
       <dia:attribute name="obj_pos">
-        <dia:point val="-92.3975,73.6"/>
+        <dia:point val="-101.397,75.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-93.2475,73.55;-66.5825,87.05"/>
+        <dia:rectangle val="-102.247,75.55;-66.5825,87.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-92.3975,73.6"/>
-        <dia:point val="-92.3975,81"/>
-        <dia:point val="-66.6325,81"/>
+        <dia:point val="-101.397,75.6"/>
+        <dia:point val="-101.397,83"/>
+        <dia:point val="-66.6325,83"/>
         <dia:point val="-66.6325,87"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
@@ -8886,19 +8830,19 @@ came from.#</dia:string>
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O77" connection="6"/>
-        <dia:connection handle="1" to="O50" connection="1"/>
+        <dia:connection handle="0" to="O75" connection="6"/>
+        <dia:connection handle="1" to="O48" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O79">
+    <dia:object type="UML - Class" version="0" id="O77">
       <dia:attribute name="obj_pos">
-        <dia:point val="-112,50"/>
+        <dia:point val="-113,50"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-112.05,49.95;-97.59,55.25"/>
+        <dia:rectangle val="-113.05,49.95;-98.59,55.25"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-112,50"/>
+        <dia:point val="-113,50"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="14.359999999999999"/>
@@ -9070,7 +9014,7 @@ came from.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O80">
+    <dia:object type="UML - Association" version="2" id="O78">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -9108,19 +9052,19 @@ came from.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-92.3975,70"/>
+        <dia:point val="-101.397,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-104.87,55.15;-91.6475,70.8"/>
+        <dia:rectangle val="-105.87,55.15;-100.647,72.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-92.3975,70"/>
-        <dia:point val="-92.3975,60"/>
-        <dia:point val="-104.82,60"/>
-        <dia:point val="-104.82,55.2"/>
+        <dia:point val="-101.397,72"/>
+        <dia:point val="-101.397,63"/>
+        <dia:point val="-105.82,63"/>
+        <dia:point val="-105.82,55.2"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -9137,19 +9081,19 @@ came from.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O77" connection="1"/>
-        <dia:connection handle="1" to="O79" connection="6"/>
+        <dia:connection handle="0" to="O75" connection="1"/>
+        <dia:connection handle="1" to="O77" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O81">
+    <dia:object type="UML - Class" version="0" id="O79">
       <dia:attribute name="obj_pos">
-        <dia:point val="-81,70"/>
+        <dia:point val="-89,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-81.05,69.95;-74.675,75.25"/>
+        <dia:rectangle val="-89.05,71.95;-82.675,77.25"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-81,70"/>
+        <dia:point val="-89,72"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
         <dia:real val="6.2750000000000004"/>
@@ -9327,7 +9271,7 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O82">
+    <dia:object type="UML - Association" version="2" id="O80">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -9365,19 +9309,19 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-66,70"/>
+        <dia:point val="-76,72"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-77.9125,64.25;-65.25,70.8"/>
+        <dia:rectangle val="-85.9125,66.25;-75.25,72.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-66,70"/>
-        <dia:point val="-66,65"/>
-        <dia:point val="-77.8625,65"/>
-        <dia:point val="-77.8625,70"/>
+        <dia:point val="-76,72"/>
+        <dia:point val="-76,67"/>
+        <dia:point val="-85.8625,67"/>
+        <dia:point val="-85.8625,72"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -9394,11 +9338,11 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O47" connection="0"/>
-        <dia:connection handle="1" to="O81" connection="1"/>
+        <dia:connection handle="0" to="O45" connection="0"/>
+        <dia:connection handle="1" to="O79" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O83">
+    <dia:object type="UML - Class" version="0" id="O81">
       <dia:attribute name="obj_pos">
         <dia:point val="-118,36"/>
       </dia:attribute>
@@ -9555,7 +9499,7 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O84">
+    <dia:object type="UML - Association" version="2" id="O82">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -9593,17 +9537,17 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-104.82,50"/>
+        <dia:point val="-105.82,50"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-112.795,40.35;-104.07,50.8"/>
+        <dia:rectangle val="-112.795,40.35;-105.07,50.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-104.82,50"/>
-        <dia:point val="-104.82,45"/>
+        <dia:point val="-105.82,50"/>
+        <dia:point val="-105.82,45"/>
         <dia:point val="-112.745,45"/>
         <dia:point val="-112.745,40.4"/>
       </dia:attribute>
@@ -9622,28 +9566,28 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O79" connection="1"/>
-        <dia:connection handle="1" to="O83" connection="6"/>
+        <dia:connection handle="0" to="O77" connection="1"/>
+        <dia:connection handle="1" to="O81" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O85">
+    <dia:object type="UML - Class" version="0" id="O83">
       <dia:attribute name="obj_pos">
-        <dia:point val="90,64"/>
+        <dia:point val="108,63"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="89.95,63.25;119.45,68.45"/>
+        <dia:rectangle val="107.95,62.25;127.055,67.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="90,64"/>
+        <dia:point val="108,63"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="24.755000000000003"/>
+        <dia:real val="14.359999999999999"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
         <dia:real val="4.4000000000000004"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#association_traversal#</dia:string>
+        <dia:string>#all_model_items_traversal#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
         <dia:string>#service#</dia:string>
@@ -9733,7 +9677,7 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="operations">
         <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#association_traversal#</dia:string>
+            <dia:string>#all_types_traversal#</dia:string>
           </dia:attribute>
           <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
@@ -9777,23 +9721,6 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
                 <dia:enum val="0"/>
               </dia:attribute>
             </dia:composite>
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#t#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const abstract_object&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
           </dia:attribute>
         </dia:composite>
         <dia:composite type="umloperation">
@@ -9841,12 +9768,12 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         </dia:composite>
       </dia:attribute>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O86">
+    <dia:object type="UML - Association" version="2" id="O84">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
       <dia:attribute name="direction">
-        <dia:enum val="1"/>
+        <dia:enum val="2"/>
       </dia:attribute>
       <dia:attribute name="show_direction">
         <dia:boolean val="false"/>
@@ -9879,22 +9806,22 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="102.377,64"/>
+        <dia:point val="49.45,52.7"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.4,51.95;103.127,64.8"/>
+        <dia:rectangle val="49.4,51.95;115.93,63.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="102.377,64"/>
-        <dia:point val="102.377,52.7"/>
         <dia:point val="49.45,52.7"/>
+        <dia:point val="115.18,52.7"/>
+        <dia:point val="115.18,63"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
-        <dia:enum val="1"/>
         <dia:enum val="0"/>
+        <dia:enum val="1"/>
       </dia:attribute>
       <dia:attribute name="orth_autoroute">
         <dia:boolean val="true"/>
@@ -9906,31 +9833,31 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O85" connection="1"/>
-        <dia:connection handle="1" to="O75" connection="9"/>
+        <dia:connection handle="0" to="O73" connection="9"/>
+        <dia:connection handle="1" to="O83" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O87">
+    <dia:object type="UML - Class" version="0" id="O85">
       <dia:attribute name="obj_pos">
-        <dia:point val="158,64"/>
+        <dia:point val="95,82"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="157.95,63.25;182.83,69.25"/>
+        <dia:rectangle val="94.95,81.25;110.205,85.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="158,64"/>
+        <dia:point val="95,82"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="20.134999999999998"/>
+        <dia:real val="10.51"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="5.2000000000000002"/>
+        <dia:real val="3.6000000000000001"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#generalisation_traversal#</dia:string>
+        <dia:string>#TraversalVisitor#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
-        <dia:string>#service#</dia:string>
+        <dia:string>#concept#</dia:string>
       </dia:attribute>
       <dia:attribute name="comment">
         <dia:string>##</dia:string>
@@ -10017,7 +9944,7 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="operations">
         <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#generalisation_traversal#</dia:string>
+            <dia:string>#operator()#</dia:string>
           </dia:attribute>
           <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
@@ -10046,27 +9973,10 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
           <dia:attribute name="parameters">
             <dia:composite type="umlparameter">
               <dia:attribute name="name">
-                <dia:string>#m#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const model&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#t#</dia:string>
+                <dia:string>#v#</dia:string>
               </dia:attribute>
               <dia:attribute name="type">
-                <dia:string>#const abstract_object&amp;#</dia:string>
+                <dia:string>#const type&amp;#</dia:string>
               </dia:attribute>
               <dia:attribute name="value">
                 <dia:string>##</dia:string>
@@ -10080,36 +9990,6 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
             </dia:composite>
           </dia:attribute>
         </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#traverse#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters"/>
-        </dia:composite>
       </dia:attribute>
       <dia:attribute name="template">
         <dia:boolean val="true"/>
@@ -10125,93 +10005,24 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         </dia:composite>
       </dia:attribute>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O88">
-      <dia:attribute name="name">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="2"/>
-      </dia:attribute>
-      <dia:attribute name="show_direction">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="multipicity_a">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
-      </dia:attribute>
-      <dia:attribute name="show_arrow_a">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="multipicity_b">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
-      </dia:attribute>
-      <dia:attribute name="show_arrow_b">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="obj_pos">
-        <dia:point val="49.45,52.7"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.4,51.95;168.817,64.8"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="49.45,52.7"/>
-        <dia:point val="168.067,52.7"/>
-        <dia:point val="168.067,64"/>
-      </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="orth_autoroute">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O75" connection="9"/>
-        <dia:connection handle="1" to="O87" connection="1"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Class" version="0" id="O89">
+    <dia:object type="UML - Class" version="0" id="O86">
       <dia:attribute name="obj_pos">
-        <dia:point val="122,82"/>
+        <dia:point val="-80,-6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="121.95,81.95;148.73,87.85"/>
+        <dia:rectangle val="-80.05,-6.05;-54.81,4.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="122,82"/>
+        <dia:point val="-80,-6"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="26.68"/>
+        <dia:real val="25.140000000000001"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="5.8000000000000007"/>
+        <dia:real val="10.6"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#property_cache#</dia:string>
+        <dia:string>#meta_data_writer#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
         <dia:string>#service#</dia:string>
@@ -10300,10 +10111,10 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="attributes">
         <dia:composite type="umlattribute">
           <dia:attribute name="name">
-            <dia:string>#all_properties#</dia:string>
+            <dia:string>#meta_data_#</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
-            <dia:string>#std::unordered_map&lt;qname,std::list&lt;property&gt;&gt;#</dia:string>
+            <dia:string>#boost::property_tree::ptree#</dia:string>
           </dia:attribute>
           <dia:attribute name="value">
             <dia:string>##</dia:string>
@@ -10321,57 +10132,124 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
             <dia:boolean val="false"/>
           </dia:attribute>
         </dia:composite>
-        <dia:composite type="umlattribute">
+      </dia:attribute>
+      <dia:attribute name="operations">
+        <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#local_properties#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::unordered_map&lt;qname,std::list&lt;property&gt;&gt;#</dia:string>
+            <dia:string>#meta_data_writer#</dia:string>
           </dia:attribute>
-          <dia:attribute name="value">
+          <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
           </dia:attribute>
-          <dia:attribute name="comment">
+          <dia:attribute name="type">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
-            <dia:enum val="1"/>
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="abstract">
             <dia:boolean val="false"/>
           </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
           <dia:attribute name="class_scope">
             <dia:boolean val="false"/>
           </dia:attribute>
+          <dia:attribute name="parameters">
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#meta_data#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#boost::property_tree::ptree#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+          </dia:attribute>
         </dia:composite>
-        <dia:composite type="umlattribute">
+        <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#inherited_properties#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::unordered_map&lt;qname,std::list&lt;property&gt;&gt;#</dia:string>
+            <dia:string>#add#</dia:string>
           </dia:attribute>
-          <dia:attribute name="value">
+          <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
           </dia:attribute>
-          <dia:attribute name="comment">
+          <dia:attribute name="type">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
-            <dia:enum val="1"/>
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="abstract">
             <dia:boolean val="false"/>
           </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
           <dia:attribute name="class_scope">
             <dia:boolean val="false"/>
           </dia:attribute>
+          <dia:attribute name="parameters">
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#value#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#const std::string&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#key#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#const std::string&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+          </dia:attribute>
         </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="operations">
         <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#populate#</dia:string>
+            <dia:string>#add#</dia:string>
           </dia:attribute>
           <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
@@ -10400,10 +10278,10 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
           <dia:attribute name="parameters">
             <dia:composite type="umlparameter">
               <dia:attribute name="name">
-                <dia:string>#m#</dia:string>
+                <dia:string>#kvps#</dia:string>
               </dia:attribute>
               <dia:attribute name="type">
-                <dia:string>#const model&amp; m#</dia:string>
+                <dia:string>#std::list&lt;std::pair&lt;std::string,std::string&gt;&gt;#</dia:string>
               </dia:attribute>
               <dia:attribute name="value">
                 <dia:string>##</dia:string>
@@ -10417,71 +10295,207 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
             </dia:composite>
           </dia:attribute>
         </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="template">
+        <dia:composite type="umloperation">
+          <dia:attribute name="name">
+            <dia:string>#add_if_marker_found#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="stereotype">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#bool#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="parameters">
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#marker#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#const std::string&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#kvps#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#const std::list&lt;std::pair&lt;std::string,std::string&gt;&gt;&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umloperation">
+          <dia:attribute name="name">
+            <dia:string>#add_if_key_not_found#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="stereotype">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#bool#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="parameters">
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#key#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#const std::string&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#value#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#const std::string&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
+      <dia:attribute name="template">
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O90">
-      <dia:attribute name="name">
-        <dia:string>#&lt; traverses models using#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="show_direction">
-        <dia:boolean val="false"/>
+    <dia:object type="UML - Note" version="0" id="O87">
+      <dia:attribute name="obj_pos">
+        <dia:point val="-69,-12"/>
       </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="-69.05,-12.05;-54.575,-9.45"/>
       </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="elem_corner">
+        <dia:point val="-69,-12"/>
       </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
+      <dia:attribute name="elem_width">
+        <dia:real val="14.375"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_a">
-        <dia:boolean val="false"/>
+      <dia:attribute name="elem_height">
+        <dia:real val="2.5"/>
       </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
+      <dia:attribute name="fill_colour">
+        <dia:color val="#ffffff"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_b">
-        <dia:boolean val="false"/>
+      <dia:attribute name="text">
+        <dia:composite type="text">
+          <dia:attribute name="string">
+            <dia:string>#Helper class to perform writes on a
+boost::property_tree::ptreee#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="font">
+            <dia:font family="monospace" style="0" name="Courier"/>
+          </dia:attribute>
+          <dia:attribute name="height">
+            <dia:real val="0.80000000000000004"/>
+          </dia:attribute>
+          <dia:attribute name="pos">
+            <dia:point val="-68.65,-10.755"/>
+          </dia:attribute>
+          <dia:attribute name="color">
+            <dia:color val="#000000"/>
+          </dia:attribute>
+          <dia:attribute name="alignment">
+            <dia:enum val="0"/>
+          </dia:attribute>
+        </dia:composite>
       </dia:attribute>
+    </dia:object>
+    <dia:object type="UML - Message" version="0" id="O88">
       <dia:attribute name="obj_pos">
-        <dia:point val="102.377,68.4"/>
+        <dia:point val="-63.3502,-9.44972"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="101.627,67.65;122.2,82.8"/>
+        <dia:rectangle val="-78.4951,-16.3216;-63.2798,-5.66227"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="102.377,68.4"/>
-        <dia:point val="102.377,76.05"/>
-        <dia:point val="122,76.05"/>
-        <dia:point val="122,82"/>
-      </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="1"/>
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="orth_autoroute">
-        <dia:boolean val="false"/>
+      <dia:attribute name="conn_endpoints">
+        <dia:point val="-63.3502,-9.44972"/>
+        <dia:point val="-67.43,-6"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -10489,141 +10503,216 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="line_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
+      <dia:attribute name="text">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="type">
+        <dia:enum val="0"/>
+      </dia:attribute>
+      <dia:attribute name="text_pos">
+        <dia:point val="-78.4951,-15.7216"/>
+      </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O85" connection="6"/>
-        <dia:connection handle="1" to="O89" connection="0"/>
+        <dia:connection handle="0" to="O87" connection="8"/>
+        <dia:connection handle="1" to="O86" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O91">
-      <dia:attribute name="name">
-        <dia:string>#traverses models using &gt;#</dia:string>
+    <dia:object type="UML - Class" version="0" id="O89">
+      <dia:attribute name="obj_pos">
+        <dia:point val="-67,36"/>
       </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="1"/>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="-67.05,35.95;-44.89,40.25"/>
       </dia:attribute>
-      <dia:attribute name="show_direction">
-        <dia:boolean val="false"/>
+      <dia:attribute name="elem_corner">
+        <dia:point val="-67,36"/>
       </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
+      <dia:attribute name="elem_width">
+        <dia:real val="22.059999999999999"/>
       </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="elem_height">
+        <dia:real val="4.2000000000000002"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_a">
+      <dia:attribute name="name">
+        <dia:string>#meta_data_reader#</dia:string>
+      </dia:attribute>
+      <dia:attribute name="stereotype">
+        <dia:string>#service#</dia:string>
+      </dia:attribute>
+      <dia:attribute name="comment">
         <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
+      <dia:attribute name="abstract">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_a">
+      <dia:attribute name="suppress_attributes">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="suppress_operations">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="visible_attributes">
+        <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
+      <dia:attribute name="visible_operations">
+        <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_b">
+      <dia:attribute name="visible_comments">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="obj_pos">
-        <dia:point val="168.067,69.2"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="148.63,68.45;168.817,82.8"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
+      <dia:attribute name="wrap_operations">
+        <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="168.067,69.2"/>
-        <dia:point val="168.067,76"/>
-        <dia:point val="148.68,76"/>
-        <dia:point val="148.68,82"/>
+      <dia:attribute name="wrap_after_char">
+        <dia:int val="40"/>
       </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="1"/>
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
+      <dia:attribute name="comment_line_length">
+        <dia:int val="17"/>
       </dia:attribute>
-      <dia:attribute name="orth_autoroute">
+      <dia:attribute name="comment_tagging">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="text_colour">
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
+      </dia:attribute>
+      <dia:attribute name="line_color">
         <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="line_colour">
+      <dia:attribute name="fill_color">
+        <dia:color val="#ffffff"/>
+      </dia:attribute>
+      <dia:attribute name="text_color">
         <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O87" connection="6"/>
-        <dia:connection handle="1" to="O89" connection="2"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Association" version="2" id="O92">
-      <dia:attribute name="name">
-        <dia:string>#&lt; indexes type information in#</dia:string>
+      <dia:attribute name="normal_font">
+        <dia:font family="monospace" style="0" name="Courier"/>
       </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="2"/>
+      <dia:attribute name="abstract_font">
+        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
       </dia:attribute>
-      <dia:attribute name="show_direction">
-        <dia:boolean val="false"/>
+      <dia:attribute name="polymorphic_font">
+        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
       </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
+      <dia:attribute name="classname_font">
+        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
       </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="abstract_classname_font">
+        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="comment_font">
+        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
       </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
+      <dia:attribute name="normal_font_height">
+        <dia:real val="0.80000000000000004"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_a">
-        <dia:boolean val="false"/>
+      <dia:attribute name="polymorphic_font_height">
+        <dia:real val="0.80000000000000004"/>
       </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="abstract_font_height">
+        <dia:real val="0.80000000000000004"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="classname_font_height">
+        <dia:real val="1"/>
       </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
+      <dia:attribute name="abstract_classname_font_height">
+        <dia:real val="1"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_b">
+      <dia:attribute name="comment_font_height">
+        <dia:real val="0.69999999999999996"/>
+      </dia:attribute>
+      <dia:attribute name="attributes">
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#meta_data_#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#boost::property_tree::ptree#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="1"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
+      <dia:attribute name="operations">
+        <dia:composite type="umloperation">
+          <dia:attribute name="name">
+            <dia:string>#meta_data_reader#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="stereotype">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="parameters">
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#meta_data#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#boost::property_tree::ptree#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
+      <dia:attribute name="template">
         <dia:boolean val="false"/>
       </dia:attribute>
+      <dia:attribute name="templates"/>
+    </dia:object>
+    <dia:object type="UML - Message" version="0" id="O90">
       <dia:attribute name="obj_pos">
-        <dia:point val="49.45,57.5"/>
+        <dia:point val="-77.005,30.5"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.4,56.75;122.75,85.55"/>
+        <dia:rectangle val="-77.0729,30.4321;-66.7635,36.3746"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="49.45,57.5"/>
-        <dia:point val="75,57.5"/>
-        <dia:point val="75,84.7"/>
-        <dia:point val="122,84.7"/>
-      </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
-        <dia:enum val="0"/>
-      </dia:attribute>
-      <dia:attribute name="orth_autoroute">
-        <dia:boolean val="false"/>
+      <dia:attribute name="conn_endpoints">
+        <dia:point val="-77.005,30.5"/>
+        <dia:point val="-67,36"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -10631,29 +10720,38 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="line_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
+      <dia:attribute name="text">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="type">
+        <dia:enum val="0"/>
+      </dia:attribute>
+      <dia:attribute name="text_pos">
+        <dia:point val="-72.0025,33.7499"/>
+      </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="21"/>
-        <dia:connection handle="1" to="O89" connection="8"/>
+        <dia:connection handle="0" to="O108" connection="6"/>
+        <dia:connection handle="1" to="O89" connection="0"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O93">
+    <dia:object type="UML - Class" version="0" id="O91">
       <dia:attribute name="obj_pos">
-        <dia:point val="187,64"/>
+        <dia:point val="-75,13"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="186.95,63.25;206.055,68.45"/>
+        <dia:rectangle val="-75.05,12.95;-70.215,16.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="187,64"/>
+        <dia:point val="-75,13"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="14.359999999999999"/>
+        <dia:real val="4.7350000000000003"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="4.4000000000000004"/>
+        <dia:real val="3"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#all_model_items_traversal#</dia:string>
+        <dia:string>#tags#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
         <dia:string>#service#</dia:string>
@@ -10740,157 +10838,77 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:real val="0.69999999999999996"/>
       </dia:attribute>
       <dia:attribute name="attributes"/>
-      <dia:attribute name="operations">
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#all_types_traversal#</dia:string>
+      <dia:attribute name="operations"/>
+      <dia:attribute name="template">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="templates"/>
+    </dia:object>
+    <dia:object type="UML - Note" version="0" id="O92">
+      <dia:attribute name="obj_pos">
+        <dia:point val="-86,21"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="-86.05,20.95;-62.335,23.55"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
+      </dia:attribute>
+      <dia:attribute name="elem_corner">
+        <dia:point val="-86,21"/>
+      </dia:attribute>
+      <dia:attribute name="elem_width">
+        <dia:real val="23.615000000000002"/>
+      </dia:attribute>
+      <dia:attribute name="elem_height">
+        <dia:real val="2.5"/>
+      </dia:attribute>
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="fill_colour">
+        <dia:color val="#ffffff"/>
+      </dia:attribute>
+      <dia:attribute name="text">
+        <dia:composite type="text">
+          <dia:attribute name="string">
+            <dia:string>#Not really a serice; string enumeration with all valid keys
+and values (where applicable) for tags.#</dia:string>
           </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
+          <dia:attribute name="font">
+            <dia:font family="monospace" style="0" name="Courier"/>
           </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
+          <dia:attribute name="height">
+            <dia:real val="0.80000000000000004"/>
           </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#m#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const model&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#traverse#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
+          <dia:attribute name="pos">
+            <dia:point val="-85.65,22.245"/>
           </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
+          <dia:attribute name="color">
+            <dia:color val="#000000"/>
           </dia:attribute>
-          <dia:attribute name="visibility">
+          <dia:attribute name="alignment">
             <dia:enum val="0"/>
           </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters"/>
-        </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="template">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="templates">
-        <dia:composite type="umlformalparameter">
-          <dia:attribute name="name">
-            <dia:string>#TraversalVisitee#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
         </dia:composite>
       </dia:attribute>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O94">
-      <dia:attribute name="name">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="2"/>
-      </dia:attribute>
-      <dia:attribute name="show_direction">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="multipicity_a">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
-      </dia:attribute>
-      <dia:attribute name="show_arrow_a">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="multipicity_b">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
-      </dia:attribute>
-      <dia:attribute name="show_arrow_b">
-        <dia:boolean val="false"/>
-      </dia:attribute>
+    <dia:object type="UML - Message" version="0" id="O93">
       <dia:attribute name="obj_pos">
-        <dia:point val="49.45,52.7"/>
+        <dia:point val="-74.1925,21"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.4,51.95;194.93,64.8"/>
+        <dia:rectangle val="-74.2551,15.8331;-72.2358,21.0626"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="49.45,52.7"/>
-        <dia:point val="194.18,52.7"/>
-        <dia:point val="194.18,64"/>
-      </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="orth_autoroute">
-        <dia:boolean val="true"/>
+      <dia:attribute name="conn_endpoints">
+        <dia:point val="-74.1925,21"/>
+        <dia:point val="-72.6325,16"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -10898,32 +10916,41 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="line_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
+      <dia:attribute name="text">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="type">
+        <dia:enum val="0"/>
+      </dia:attribute>
+      <dia:attribute name="text_pos">
+        <dia:point val="-73.412,19"/>
+      </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="9"/>
-        <dia:connection handle="1" to="O93" connection="1"/>
+        <dia:connection handle="0" to="O92" connection="1"/>
+        <dia:connection handle="1" to="O91" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O95">
+    <dia:object type="UML - Class" version="0" id="O94">
       <dia:attribute name="obj_pos">
-        <dia:point val="130,41"/>
+        <dia:point val="-23,13"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="129.95,40.25;145.205,44.65"/>
+        <dia:rectangle val="-23.05,12.95;-12.055,18.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="130,41"/>
+        <dia:point val="-23,13"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="10.51"/>
+        <dia:real val="10.895"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="3.6000000000000001"/>
+        <dia:real val="5"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#TraversalVisitor#</dia:string>
+        <dia:string>#meta_data_tagger#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
-        <dia:string>#concept#</dia:string>
+        <dia:string>#service#</dia:string>
       </dia:attribute>
       <dia:attribute name="comment">
         <dia:string>##</dia:string>
@@ -11006,11 +11033,35 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="comment_font_height">
         <dia:real val="0.69999999999999996"/>
       </dia:attribute>
-      <dia:attribute name="attributes"/>
+      <dia:attribute name="attributes">
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#model_#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#model#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="1"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
       <dia:attribute name="operations">
         <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#operator()#</dia:string>
+            <dia:string>#meta_data_tagger#</dia:string>
           </dia:attribute>
           <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
@@ -11039,10 +11090,10 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
           <dia:attribute name="parameters">
             <dia:composite type="umlparameter">
               <dia:attribute name="name">
-                <dia:string>#v#</dia:string>
+                <dia:string>#m#</dia:string>
               </dia:attribute>
               <dia:attribute name="type">
-                <dia:string>#const type&amp;#</dia:string>
+                <dia:string>#model&amp;#</dia:string>
               </dia:attribute>
               <dia:attribute name="value">
                 <dia:string>##</dia:string>
@@ -11056,299 +11107,107 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
             </dia:composite>
           </dia:attribute>
         </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="template">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="templates">
-        <dia:composite type="umlformalparameter">
+        <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#TraversalVisitee#</dia:string>
+            <dia:string>#tag#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="stereotype">
+            <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
             <dia:string>##</dia:string>
           </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="parameters"/>
         </dia:composite>
       </dia:attribute>
+      <dia:attribute name="template">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O96">
+    <dia:object type="UML - Note" version="0" id="O95">
       <dia:attribute name="obj_pos">
-        <dia:point val="125,64"/>
+        <dia:point val="-34,22"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="124.95,63.95;151.345,70.05"/>
+        <dia:rectangle val="-34.05,21.95;-11.875,24.55"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="125,64"/>
+        <dia:point val="-34,22"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="26.294999999999998"/>
+        <dia:real val="22.075000000000003"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="6"/>
-      </dia:attribute>
-      <dia:attribute name="name">
-        <dia:string>#property_cache_interface#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="stereotype">
-        <dia:string>#service#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="comment">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="abstract">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_attributes">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_operations">
-        <dia:boolean val="false"/>
+        <dia:real val="2.5"/>
       </dia:attribute>
-      <dia:attribute name="visible_attributes">
-        <dia:boolean val="true"/>
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
       </dia:attribute>
-      <dia:attribute name="visible_operations">
-        <dia:boolean val="true"/>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="visible_comments">
-        <dia:boolean val="false"/>
+      <dia:attribute name="fill_colour">
+        <dia:color val="#ffffff"/>
       </dia:attribute>
-      <dia:attribute name="wrap_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_after_char">
-        <dia:int val="40"/>
-      </dia:attribute>
-      <dia:attribute name="comment_line_length">
-        <dia:int val="17"/>
-      </dia:attribute>
-      <dia:attribute name="comment_tagging">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_color">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font">
-        <dia:font family="monospace" style="0" name="Courier"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font">
-        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font">
-        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font">
-        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font">
-        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font">
-        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font_height">
-        <dia:real val="0.69999999999999996"/>
-      </dia:attribute>
-      <dia:attribute name="attributes"/>
-      <dia:attribute name="operations">
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#get_all_properties#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::list&lt;property&gt;#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="true"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#t#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const type&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#get_local_properties#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::list&lt;property&gt;#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="true"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#t#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const type&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#get_inherited_properties#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
+      <dia:attribute name="text">
+        <dia:composite type="text">
+          <dia:attribute name="string">
+            <dia:string>#Traverses the model as a graph and propagates meta data
+based on association and generalisation relationships.#</dia:string>
           </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#std::unordered_map&lt;qname,std::list&lt;property&gt;&gt;#</dia:string>
+          <dia:attribute name="font">
+            <dia:font family="monospace" style="0" name="Courier"/>
           </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
+          <dia:attribute name="height">
+            <dia:real val="0.80000000000000004"/>
           </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
+          <dia:attribute name="pos">
+            <dia:point val="-33.65,23.245"/>
           </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="true"/>
+          <dia:attribute name="color">
+            <dia:color val="#000000"/>
           </dia:attribute>
-          <dia:attribute name="inheritance_type">
+          <dia:attribute name="alignment">
             <dia:enum val="0"/>
           </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#t#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const type&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
         </dia:composite>
       </dia:attribute>
-      <dia:attribute name="template">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Generalization" version="1" id="O97">
+    <dia:object type="UML - Message" version="0" id="O96">
       <dia:attribute name="obj_pos">
-        <dia:point val="138.148,70"/>
+        <dia:point val="-22.9625,22"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="135.29,69.95;138.998,82.05"/>
+        <dia:rectangle val="-23.0324,17.6486;-17.2745,22.0699"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="138.148,70"/>
-        <dia:point val="138.148,76"/>
-        <dia:point val="135.34,76"/>
-        <dia:point val="135.34,82"/>
-      </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="1"/>
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="orth_autoroute">
-        <dia:boolean val="false"/>
+      <dia:attribute name="conn_endpoints">
+        <dia:point val="-22.9625,22"/>
+        <dia:point val="-17.5525,18"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -11356,41 +11215,44 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       <dia:attribute name="line_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="name">
+      <dia:attribute name="text">
         <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="stereotype">
-        <dia:string>##</dia:string>
+      <dia:attribute name="type">
+        <dia:enum val="0"/>
+      </dia:attribute>
+      <dia:attribute name="text_pos">
+        <dia:point val="-20.2569,20.5"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O96" connection="6"/>
-        <dia:connection handle="1" to="O89" connection="1"/>
+        <dia:connection handle="0" to="O95" connection="1"/>
+        <dia:connection handle="1" to="O94" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O98">
+    <dia:object type="UML - Class" version="0" id="O97">
       <dia:attribute name="obj_pos">
-        <dia:point val="112,106"/>
+        <dia:point val="-47,14"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="111.95,105.95;117.83,109.05"/>
+        <dia:rectangle val="-47.05,13.95;-39.04,17.05"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="112,106"/>
+        <dia:point val="-47,14"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="5.7799999999999994"/>
+        <dia:real val="7.9099999999999993"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
         <dia:real val="3"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#cache_error#</dia:string>
+        <dia:string>#meta_data_error#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
         <dia:string>#exception#</dia:string>
       </dia:attribute>
       <dia:attribute name="comment">
-        <dia:string>#An error occurred while indexing or querying a cache.#</dia:string>
+        <dia:string>#An error has occurred while peforming an operation related to meta data.#</dia:string>
       </dia:attribute>
       <dia:attribute name="abstract">
         <dia:boolean val="false"/>
@@ -11477,7 +11339,7 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O99">
+    <dia:object type="UML - Association" version="2" id="O98">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -11515,19 +11377,19 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="135.34,87.8"/>
+        <dia:point val="-80,4.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="114.84,87.05;136.09,106.75"/>
+        <dia:rectangle val="-80.75,3.85;-72.4325,13.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="135.34,87.8"/>
-        <dia:point val="135.34,101"/>
-        <dia:point val="114.89,101"/>
-        <dia:point val="114.89,105.95"/>
+        <dia:point val="-80,4.6"/>
+        <dia:point val="-80,9"/>
+        <dia:point val="-72.6325,9"/>
+        <dia:point val="-72.6325,13"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -11544,1213 +11406,211 @@ User models are regular Dogen models, normally made using Dia.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O89" connection="6"/>
-        <dia:connection handle="1" to="O98" connection="8"/>
+        <dia:connection handle="0" to="O86" connection="5"/>
+        <dia:connection handle="1" to="O91" connection="1"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O100">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-80,-6"/>
+    <dia:object type="UML - Association" version="2" id="O99">
+      <dia:attribute name="name">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-80.05,-6.05;-54.81,4.65"/>
+      <dia:attribute name="direction">
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-80,-6"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="25.140000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="10.6"/>
-      </dia:attribute>
-      <dia:attribute name="name">
-        <dia:string>#meta_data_writer#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="stereotype">
-        <dia:string>#service#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="comment">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="abstract">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_attributes">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_operations">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="visible_attributes">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_comments">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_after_char">
-        <dia:int val="40"/>
-      </dia:attribute>
-      <dia:attribute name="comment_line_length">
-        <dia:int val="17"/>
-      </dia:attribute>
-      <dia:attribute name="comment_tagging">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_color">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font">
-        <dia:font family="monospace" style="0" name="Courier"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font">
-        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font">
-        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font">
-        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font">
-        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font">
-        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font_height">
-        <dia:real val="0.69999999999999996"/>
-      </dia:attribute>
-      <dia:attribute name="attributes">
-        <dia:composite type="umlattribute">
-          <dia:attribute name="name">
-            <dia:string>#meta_data_#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#boost::property_tree::ptree#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="value">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="1"/>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="operations">
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#meta_data_writer#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#meta_data#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#boost::property_tree::ptree#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#add#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#value#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const std::string&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#key#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const std::string&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#add#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#kvps#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#std::list&lt;std::pair&lt;std::string,std::string&gt;&gt;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#add_if_marker_found#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#bool#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#marker#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const std::string&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#kvps#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const std::list&lt;std::pair&lt;std::string,std::string&gt;&gt;&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#add_if_key_not_found#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#bool#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#key#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const std::string&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#value#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#const std::string&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="template">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="templates"/>
-    </dia:object>
-    <dia:object type="UML - Note" version="0" id="O101">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-69,-12"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-69.05,-12.05;-54.575,-9.45"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-69,-12"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="14.375"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="2.5"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_colour">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text">
-        <dia:composite type="text">
-          <dia:attribute name="string">
-            <dia:string>#Helper class to perform writes on a
-boost::property_tree::ptreee#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="font">
-            <dia:font family="monospace" style="0" name="Courier"/>
-          </dia:attribute>
-          <dia:attribute name="height">
-            <dia:real val="0.80000000000000004"/>
-          </dia:attribute>
-          <dia:attribute name="pos">
-            <dia:point val="-68.65,-10.755"/>
-          </dia:attribute>
-          <dia:attribute name="color">
-            <dia:color val="#000000"/>
-          </dia:attribute>
-          <dia:attribute name="alignment">
-            <dia:enum val="0"/>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-    </dia:object>
-    <dia:object type="UML - Message" version="0" id="O102">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-63.3502,-9.44972"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-78.4951,-16.3216;-63.2798,-5.66227"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="conn_endpoints">
-        <dia:point val="-63.3502,-9.44972"/>
-        <dia:point val="-67.43,-6"/>
-      </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="text">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="type">
-        <dia:enum val="0"/>
-      </dia:attribute>
-      <dia:attribute name="text_pos">
-        <dia:point val="-78.4951,-15.7216"/>
-      </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O101" connection="8"/>
-        <dia:connection handle="1" to="O100" connection="1"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Class" version="0" id="O103">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-67,36"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-67.05,35.95;-44.89,40.25"/>
-      </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-67,36"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="22.059999999999999"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="4.2000000000000002"/>
-      </dia:attribute>
-      <dia:attribute name="name">
-        <dia:string>#meta_data_reader#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="stereotype">
-        <dia:string>#service#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="comment">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="abstract">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_attributes">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_operations">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="visible_attributes">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_comments">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_after_char">
-        <dia:int val="40"/>
-      </dia:attribute>
-      <dia:attribute name="comment_line_length">
-        <dia:int val="17"/>
-      </dia:attribute>
-      <dia:attribute name="comment_tagging">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_color">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font">
-        <dia:font family="monospace" style="0" name="Courier"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font">
-        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font">
-        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font">
-        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font">
-        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font">
-        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font_height">
-        <dia:real val="0.69999999999999996"/>
-      </dia:attribute>
-      <dia:attribute name="attributes">
-        <dia:composite type="umlattribute">
-          <dia:attribute name="name">
-            <dia:string>#meta_data_#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#boost::property_tree::ptree#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="value">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="1"/>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="operations">
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#meta_data_reader#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#meta_data#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#boost::property_tree::ptree#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-      <dia:attribute name="template">
+      <dia:attribute name="show_direction">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="templates"/>
-    </dia:object>
-    <dia:object type="UML - Message" version="0" id="O104">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-77.005,30.5"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-77.0729,30.4321;-66.7635,36.3746"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="conn_endpoints">
-        <dia:point val="-77.005,30.5"/>
-        <dia:point val="-67,36"/>
-      </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
+      <dia:attribute name="assoc_type">
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="text">
+      <dia:attribute name="role_a">
         <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="type">
-        <dia:enum val="0"/>
-      </dia:attribute>
-      <dia:attribute name="text_pos">
-        <dia:point val="-72.0025,33.7499"/>
-      </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O122" connection="6"/>
-        <dia:connection handle="1" to="O103" connection="0"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Class" version="0" id="O105">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-75,13"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-75.05,12.95;-70.215,16.05"/>
-      </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-75,13"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="4.7350000000000003"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="3"/>
-      </dia:attribute>
-      <dia:attribute name="name">
-        <dia:string>#tags#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="stereotype">
-        <dia:string>#service#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="comment">
+      <dia:attribute name="multipicity_a">
         <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="abstract">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_attributes">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="suppress_operations">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="visible_attributes">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_comments">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_operations">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="wrap_after_char">
-        <dia:int val="40"/>
-      </dia:attribute>
-      <dia:attribute name="comment_line_length">
-        <dia:int val="17"/>
-      </dia:attribute>
-      <dia:attribute name="comment_tagging">
-        <dia:boolean val="false"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_color">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text_color">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font">
-        <dia:font family="monospace" style="0" name="Courier"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font">
-        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font">
-        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font">
-        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font">
-        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font">
-        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
-      </dia:attribute>
-      <dia:attribute name="normal_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="polymorphic_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_font_height">
-        <dia:real val="0.80000000000000004"/>
-      </dia:attribute>
-      <dia:attribute name="classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="abstract_classname_font_height">
-        <dia:real val="1"/>
-      </dia:attribute>
-      <dia:attribute name="comment_font_height">
-        <dia:real val="0.69999999999999996"/>
+      <dia:attribute name="visibility_a">
+        <dia:enum val="3"/>
       </dia:attribute>
-      <dia:attribute name="attributes"/>
-      <dia:attribute name="operations"/>
-      <dia:attribute name="template">
+      <dia:attribute name="show_arrow_a">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="templates"/>
-    </dia:object>
-    <dia:object type="UML - Note" version="0" id="O106">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-86,21"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-86.05,20.95;-62.335,23.55"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-86,21"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="23.615000000000002"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="2.5"/>
-      </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="fill_colour">
-        <dia:color val="#ffffff"/>
-      </dia:attribute>
-      <dia:attribute name="text">
-        <dia:composite type="text">
-          <dia:attribute name="string">
-            <dia:string>#Not really a serice; string enumeration with all valid keys
-and values (where applicable) for tags.#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="font">
-            <dia:font family="monospace" style="0" name="Courier"/>
-          </dia:attribute>
-          <dia:attribute name="height">
-            <dia:real val="0.80000000000000004"/>
-          </dia:attribute>
-          <dia:attribute name="pos">
-            <dia:point val="-85.65,22.245"/>
-          </dia:attribute>
-          <dia:attribute name="color">
-            <dia:color val="#000000"/>
-          </dia:attribute>
-          <dia:attribute name="alignment">
-            <dia:enum val="0"/>
-          </dia:attribute>
-        </dia:composite>
-      </dia:attribute>
-    </dia:object>
-    <dia:object type="UML - Message" version="0" id="O107">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-74.1925,21"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-74.2551,15.8331;-72.2358,21.0626"/>
-      </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
-      </dia:attribute>
-      <dia:attribute name="conn_endpoints">
-        <dia:point val="-74.1925,21"/>
-        <dia:point val="-72.6325,16"/>
-      </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="text">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="type">
-        <dia:enum val="0"/>
-      </dia:attribute>
-      <dia:attribute name="text_pos">
-        <dia:point val="-73.412,19"/>
-      </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O106" connection="1"/>
-        <dia:connection handle="1" to="O105" connection="6"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Class" version="0" id="O108">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-23,13"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-23.05,12.95;-12.055,18.05"/>
-      </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-23,13"/>
-      </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="10.895"/>
-      </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="5"/>
-      </dia:attribute>
-      <dia:attribute name="name">
-        <dia:string>#meta_data_tagger#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="stereotype">
-        <dia:string>#service#</dia:string>
-      </dia:attribute>
-      <dia:attribute name="comment">
+      <dia:attribute name="role_b">
         <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="abstract">
-        <dia:boolean val="false"/>
+      <dia:attribute name="multipicity_b">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="suppress_attributes">
-        <dia:boolean val="false"/>
+      <dia:attribute name="visibility_b">
+        <dia:enum val="3"/>
       </dia:attribute>
-      <dia:attribute name="suppress_operations">
+      <dia:attribute name="show_arrow_b">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="visible_attributes">
-        <dia:boolean val="true"/>
-      </dia:attribute>
-      <dia:attribute name="visible_operations">
-        <dia:boolean val="true"/>
+      <dia:attribute name="obj_pos">
+        <dia:point val="-55.97,36"/>
       </dia:attribute>
-      <dia:attribute name="visible_comments">
-        <dia:boolean val="false"/>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="-56.72,16.95;-42.845,36.8"/>
       </dia:attribute>
-      <dia:attribute name="wrap_operations">
-        <dia:boolean val="true"/>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="wrap_after_char">
-        <dia:int val="40"/>
+      <dia:attribute name="orth_points">
+        <dia:point val="-55.97,36"/>
+        <dia:point val="-55.97,26"/>
+        <dia:point val="-43.045,26"/>
+        <dia:point val="-43.045,17"/>
       </dia:attribute>
-      <dia:attribute name="comment_line_length">
-        <dia:int val="17"/>
+      <dia:attribute name="orth_orient">
+        <dia:enum val="1"/>
+        <dia:enum val="0"/>
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="comment_tagging">
+      <dia:attribute name="orth_autoroute">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
+      <dia:attribute name="text_colour">
+        <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="line_color">
+      <dia:attribute name="line_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="fill_color">
-        <dia:color val="#ffffff"/>
+      <dia:connections>
+        <dia:connection handle="0" to="O89" connection="1"/>
+        <dia:connection handle="1" to="O97" connection="6"/>
+      </dia:connections>
+    </dia:object>
+    <dia:object type="UML - Association" version="2" id="O100">
+      <dia:attribute name="name">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="text_color">
-        <dia:color val="#000000"/>
+      <dia:attribute name="direction">
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="normal_font">
-        <dia:font family="monospace" style="0" name="Courier"/>
+      <dia:attribute name="show_direction">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="abstract_font">
-        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
+      <dia:attribute name="assoc_type">
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="polymorphic_font">
-        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
+      <dia:attribute name="role_a">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="classname_font">
-        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
+      <dia:attribute name="multipicity_a">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="abstract_classname_font">
-        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
+      <dia:attribute name="visibility_a">
+        <dia:enum val="3"/>
       </dia:attribute>
-      <dia:attribute name="comment_font">
-        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
+      <dia:attribute name="show_arrow_a">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="normal_font_height">
-        <dia:real val="0.80000000000000004"/>
+      <dia:attribute name="role_b">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="polymorphic_font_height">
-        <dia:real val="0.80000000000000004"/>
+      <dia:attribute name="multipicity_b">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="abstract_font_height">
-        <dia:real val="0.80000000000000004"/>
+      <dia:attribute name="visibility_b">
+        <dia:enum val="3"/>
       </dia:attribute>
-      <dia:attribute name="classname_font_height">
-        <dia:real val="1"/>
+      <dia:attribute name="show_arrow_b">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="abstract_classname_font_height">
-        <dia:real val="1"/>
+      <dia:attribute name="obj_pos">
+        <dia:point val="-17.5525,13"/>
       </dia:attribute>
-      <dia:attribute name="comment_font_height">
-        <dia:real val="0.69999999999999996"/>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="-39.14,8.25;-16.8025,14.8"/>
       </dia:attribute>
-      <dia:attribute name="attributes">
-        <dia:composite type="umlattribute">
-          <dia:attribute name="name">
-            <dia:string>#model_#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>#model#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="value">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="1"/>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-        </dia:composite>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="operations">
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#meta_data_tagger#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters">
-            <dia:composite type="umlparameter">
-              <dia:attribute name="name">
-                <dia:string>#m#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="type">
-                <dia:string>#model&amp;#</dia:string>
-              </dia:attribute>
-              <dia:attribute name="value">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="comment">
-                <dia:string>##</dia:string>
-              </dia:attribute>
-              <dia:attribute name="kind">
-                <dia:enum val="0"/>
-              </dia:attribute>
-            </dia:composite>
-          </dia:attribute>
-        </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#tag#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters"/>
-        </dia:composite>
+      <dia:attribute name="orth_points">
+        <dia:point val="-17.5525,13"/>
+        <dia:point val="-17.5525,9"/>
+        <dia:point val="-39.09,9"/>
+        <dia:point val="-39.09,14"/>
       </dia:attribute>
-      <dia:attribute name="template">
+      <dia:attribute name="orth_orient">
+        <dia:enum val="1"/>
+        <dia:enum val="0"/>
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="orth_autoroute">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="templates"/>
+      <dia:attribute name="text_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:connections>
+        <dia:connection handle="0" to="O94" connection="1"/>
+        <dia:connection handle="1" to="O97" connection="2"/>
+      </dia:connections>
     </dia:object>
-    <dia:object type="UML - Note" version="0" id="O109">
-      <dia:attribute name="obj_pos">
-        <dia:point val="-34,22"/>
+    <dia:object type="UML - Association" version="2" id="O101">
+      <dia:attribute name="name">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-34.05,21.95;-11.875,24.55"/>
+      <dia:attribute name="direction">
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
+      <dia:attribute name="show_direction">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="elem_corner">
-        <dia:point val="-34,22"/>
+      <dia:attribute name="assoc_type">
+        <dia:enum val="1"/>
       </dia:attribute>
-      <dia:attribute name="elem_width">
-        <dia:real val="22.075000000000003"/>
+      <dia:attribute name="role_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_a">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="elem_height">
-        <dia:real val="2.5"/>
+      <dia:attribute name="visibility_a">
+        <dia:enum val="3"/>
       </dia:attribute>
-      <dia:attribute name="line_width">
-        <dia:real val="0.10000000000000001"/>
+      <dia:attribute name="show_arrow_a">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
+      <dia:attribute name="role_b">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="fill_colour">
-        <dia:color val="#ffffff"/>
+      <dia:attribute name="multipicity_b">
+        <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="text">
-        <dia:composite type="text">
-          <dia:attribute name="string">
-            <dia:string>#Traverses the model as a graph and propagates meta data
-based on association and generalisation relationships.#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="font">
-            <dia:font family="monospace" style="0" name="Courier"/>
-          </dia:attribute>
-          <dia:attribute name="height">
-            <dia:real val="0.80000000000000004"/>
-          </dia:attribute>
-          <dia:attribute name="pos">
-            <dia:point val="-33.65,23.245"/>
-          </dia:attribute>
-          <dia:attribute name="color">
-            <dia:color val="#000000"/>
-          </dia:attribute>
-          <dia:attribute name="alignment">
-            <dia:enum val="0"/>
-          </dia:attribute>
-        </dia:composite>
+      <dia:attribute name="visibility_b">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_b">
+        <dia:boolean val="false"/>
       </dia:attribute>
-    </dia:object>
-    <dia:object type="UML - Message" version="0" id="O110">
       <dia:attribute name="obj_pos">
-        <dia:point val="-22.9625,22"/>
+        <dia:point val="-54.86,4.6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-23.0324,17.6486;-17.2745,22.0699"/>
+        <dia:rectangle val="-55.61,3.85;-46.8,14.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
-      <dia:attribute name="conn_endpoints">
-        <dia:point val="-22.9625,22"/>
-        <dia:point val="-17.5525,18"/>
+      <dia:attribute name="orth_points">
+        <dia:point val="-54.86,4.6"/>
+        <dia:point val="-54.86,9"/>
+        <dia:point val="-47,9"/>
+        <dia:point val="-47,14"/>
+      </dia:attribute>
+      <dia:attribute name="orth_orient">
+        <dia:enum val="1"/>
+        <dia:enum val="0"/>
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="orth_autoroute">
+        <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -12758,44 +11618,35 @@ based on association and generalisation relationships.#</dia:string>
       <dia:attribute name="line_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="text">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="type">
-        <dia:enum val="0"/>
-      </dia:attribute>
-      <dia:attribute name="text_pos">
-        <dia:point val="-20.2569,20.5"/>
-      </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O109" connection="1"/>
-        <dia:connection handle="1" to="O108" connection="6"/>
+        <dia:connection handle="0" to="O86" connection="7"/>
+        <dia:connection handle="1" to="O97" connection="0"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O111">
+    <dia:object type="UML - Class" version="0" id="O102">
       <dia:attribute name="obj_pos">
-        <dia:point val="-47,14"/>
+        <dia:point val="26,-6"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-47.05,13.95;-39.04,17.05"/>
+        <dia:rectangle val="25.95,-6.05;38.87,-2.35"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-47,14"/>
+        <dia:point val="26,-6"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="7.9099999999999993"/>
+        <dia:real val="12.82"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="3"/>
+        <dia:real val="3.6000000000000001"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#meta_data_error#</dia:string>
+        <dia:string>#json_hydrator#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
-        <dia:string>#exception#</dia:string>
+        <dia:string>#service#</dia:string>
       </dia:attribute>
       <dia:attribute name="comment">
-        <dia:string>#An error has occurred while peforming an operation related to meta data.#</dia:string>
+        <dia:string>##</dia:string>
       </dia:attribute>
       <dia:attribute name="abstract">
         <dia:boolean val="false"/>
@@ -12876,157 +11727,174 @@ based on association and generalisation relationships.#</dia:string>
         <dia:real val="0.69999999999999996"/>
       </dia:attribute>
       <dia:attribute name="attributes"/>
-      <dia:attribute name="operations"/>
+      <dia:attribute name="operations">
+        <dia:composite type="umloperation">
+          <dia:attribute name="name">
+            <dia:string>#hydrate#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="stereotype">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>#model#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="parameters">
+            <dia:composite type="umlparameter">
+              <dia:attribute name="name">
+                <dia:string>#s#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="type">
+                <dia:string>#std::istream&amp;#</dia:string>
+              </dia:attribute>
+              <dia:attribute name="value">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="comment">
+                <dia:string>##</dia:string>
+              </dia:attribute>
+              <dia:attribute name="kind">
+                <dia:enum val="0"/>
+              </dia:attribute>
+            </dia:composite>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
       <dia:attribute name="template">
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O112">
-      <dia:attribute name="name">
-        <dia:string>##</dia:string>
-      </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="show_direction">
-        <dia:boolean val="false"/>
+    <dia:object type="UML - Class" version="0" id="O103">
+      <dia:attribute name="obj_pos">
+        <dia:point val="8,-6"/>
       </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="7.95,-6.05;15.605,-2.95"/>
       </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="elem_corner">
+        <dia:point val="8,-6"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="elem_width">
+        <dia:real val="7.5549999999999997"/>
       </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
+      <dia:attribute name="elem_height">
+        <dia:real val="3"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_a">
-        <dia:boolean val="false"/>
+      <dia:attribute name="name">
+        <dia:string>#hydration_error#</dia:string>
       </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="stereotype">
+        <dia:string>#exception#</dia:string>
       </dia:attribute>
-      <dia:attribute name="multipicity_b">
+      <dia:attribute name="comment">
         <dia:string>##</dia:string>
       </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
-      </dia:attribute>
-      <dia:attribute name="show_arrow_b">
+      <dia:attribute name="abstract">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="obj_pos">
-        <dia:point val="-80,4.6"/>
-      </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-80.75,3.85;-72.4325,13.8"/>
+      <dia:attribute name="suppress_attributes">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
+      <dia:attribute name="suppress_operations">
+        <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="-80,4.6"/>
-        <dia:point val="-80,9"/>
-        <dia:point val="-72.6325,9"/>
-        <dia:point val="-72.6325,13"/>
+      <dia:attribute name="visible_attributes">
+        <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="1"/>
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
+      <dia:attribute name="visible_operations">
+        <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:attribute name="orth_autoroute">
+      <dia:attribute name="visible_comments">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
-      </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
+      <dia:attribute name="wrap_operations">
+        <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O100" connection="5"/>
-        <dia:connection handle="1" to="O105" connection="1"/>
-      </dia:connections>
-    </dia:object>
-    <dia:object type="UML - Association" version="2" id="O113">
-      <dia:attribute name="name">
-        <dia:string>##</dia:string>
+      <dia:attribute name="wrap_after_char">
+        <dia:int val="40"/>
       </dia:attribute>
-      <dia:attribute name="direction">
-        <dia:enum val="1"/>
+      <dia:attribute name="comment_line_length">
+        <dia:int val="17"/>
       </dia:attribute>
-      <dia:attribute name="show_direction">
+      <dia:attribute name="comment_tagging">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="assoc_type">
-        <dia:enum val="1"/>
-      </dia:attribute>
-      <dia:attribute name="role_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_a">
-        <dia:string>##</dia:string>
+      <dia:attribute name="line_color">
+        <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="visibility_a">
-        <dia:enum val="3"/>
+      <dia:attribute name="fill_color">
+        <dia:color val="#ffffff"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_a">
-        <dia:boolean val="false"/>
+      <dia:attribute name="text_color">
+        <dia:color val="#000000"/>
       </dia:attribute>
-      <dia:attribute name="role_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="normal_font">
+        <dia:font family="monospace" style="0" name="Courier"/>
       </dia:attribute>
-      <dia:attribute name="multipicity_b">
-        <dia:string>##</dia:string>
+      <dia:attribute name="abstract_font">
+        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
       </dia:attribute>
-      <dia:attribute name="visibility_b">
-        <dia:enum val="3"/>
+      <dia:attribute name="polymorphic_font">
+        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
       </dia:attribute>
-      <dia:attribute name="show_arrow_b">
-        <dia:boolean val="false"/>
+      <dia:attribute name="classname_font">
+        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
       </dia:attribute>
-      <dia:attribute name="obj_pos">
-        <dia:point val="-55.97,36"/>
+      <dia:attribute name="abstract_classname_font">
+        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
       </dia:attribute>
-      <dia:attribute name="obj_bb">
-        <dia:rectangle val="-56.72,16.95;-42.845,36.8"/>
+      <dia:attribute name="comment_font">
+        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
       </dia:attribute>
-      <dia:attribute name="meta">
-        <dia:composite type="dict"/>
+      <dia:attribute name="normal_font_height">
+        <dia:real val="0.80000000000000004"/>
       </dia:attribute>
-      <dia:attribute name="orth_points">
-        <dia:point val="-55.97,36"/>
-        <dia:point val="-55.97,26"/>
-        <dia:point val="-43.045,26"/>
-        <dia:point val="-43.045,17"/>
+      <dia:attribute name="polymorphic_font_height">
+        <dia:real val="0.80000000000000004"/>
       </dia:attribute>
-      <dia:attribute name="orth_orient">
-        <dia:enum val="1"/>
-        <dia:enum val="0"/>
-        <dia:enum val="1"/>
+      <dia:attribute name="abstract_font_height">
+        <dia:real val="0.80000000000000004"/>
       </dia:attribute>
-      <dia:attribute name="orth_autoroute">
-        <dia:boolean val="false"/>
+      <dia:attribute name="classname_font_height">
+        <dia:real val="1"/>
       </dia:attribute>
-      <dia:attribute name="text_colour">
-        <dia:color val="#000000"/>
+      <dia:attribute name="abstract_classname_font_height">
+        <dia:real val="1"/>
       </dia:attribute>
-      <dia:attribute name="line_colour">
-        <dia:color val="#000000"/>
+      <dia:attribute name="comment_font_height">
+        <dia:real val="0.69999999999999996"/>
       </dia:attribute>
-      <dia:connections>
-        <dia:connection handle="0" to="O103" connection="1"/>
-        <dia:connection handle="1" to="O111" connection="6"/>
-      </dia:connections>
+      <dia:attribute name="attributes"/>
+      <dia:attribute name="operations"/>
+      <dia:attribute name="template">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O114">
+    <dia:object type="UML - Association" version="2" id="O104">
       <dia:attribute name="name">
-        <dia:string>##</dia:string>
+        <dia:string>#on error throws &gt;#</dia:string>
       </dia:attribute>
       <dia:attribute name="direction">
         <dia:enum val="1"/>
@@ -13062,19 +11930,19 @@ based on association and generalisation relationships.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-17.5525,13"/>
+        <dia:point val="26,-2.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-39.14,8.25;-16.8025,14.8"/>
+        <dia:rectangle val="11.7275,-3.15;26.75,6.05"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-17.5525,13"/>
-        <dia:point val="-17.5525,9"/>
-        <dia:point val="-39.09,9"/>
-        <dia:point val="-39.09,14"/>
+        <dia:point val="26,-2.4"/>
+        <dia:point val="26,6"/>
+        <dia:point val="11.7775,6"/>
+        <dia:point val="11.7775,-3"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -13091,11 +11959,11 @@ based on association and generalisation relationships.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O108" connection="1"/>
-        <dia:connection handle="1" to="O111" connection="2"/>
+        <dia:connection handle="0" to="O102" connection="5"/>
+        <dia:connection handle="1" to="O103" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O115">
+    <dia:object type="UML - Association" version="2" id="O105">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -13133,19 +12001,19 @@ based on association and generalisation relationships.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="-54.86,4.6"/>
+        <dia:point val="38.82,-2.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-55.61,3.85;-46.8,14.8"/>
+        <dia:rectangle val="34.635,-3.15;39.57,13.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="-54.86,4.6"/>
-        <dia:point val="-54.86,9"/>
-        <dia:point val="-47,9"/>
-        <dia:point val="-47,14"/>
+        <dia:point val="38.82,-2.4"/>
+        <dia:point val="38.82,6"/>
+        <dia:point val="34.685,6"/>
+        <dia:point val="34.685,13"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -13162,28 +12030,28 @@ based on association and generalisation relationships.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O100" connection="7"/>
-        <dia:connection handle="1" to="O111" connection="0"/>
+        <dia:connection handle="0" to="O102" connection="7"/>
+        <dia:connection handle="1" to="O11" connection="2"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O116">
+    <dia:object type="UML - Class" version="0" id="O106">
       <dia:attribute name="obj_pos">
-        <dia:point val="26,-6"/>
+        <dia:point val="80,63"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="25.95,-6.05;38.87,-2.35"/>
+        <dia:rectangle val="79.95,62.25;99.055,67.45"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="26,-6"/>
+        <dia:point val="80,63"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="12.82"/>
+        <dia:real val="14.359999999999999"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="3.6000000000000001"/>
+        <dia:real val="4.4000000000000004"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#json_hydrator#</dia:string>
+        <dia:string>#all_types_traversal#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
         <dia:string>#service#</dia:string>
@@ -13273,13 +12141,13 @@ based on association and generalisation relationships.#</dia:string>
       <dia:attribute name="operations">
         <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#hydrate#</dia:string>
+            <dia:string>#all_types_traversal#</dia:string>
           </dia:attribute>
           <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="type">
-            <dia:string>#model#</dia:string>
+            <dia:string>##</dia:string>
           </dia:attribute>
           <dia:attribute name="visibility">
             <dia:enum val="0"/>
@@ -13302,10 +12170,10 @@ based on association and generalisation relationships.#</dia:string>
           <dia:attribute name="parameters">
             <dia:composite type="umlparameter">
               <dia:attribute name="name">
-                <dia:string>#s#</dia:string>
+                <dia:string>#m#</dia:string>
               </dia:attribute>
               <dia:attribute name="type">
-                <dia:string>#std::istream&amp;#</dia:string>
+                <dia:string>#const model&amp;#</dia:string>
               </dia:attribute>
               <dia:attribute name="value">
                 <dia:string>##</dia:string>
@@ -13319,36 +12187,196 @@ based on association and generalisation relationships.#</dia:string>
             </dia:composite>
           </dia:attribute>
         </dia:composite>
+        <dia:composite type="umloperation">
+          <dia:attribute name="name">
+            <dia:string>#traverse#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="stereotype">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="inheritance_type">
+            <dia:enum val="2"/>
+          </dia:attribute>
+          <dia:attribute name="query">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="parameters"/>
+        </dia:composite>
       </dia:attribute>
       <dia:attribute name="template">
+        <dia:boolean val="true"/>
+      </dia:attribute>
+      <dia:attribute name="templates">
+        <dia:composite type="umlformalparameter">
+          <dia:attribute name="name">
+            <dia:string>#TraversalVisitee#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
+    </dia:object>
+    <dia:object type="UML - Association" version="2" id="O107">
+      <dia:attribute name="name">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="direction">
+        <dia:enum val="2"/>
+      </dia:attribute>
+      <dia:attribute name="show_direction">
         <dia:boolean val="false"/>
       </dia:attribute>
-      <dia:attribute name="templates"/>
+      <dia:attribute name="assoc_type">
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="role_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="visibility_a">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_a">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="role_b">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_b">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="visibility_b">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_b">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="obj_pos">
+        <dia:point val="49.45,52.7"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="49.4,51.95;87.93,63.8"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
+      </dia:attribute>
+      <dia:attribute name="orth_points">
+        <dia:point val="49.45,52.7"/>
+        <dia:point val="87.18,52.7"/>
+        <dia:point val="87.18,63"/>
+      </dia:attribute>
+      <dia:attribute name="orth_orient">
+        <dia:enum val="0"/>
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="orth_autoroute">
+        <dia:boolean val="true"/>
+      </dia:attribute>
+      <dia:attribute name="text_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:connections>
+        <dia:connection handle="0" to="O73" connection="9"/>
+        <dia:connection handle="1" to="O106" connection="1"/>
+      </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O117">
+    <dia:object type="UML - Note" version="0" id="O108">
       <dia:attribute name="obj_pos">
-        <dia:point val="8,-6"/>
+        <dia:point val="-84,28"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="7.95,-6.05;15.605,-2.95"/>
+        <dia:rectangle val="-84.05,27.95;-69.96,30.55"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="8,-6"/>
+        <dia:point val="-84,28"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="7.5549999999999997"/>
+        <dia:real val="13.99"/>
+      </dia:attribute>
+      <dia:attribute name="elem_height">
+        <dia:real val="2.5"/>
+      </dia:attribute>
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="fill_colour">
+        <dia:color val="#ffffff"/>
+      </dia:attribute>
+      <dia:attribute name="text">
+        <dia:composite type="text">
+          <dia:attribute name="string">
+            <dia:string>#Helper class to perform reads on a
+boost::property_tree::ptreee#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="font">
+            <dia:font family="monospace" style="0" name="Courier"/>
+          </dia:attribute>
+          <dia:attribute name="height">
+            <dia:real val="0.80000000000000004"/>
+          </dia:attribute>
+          <dia:attribute name="pos">
+            <dia:point val="-83.65,29.245"/>
+          </dia:attribute>
+          <dia:attribute name="color">
+            <dia:color val="#000000"/>
+          </dia:attribute>
+          <dia:attribute name="alignment">
+            <dia:enum val="0"/>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
+    </dia:object>
+    <dia:object type="UML - Class" version="0" id="O109">
+      <dia:attribute name="obj_pos">
+        <dia:point val="63,63"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="62.95,62.95;71.8675,72.25"/>
+      </dia:attribute>
+      <dia:attribute name="elem_corner">
+        <dia:point val="63,63"/>
+      </dia:attribute>
+      <dia:attribute name="elem_width">
+        <dia:real val="8.817499999999999"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="3"/>
+        <dia:real val="9.2000000000000011"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#hydration_error#</dia:string>
+        <dia:string>#relationship_types#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
-        <dia:string>#exception#</dia:string>
+        <dia:string>#enumeration#</dia:string>
       </dia:attribute>
       <dia:attribute name="comment">
-        <dia:string>##</dia:string>
+        <dia:string>#Ways in which a type can be related to another for indexing purposes.#</dia:string>
       </dia:attribute>
       <dia:attribute name="abstract">
         <dia:boolean val="false"/>
@@ -13428,16 +12456,201 @@ based on association and generalisation relationships.#</dia:string>
       <dia:attribute name="comment_font_height">
         <dia:real val="0.69999999999999996"/>
       </dia:attribute>
-      <dia:attribute name="attributes"/>
+      <dia:attribute name="attributes">
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#original_parents#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Types at the root of the inheritance hierarchy.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#parents#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Types that are direct parents of this type.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#regular_associations#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Types that are involved in aggregation or composition relationships.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#pointer_associations#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Types that are involved in aggregation or composition relationships via a pointer.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#leaves#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Types that are at the bottom of the inheritance tree.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#visitor#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Type that provides visitation services for this type.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#key#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Types that are used in the identity function of this type. #</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+        <dia:composite type="umlattribute">
+          <dia:attribute name="name">
+            <dia:string>#modeled_concepts#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="type">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="value">
+            <dia:string>##</dia:string>
+          </dia:attribute>
+          <dia:attribute name="comment">
+            <dia:string>#Concepts modeled by this type.#</dia:string>
+          </dia:attribute>
+          <dia:attribute name="visibility">
+            <dia:enum val="0"/>
+          </dia:attribute>
+          <dia:attribute name="abstract">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+          <dia:attribute name="class_scope">
+            <dia:boolean val="false"/>
+          </dia:attribute>
+        </dia:composite>
+      </dia:attribute>
       <dia:attribute name="operations"/>
       <dia:attribute name="template">
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O118">
+    <dia:object type="UML - Association" version="2" id="O110">
       <dia:attribute name="name">
-        <dia:string>#on error throws &gt;#</dia:string>
+        <dia:string>##</dia:string>
       </dia:attribute>
       <dia:attribute name="direction">
         <dia:enum val="1"/>
@@ -13473,19 +12686,19 @@ based on association and generalisation relationships.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="26,-2.4"/>
+        <dia:point val="75.835,86"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="11.7275,-3.15;26.75,6.05"/>
+        <dia:rectangle val="67.3587,72.15;76.585,86.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="26,-2.4"/>
-        <dia:point val="26,6"/>
-        <dia:point val="11.7775,6"/>
-        <dia:point val="11.7775,-3"/>
+        <dia:point val="75.835,86"/>
+        <dia:point val="75.835,81"/>
+        <dia:point val="67.4087,81"/>
+        <dia:point val="67.4087,72.2"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -13502,11 +12715,11 @@ based on association and generalisation relationships.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O116" connection="5"/>
-        <dia:connection handle="1" to="O117" connection="6"/>
+        <dia:connection handle="0" to="O62" connection="2"/>
+        <dia:connection handle="1" to="O109" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O119">
+    <dia:object type="UML - Association" version="2" id="O111">
       <dia:attribute name="name">
         <dia:string>##</dia:string>
       </dia:attribute>
@@ -13544,19 +12757,19 @@ based on association and generalisation relationships.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="38.82,-2.4"/>
+        <dia:point val="87.18,67.4"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="34.635,-3.15;39.57,13.8"/>
+        <dia:rectangle val="86.43,66.65;95.2,82.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="38.82,-2.4"/>
-        <dia:point val="38.82,6"/>
-        <dia:point val="34.685,6"/>
-        <dia:point val="34.685,13"/>
+        <dia:point val="87.18,67.4"/>
+        <dia:point val="87.18,75.05"/>
+        <dia:point val="95,75.05"/>
+        <dia:point val="95,82"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
         <dia:enum val="1"/>
@@ -13564,8 +12777,79 @@ based on association and generalisation relationships.#</dia:string>
         <dia:enum val="1"/>
       </dia:attribute>
       <dia:attribute name="orth_autoroute">
+        <dia:boolean val="true"/>
+      </dia:attribute>
+      <dia:attribute name="text_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:connections>
+        <dia:connection handle="0" to="O106" connection="6"/>
+        <dia:connection handle="1" to="O85" connection="0"/>
+      </dia:connections>
+    </dia:object>
+    <dia:object type="UML - Association" version="2" id="O112">
+      <dia:attribute name="name">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="direction">
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="show_direction">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="assoc_type">
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="role_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="visibility_a">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_a">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="role_b">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_b">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="visibility_b">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_b">
         <dia:boolean val="false"/>
       </dia:attribute>
+      <dia:attribute name="obj_pos">
+        <dia:point val="115.18,67.4"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="105.46,66.65;115.93,82.8"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
+      </dia:attribute>
+      <dia:attribute name="orth_points">
+        <dia:point val="115.18,67.4"/>
+        <dia:point val="115.18,75.05"/>
+        <dia:point val="105.51,75.05"/>
+        <dia:point val="105.51,82"/>
+      </dia:attribute>
+      <dia:attribute name="orth_orient">
+        <dia:enum val="1"/>
+        <dia:enum val="0"/>
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="orth_autoroute">
+        <dia:boolean val="true"/>
+      </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
       </dia:attribute>
@@ -13573,28 +12857,28 @@ based on association and generalisation relationships.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O116" connection="7"/>
-        <dia:connection handle="1" to="O13" connection="2"/>
+        <dia:connection handle="0" to="O83" connection="6"/>
+        <dia:connection handle="1" to="O85" connection="2"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Class" version="0" id="O120">
+    <dia:object type="UML - Class" version="0" id="O113">
       <dia:attribute name="obj_pos">
-        <dia:point val="177,82"/>
+        <dia:point val="48,13"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="176.95,81.25;196.055,86.45"/>
+        <dia:rectangle val="47.95,12.95;54.71,16.65"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="177,82"/>
+        <dia:point val="48,13"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="14.359999999999999"/>
+        <dia:real val="6.6600000000000001"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
-        <dia:real val="4.4000000000000004"/>
+        <dia:real val="3.6000000000000001"/>
       </dia:attribute>
       <dia:attribute name="name">
-        <dia:string>#all_types_traversal#</dia:string>
+        <dia:string>#indexer#</dia:string>
       </dia:attribute>
       <dia:attribute name="stereotype">
         <dia:string>#service#</dia:string>
@@ -13684,7 +12968,7 @@ based on association and generalisation relationships.#</dia:string>
       <dia:attribute name="operations">
         <dia:composite type="umloperation">
           <dia:attribute name="name">
-            <dia:string>#all_types_traversal#</dia:string>
+            <dia:string>#index#</dia:string>
           </dia:attribute>
           <dia:attribute name="stereotype">
             <dia:string>##</dia:string>
@@ -13716,7 +13000,7 @@ based on association and generalisation relationships.#</dia:string>
                 <dia:string>#m#</dia:string>
               </dia:attribute>
               <dia:attribute name="type">
-                <dia:string>#const model&amp;#</dia:string>
+                <dia:string>#model&amp;#</dia:string>
               </dia:attribute>
               <dia:attribute name="value">
                 <dia:string>##</dia:string>
@@ -13730,57 +13014,128 @@ based on association and generalisation relationships.#</dia:string>
             </dia:composite>
           </dia:attribute>
         </dia:composite>
-        <dia:composite type="umloperation">
-          <dia:attribute name="name">
-            <dia:string>#traverse#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="stereotype">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="visibility">
-            <dia:enum val="0"/>
-          </dia:attribute>
-          <dia:attribute name="comment">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-          <dia:attribute name="abstract">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="inheritance_type">
-            <dia:enum val="2"/>
-          </dia:attribute>
-          <dia:attribute name="query">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="class_scope">
-            <dia:boolean val="false"/>
-          </dia:attribute>
-          <dia:attribute name="parameters"/>
-        </dia:composite>
       </dia:attribute>
       <dia:attribute name="template">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="templates"/>
+    </dia:object>
+    <dia:object type="UML - Class" version="0" id="O114">
+      <dia:attribute name="obj_pos">
+        <dia:point val="63,-5"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="62.95,-5.05;70.12,-1.95"/>
+      </dia:attribute>
+      <dia:attribute name="elem_corner">
+        <dia:point val="63,-5"/>
+      </dia:attribute>
+      <dia:attribute name="elem_width">
+        <dia:real val="7.0700000000000003"/>
+      </dia:attribute>
+      <dia:attribute name="elem_height">
+        <dia:real val="3"/>
+      </dia:attribute>
+      <dia:attribute name="name">
+        <dia:string>#indexing_error#</dia:string>
+      </dia:attribute>
+      <dia:attribute name="stereotype">
+        <dia:string>#exception#</dia:string>
+      </dia:attribute>
+      <dia:attribute name="comment">
+        <dia:string>#An error occurred while trying to index a model.#</dia:string>
+      </dia:attribute>
+      <dia:attribute name="abstract">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="suppress_attributes">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="suppress_operations">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="visible_attributes">
         <dia:boolean val="true"/>
       </dia:attribute>
-      <dia:attribute name="templates">
-        <dia:composite type="umlformalparameter">
-          <dia:attribute name="name">
-            <dia:string>#TraversalVisitee#</dia:string>
-          </dia:attribute>
-          <dia:attribute name="type">
-            <dia:string>##</dia:string>
-          </dia:attribute>
-        </dia:composite>
+      <dia:attribute name="visible_operations">
+        <dia:boolean val="true"/>
+      </dia:attribute>
+      <dia:attribute name="visible_comments">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="wrap_operations">
+        <dia:boolean val="true"/>
+      </dia:attribute>
+      <dia:attribute name="wrap_after_char">
+        <dia:int val="40"/>
+      </dia:attribute>
+      <dia:attribute name="comment_line_length">
+        <dia:int val="17"/>
+      </dia:attribute>
+      <dia:attribute name="comment_tagging">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="line_width">
+        <dia:real val="0.10000000000000001"/>
+      </dia:attribute>
+      <dia:attribute name="line_color">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="fill_color">
+        <dia:color val="#ffffff"/>
+      </dia:attribute>
+      <dia:attribute name="text_color">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="normal_font">
+        <dia:font family="monospace" style="0" name="Courier"/>
+      </dia:attribute>
+      <dia:attribute name="abstract_font">
+        <dia:font family="monospace" style="88" name="Courier-BoldOblique"/>
+      </dia:attribute>
+      <dia:attribute name="polymorphic_font">
+        <dia:font family="monospace" style="8" name="Courier-Oblique"/>
+      </dia:attribute>
+      <dia:attribute name="classname_font">
+        <dia:font family="sans" style="80" name="Helvetica-Bold"/>
+      </dia:attribute>
+      <dia:attribute name="abstract_classname_font">
+        <dia:font family="sans" style="88" name="Helvetica-BoldOblique"/>
+      </dia:attribute>
+      <dia:attribute name="comment_font">
+        <dia:font family="sans" style="8" name="Helvetica-Oblique"/>
+      </dia:attribute>
+      <dia:attribute name="normal_font_height">
+        <dia:real val="0.80000000000000004"/>
+      </dia:attribute>
+      <dia:attribute name="polymorphic_font_height">
+        <dia:real val="0.80000000000000004"/>
+      </dia:attribute>
+      <dia:attribute name="abstract_font_height">
+        <dia:real val="0.80000000000000004"/>
+      </dia:attribute>
+      <dia:attribute name="classname_font_height">
+        <dia:real val="1"/>
+      </dia:attribute>
+      <dia:attribute name="abstract_classname_font_height">
+        <dia:real val="1"/>
+      </dia:attribute>
+      <dia:attribute name="comment_font_height">
+        <dia:real val="0.69999999999999996"/>
       </dia:attribute>
+      <dia:attribute name="attributes"/>
+      <dia:attribute name="operations"/>
+      <dia:attribute name="template">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="templates"/>
     </dia:object>
-    <dia:object type="UML - Association" version="2" id="O121">
+    <dia:object type="UML - Association" version="2" id="O115">
       <dia:attribute name="name">
-        <dia:string>##</dia:string>
+        <dia:string>#throws on failure &gt;#</dia:string>
       </dia:attribute>
       <dia:attribute name="direction">
-        <dia:enum val="2"/>
+        <dia:enum val="1"/>
       </dia:attribute>
       <dia:attribute name="show_direction">
         <dia:boolean val="false"/>
@@ -13813,25 +13168,27 @@ based on association and generalisation relationships.#</dia:string>
         <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="obj_pos">
-        <dia:point val="49.45,52.7"/>
+        <dia:point val="51.33,13"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="49.4,51.95;184.93,82.8"/>
+        <dia:rectangle val="50.58,-2.05;66.735,13.8"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="orth_points">
-        <dia:point val="49.45,52.7"/>
-        <dia:point val="184.18,52.7"/>
-        <dia:point val="184.18,82"/>
+        <dia:point val="51.33,13"/>
+        <dia:point val="51.33,6"/>
+        <dia:point val="66.535,6"/>
+        <dia:point val="66.535,-2"/>
       </dia:attribute>
       <dia:attribute name="orth_orient">
+        <dia:enum val="1"/>
         <dia:enum val="0"/>
         <dia:enum val="1"/>
       </dia:attribute>
       <dia:attribute name="orth_autoroute">
-        <dia:boolean val="true"/>
+        <dia:boolean val="false"/>
       </dia:attribute>
       <dia:attribute name="text_colour">
         <dia:color val="#000000"/>
@@ -13840,25 +13197,25 @@ based on association and generalisation relationships.#</dia:string>
         <dia:color val="#000000"/>
       </dia:attribute>
       <dia:connections>
-        <dia:connection handle="0" to="O75" connection="9"/>
-        <dia:connection handle="1" to="O120" connection="1"/>
+        <dia:connection handle="0" to="O113" connection="1"/>
+        <dia:connection handle="1" to="O114" connection="6"/>
       </dia:connections>
     </dia:object>
-    <dia:object type="UML - Note" version="0" id="O122">
+    <dia:object type="UML - Note" version="0" id="O116">
       <dia:attribute name="obj_pos">
-        <dia:point val="-84,28"/>
+        <dia:point val="67,13"/>
       </dia:attribute>
       <dia:attribute name="obj_bb">
-        <dia:rectangle val="-84.05,27.95;-69.96,30.55"/>
+        <dia:rectangle val="66.95,12.95;88.74,15.55"/>
       </dia:attribute>
       <dia:attribute name="meta">
         <dia:composite type="dict"/>
       </dia:attribute>
       <dia:attribute name="elem_corner">
-        <dia:point val="-84,28"/>
+        <dia:point val="67,13"/>
       </dia:attribute>
       <dia:attribute name="elem_width">
-        <dia:real val="13.99"/>
+        <dia:real val="21.690000000000001"/>
       </dia:attribute>
       <dia:attribute name="elem_height">
         <dia:real val="2.5"/>
@@ -13875,8 +13232,8 @@ based on association and generalisation relationships.#</dia:string>
       <dia:attribute name="text">
         <dia:composite type="text">
           <dia:attribute name="string">
-            <dia:string>#Helper class to perform reads on a
-boost::property_tree::ptreee#</dia:string>
+            <dia:string>#The indexer popualtes all the indexing data structures
+such as leaves, all properties, etc.#</dia:string>
           </dia:attribute>
           <dia:attribute name="font">
             <dia:font family="monospace" style="0" name="Courier"/>
@@ -13885,7 +13242,7 @@ boost::property_tree::ptreee#</dia:string>
             <dia:real val="0.80000000000000004"/>
           </dia:attribute>
           <dia:attribute name="pos">
-            <dia:point val="-83.65,29.245"/>
+            <dia:point val="67.35,14.245"/>
           </dia:attribute>
           <dia:attribute name="color">
             <dia:color val="#000000"/>
@@ -13896,5 +13253,110 @@ boost::property_tree::ptreee#</dia:string>
         </dia:composite>
       </dia:attribute>
     </dia:object>
+    <dia:object type="UML - Message" version="0" id="O117">
+      <dia:attribute name="obj_pos">
+        <dia:point val="67,14.25"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="54.6051,13.6994;67.0506,14.8749"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
+      </dia:attribute>
+      <dia:attribute name="conn_endpoints">
+        <dia:point val="67,14.25"/>
+        <dia:point val="54.66,14.1"/>
+      </dia:attribute>
+      <dia:attribute name="text_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="text">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="type">
+        <dia:enum val="0"/>
+      </dia:attribute>
+      <dia:attribute name="text_pos">
+        <dia:point val="60.83,14.6749"/>
+      </dia:attribute>
+      <dia:connections>
+        <dia:connection handle="0" to="O116" connection="3"/>
+        <dia:connection handle="1" to="O113" connection="4"/>
+      </dia:connections>
+    </dia:object>
+    <dia:object type="UML - Association" version="2" id="O118">
+      <dia:attribute name="name">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="direction">
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="show_direction">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="assoc_type">
+        <dia:enum val="1"/>
+      </dia:attribute>
+      <dia:attribute name="role_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_a">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="visibility_a">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_a">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="role_b">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="multipicity_b">
+        <dia:string>##</dia:string>
+      </dia:attribute>
+      <dia:attribute name="visibility_b">
+        <dia:enum val="3"/>
+      </dia:attribute>
+      <dia:attribute name="show_arrow_b">
+        <dia:boolean val="false"/>
+      </dia:attribute>
+      <dia:attribute name="obj_pos">
+        <dia:point val="34.685,14.1"/>
+      </dia:attribute>
+      <dia:attribute name="obj_bb">
+        <dia:rectangle val="33.935,13.35;48.05,15.7"/>
+      </dia:attribute>
+      <dia:attribute name="meta">
+        <dia:composite type="dict"/>
+      </dia:attribute>
+      <dia:attribute name="orth_points">
+        <dia:point val="34.685,14.1"/>
+        <dia:point val="35.435,14.1"/>
+        <dia:point val="47.95,14.1"/>
+        <dia:point val="48,14.1"/>
+      </dia:attribute>
+      <dia:attribute name="orth_orient">
+        <dia:enum val="0"/>
+        <dia:enum val="1"/>
+        <dia:enum val="0"/>
+      </dia:attribute>
+      <dia:attribute name="orth_autoroute">
+        <dia:boolean val="true"/>
+      </dia:attribute>
+      <dia:attribute name="text_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:attribute name="line_colour">
+        <dia:color val="#000000"/>
+      </dia:attribute>
+      <dia:connections>
+        <dia:connection handle="0" to="O11" connection="4"/>
+        <dia:connection handle="1" to="O113" connection="3"/>
+      </dia:connections>
+    </dia:object>
   </dia:layer>
 </dia:diagram>
diff --git a/doc/agile/release_notes_sprint_38.org b/doc/agile/release_notes_sprint_38.org
index 341cf30..d8abb21 100644
--- a/doc/agile/release_notes_sprint_38.org
+++ b/doc/agile/release_notes_sprint_38.org
@@ -10,15 +10,15 @@ This file contains all stories that were closed during sprint 38.
 ** Development Stories Implemented
 
 #+begin: clocktable :maxlevel 3 :scope subtree
-Clock summary at [2013-11-04 Mon 21:42]
+Clock summary at [2013-11-08 Fri 11:17]
 
 | Headline                                                                  | Time   |      |      |
 |---------------------------------------------------------------------------+--------+------+------|
-| *Total time*                                                              | *1:11* |      |      |
+| *Total time*                                                              | *3:56* |      |      |
 |---------------------------------------------------------------------------+--------+------+------|
-| Development Stories Implemented                                           |        | 1:11 |      |
+| Development Stories Implemented                                           |        | 3:56 |      |
 | IMPLEMENTATION Release notes and backlog grooming                         |        |      | 0:04 |
-| IMPLEMENTATION Implement auxiliar data structures required for formatting |        |      | 1:07 |
+| IMPLEMENTATION Implement auxiliar data structures required for formatting |        |      | 3:52 |
 #+end:
 
 *** IMPLEMENTATION Release notes and backlog grooming                  :task:
@@ -27,14 +27,6 @@ Clock summary at [2013-11-04 Mon 21:42]
 *** IMPLEMENTATION Implement auxiliar data structures required for formatting :story:
     CLOCK: [2013-11-04 Mon 07:53]--[2013-11-04 Mon 07:54] =>  0:01
 
-- create a class to aggregate the licence, modeline and
-  marker.
-- create an enumeration for all relationship types: parent, child,
-  association, association_via_pointer, leaf
-- create a model index, made up of: leafs for entire model,
-  relationships by qname, leaves by qname, properties by qname (all
-  properties, local properties, inherited properties). make this a
-  property of the model.
 - create an indexer that populates the index. add indexer to SML
   workflow.
 - create a class to aggregate type information: type itself, indexed
@@ -49,6 +41,9 @@ Clock summary at [2013-11-04 Mon 21:42]
      CLOCK: [2013-11-04 Mon 08:24]--[2013-11-04 Mon 08:32] =>  0:08
      CLOCK: [2013-11-04 Mon 07:54]--[2013-11-04 Mon 08:15] =>  0:21
 
+create a class to aggregate the licence, modeline and
+marker.
+
 namestorming: authorship, about, origination, file_meta_data,
 file_details.
 
@@ -64,6 +59,62 @@ confusing.
 Instead we'll use =annotation=. Implies meta-data still, but avoids
 confusion with the SML kind.
 
+**** IMPLEMENTATION Create indexing data structures                    :task:
+     CLOCK: [2013-11-09 Sat 22:43]--[2013-11-10 Sun 01:05] =>  2:22
+     CLOCK: [2013-11-09 Sat 22:07]--[2013-11-09 Sat 22:08] =>  0:01
+     CLOCK: [2013-11-08 Fri 07:49]--[2013-11-08 Fri 08:20] =>  0:31
+     CLOCK: [2013-11-07 Thu 18:00]--[2013-11-07 Thu 18:10] =>  0:10
+     CLOCK: [2013-11-07 Thu 08:23]--[2013-11-07 Thu 08:33] =>  0:10
+     CLOCK: [2013-11-07 Thu 07:47]--[2013-11-07 Thu 08:18] =>  0:31
+     CLOCK: [2013-11-06 Wed 08:24]--[2013-11-06 Wed 08:29] =>  0:05
+     CLOCK: [2013-11-06 Wed 07:46]--[2013-11-06 Wed 08:17] =>  0:31
+     CLOCK: [2013-11-05 Tue 08:26]--[2013-11-05 Tue 08:35] =>  0:09
+     CLOCK: [2013-11-05 Tue 07:48]--[2013-11-05 Tue 08:20] =>  0:32
+     CLOCK: [2013-11-05 Tue 07:38]--[2013-11-05 Tue 07:44] =>  0:06
+
+New understanding:
+
+Its better to piggy-back on existing machinery. So:
+
+- leave model as is, with a leaves container. model cannot have any
+  other type of relationship so this is in keeping with making invalid
+  states unrepresentable.
+- change Stateful to contain properties by property type or property
+  set. No point in using an enumeration for the sets because the
+  inherited properties need the parent's qname.
+- create a relationships container in abstract object and replace
+  existing relationships with it.
+- Create an indexer to add additional data to containers.
+
+Old understanding:
+
+The objective of this exercise is to create a data structure that can
+store all the data associated with a type needed for formatting.
+
+- create an enumeration for all possible relationship types. name:
+  =relationship_types=. values: original_parent, parent,
+  regular_association, pointer_association, leaf, visitor, key.
+- create an enumeration for the property sets. name:
+  =property_sets=. values: all, inherited, self
+
+- create a class called =index= with two properties: =relationships=
+  and =properties=:
+
+: relationships: std::unordered_map<relationship_types,std::list<qname>>
+: properties: std::unordered_map<property_types,std::list<property>>
+
+- create a concept called =Indexable= with a property of type =index=.
+  the concept is modeled by =model= and =abstract_object=.
+
+- create a class called =indexer=, responsible for taking in a merged
+  model and populating the index property of all things
+  Indexable. Move code from =extrator= and =transformer= (leaf
+  processing) into =indexer=.
+
+- delete property cache interface etc and make user of index.
+
+- delete extractor, etc and make user of index.
+
 *** Add include file support to main type formatter                   :story:
 *** Add tests for properties and compiler generated functions         :story:
 *** Add tests for module in model                                     :story:
diff --git a/projects/dia_to_sml/include/dogen/dia_to_sml/types/context.hpp b/projects/dia_to_sml/include/dogen/dia_to_sml/types/context.hpp
index c95fed0..f37faf1 100644
--- a/projects/dia_to_sml/include/dogen/dia_to_sml/types/context.hpp
+++ b/projects/dia_to_sml/include/dogen/dia_to_sml/types/context.hpp
@@ -31,7 +31,6 @@
 #include <unordered_map>
 #include <unordered_set>
 #include "dogen/dia_to_sml/serialization/context_fwd_ser.hpp"
-#include "dogen/sml/hash/qname_hash.hpp"
 #include "dogen/sml/types/model.hpp"
 #include "dogen/sml/types/qname.hpp"
 
@@ -56,8 +55,6 @@ public:
         const std::unordered_map<std::string, std::list<std::string> >& child_id_to_parent_ids,
         const std::unordered_set<std::string>& parent_ids,
         const std::unordered_map<std::string, dogen::sml::qname>& id_to_qname,
-        const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& original_parent,
-        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& leaves,
         const std::unordered_set<std::string>& top_level_module_names,
         const dogen::sml::model& model);
 
@@ -108,26 +105,6 @@ public:
     /**@}*/
 
     /**
-     * @brief Maps a QName to its corresponding top-most parent in an inheritance tree.
-     */
-    /**@{*/
-    const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& original_parent() const;
-    std::unordered_map<dogen::sml::qname, dogen::sml::qname>& original_parent();
-    void original_parent(const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& v);
-    void original_parent(const std::unordered_map<dogen::sml::qname, dogen::sml::qname>&& v);
-    /**@}*/
-
-    /**
-     * @brief All outermost derived objects in an inheritance tree.
-     */
-    /**@{*/
-    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& leaves() const;
-    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& leaves();
-    void leaves(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& v);
-    void leaves(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >&& v);
-    /**@}*/
-
-    /**
      * @brief All modules that sit just below the model.
      */
     /**@{*/
@@ -162,8 +139,6 @@ private:
     std::unordered_map<std::string, std::list<std::string> > child_id_to_parent_ids_;
     std::unordered_set<std::string> parent_ids_;
     std::unordered_map<std::string, dogen::sml::qname> id_to_qname_;
-    std::unordered_map<dogen::sml::qname, dogen::sml::qname> original_parent_;
-    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> > leaves_;
     std::unordered_set<std::string> top_level_module_names_;
     dogen::sml::model model_;
 };
diff --git a/projects/dia_to_sml/include/dogen/dia_to_sml/types/transformer.hpp b/projects/dia_to_sml/include/dogen/dia_to_sml/types/transformer.hpp
index 2f1bcd1..b09294f 100644
--- a/projects/dia_to_sml/include/dogen/dia_to_sml/types/transformer.hpp
+++ b/projects/dia_to_sml/include/dogen/dia_to_sml/types/transformer.hpp
@@ -128,7 +128,7 @@ private:
      */
     template<typename Element>
     void update_element(Element& e, const processed_object& o,
-        const profile& p) {
+        const profile& p) const {
         e.generation_type(generation_type(p));
         e.origin_type(sml::origin_types::user);
         e.name(to_qname(o.name(), o.child_node_id()));
@@ -141,6 +141,24 @@ private:
     }
 
     /**
+     * @brief Updates the properties of the Stateful using the
+     * processed object as the source.
+     */
+    template<typename Stateful>
+    void update_properties(Stateful& s, const processed_object& o) {
+        for (const auto& p : o.properties()) {
+            const auto property(to_property(p));
+            s.local_properties().push_back(property);
+            update_model_references(property.type());
+        }
+    }
+
+    /**
+     * @brief Given an object ID returns all of its parents, if any.
+     */
+    std::list<sml::qname> parent_qnames_for_id(const std::string& id) const;
+
+    /**
      * @brief Update the SML abstract object using the processed
      * object and the profile.
      */
diff --git a/projects/dia_to_sml/include/dogen/dia_to_sml/types/workflow.hpp b/projects/dia_to_sml/include/dogen/dia_to_sml/types/workflow.hpp
index 10bde6b..6365d24 100644
--- a/projects/dia_to_sml/include/dogen/dia_to_sml/types/workflow.hpp
+++ b/projects/dia_to_sml/include/dogen/dia_to_sml/types/workflow.hpp
@@ -70,11 +70,6 @@ private:
      */
     void graph_to_context_activity(const graph_type& g);
 
-    /**
-     * @brief Performs any required post-processing to the SML model.
-     */
-    void post_process_model_activity();
-
 public:
     virtual sml::model execute(const dia::diagram& diagram,
         const std::string& model_name,
diff --git a/projects/dia_to_sml/spec/transformer_spec.cpp b/projects/dia_to_sml/spec/transformer_spec.cpp
index 2b63401..debd644 100644
--- a/projects/dia_to_sml/spec/transformer_spec.cpp
+++ b/projects/dia_to_sml/spec/transformer_spec.cpp
@@ -132,7 +132,7 @@ BOOST_AUTO_TEST_CASE(uml_class_with_no_stereotype_transforms_into_expected_value
     const auto vo(dynamic_cast<const dogen::sml::value_object&>(obj));
     BOOST_CHECK(vo.name().model_name() == model_name);
     BOOST_CHECK(!vo.name().simple_name().empty());
-    BOOST_CHECK(vo.properties().empty());
+    BOOST_CHECK(vo.local_properties().empty());
     BOOST_CHECK(!vo.documentation().empty());
 }
 
@@ -345,7 +345,7 @@ BOOST_AUTO_TEST_CASE(uml_class_in_package_transforms_into_expected_object) {
     const auto& obj(*c.model().objects().begin()->second);
     BOOST_CHECK(obj.name().model_name() == model_name);
     BOOST_CHECK(!obj.name().simple_name().empty());
-    BOOST_CHECK(obj.properties().empty());
+    BOOST_CHECK(obj.local_properties().empty());
 
     const auto vo(dynamic_cast<const dogen::sml::value_object&>(obj));
     BOOST_REQUIRE(obj.name().module_path().size() == 1);
@@ -642,7 +642,7 @@ BOOST_AUTO_TEST_CASE(uml_class_in_two_packages_transforms_into_expected_object)
     const auto& obj(*c.model().objects().begin()->second);
     BOOST_CHECK(obj.name().model_name() == model_name);
     BOOST_CHECK(!obj.name().simple_name().empty());
-    BOOST_CHECK(obj.properties().empty());
+    BOOST_CHECK(obj.local_properties().empty());
     const auto vo(dynamic_cast<const dogen::sml::value_object&>(obj));
     BOOST_REQUIRE(obj.name().module_path().size() == 2);
     BOOST_CHECK(obj.name().module_path().front() == first);
@@ -1202,12 +1202,14 @@ BOOST_AUTO_TEST_CASE(uml_class_with_inheritance_results_in_expected_object) {
     for (const auto& pair : c.model().objects()) {
         const auto& qn(pair.first);
         const auto& o(*pair.second);
-        if (is_type_one(qn)) {
-            BOOST_CHECK(!o.parent_name());
-            BOOST_CHECK(!o.original_parent_name());
-        } else if (is_type_two(qn)) {
-            BOOST_REQUIRE(o.parent_name());
-            BOOST_REQUIRE(is_type_one(*o.parent_name()));
+        using dogen::sml::relationship_types;
+        const auto i(o.relationships().find(relationship_types::parents));
+        if (is_type_one(qn))
+            BOOST_CHECK(i == o.relationships().end());
+        else if (is_type_two(qn)) {
+            BOOST_REQUIRE(i != o.relationships().end());
+            BOOST_REQUIRE(i->second.size() == 1);
+            BOOST_CHECK(is_type_one(i->second.front()));
         } else {
             BOOST_LOG_SEV(lg, error) << "Unexpected type name: " << qn;
             BOOST_FAIL("Unexpected type name");
@@ -1234,10 +1236,11 @@ BOOST_AUTO_TEST_CASE(uml_class_with_one_property_transforms_into_value_object_wi
 
     BOOST_CHECK(is_type_zero(vo.name()));
     BOOST_CHECK(!vo.documentation().empty());
-    BOOST_REQUIRE(vo.properties().size() == 1);
-    BOOST_CHECK(is_type_zero(vo.properties().front().name()));
-    BOOST_CHECK(!vo.properties().front().type().type().simple_name().empty());
-    BOOST_CHECK(!vo.properties().front().documentation().empty());
+    const auto& lp(vo.local_properties());
+    BOOST_REQUIRE(lp.size() == 1);
+    BOOST_CHECK(is_type_zero(lp.front().name()));
+    BOOST_CHECK(!lp.front().type().type().simple_name().empty());
+    BOOST_CHECK(!lp.front().documentation().empty());
 }
 
 BOOST_AUTO_TEST_SUITE_END()
diff --git a/projects/dia_to_sml/src/hash/context_hash.cpp b/projects/dia_to_sml/src/hash/context_hash.cpp
index bdd5856..c31ab6d 100644
--- a/projects/dia_to_sml/src/hash/context_hash.cpp
+++ b/projects/dia_to_sml/src/hash/context_hash.cpp
@@ -65,32 +65,6 @@ inline std::size_t hash_std_unordered_map_std_string_dogen_sml_qname(const std::
     return seed;
 }
 
-inline std::size_t hash_std_unordered_map_dogen_sml_qname_dogen_sml_qname(const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& v){
-    std::size_t seed(0);
-    for (const auto i : v) {
-        combine(seed, i.first);
-        combine(seed, i.second);
-    }
-    return seed;
-}
-
-inline std::size_t hash_std_list_dogen_sml_qname(const std::list<dogen::sml::qname>& v){
-    std::size_t seed(0);
-    for (const auto i : v) {
-        combine(seed, i);
-    }
-    return seed;
-}
-
-inline std::size_t hash_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_qname_(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& v){
-    std::size_t seed(0);
-    for (const auto i : v) {
-        combine(seed, i.first);
-        combine(seed, hash_std_list_dogen_sml_qname(i.second));
-    }
-    return seed;
-}
-
 }
 
 namespace dogen {
@@ -103,8 +77,6 @@ std::size_t context_hasher::hash(const context&v) {
     combine(seed, hash_std_unordered_map_std_string_std_list_std_string_(v.child_id_to_parent_ids()));
     combine(seed, hash_std_unordered_set_std_string(v.parent_ids()));
     combine(seed, hash_std_unordered_map_std_string_dogen_sml_qname(v.id_to_qname()));
-    combine(seed, hash_std_unordered_map_dogen_sml_qname_dogen_sml_qname(v.original_parent()));
-    combine(seed, hash_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_qname_(v.leaves()));
     combine(seed, hash_std_unordered_set_std_string(v.top_level_module_names()));
     combine(seed, v.model());
 
diff --git a/projects/dia_to_sml/src/io/context_io.cpp b/projects/dia_to_sml/src/io/context_io.cpp
index 0649867..bac7f23 100644
--- a/projects/dia_to_sml/src/io/context_io.cpp
+++ b/projects/dia_to_sml/src/io/context_io.cpp
@@ -97,56 +97,6 @@ inline std::ostream& operator<<(std::ostream& s, const std::unordered_map<std::s
 
 }
 
-namespace std {
-
-inline std::ostream& operator<<(std::ostream& s, const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& v) {
-    s << "[";
-    for (auto i(v.begin()); i != v.end(); ++i) {
-        if (i != v.begin()) s << ", ";
-        s << "[ { " << "\"__type__\": " << "\"key\"" << ", " << "\"data\": ";
-        s << i->first;
-        s << " }, { " << "\"__type__\": " << "\"value\"" << ", " << "\"data\": ";
-        s << i->second;
-        s << " } ]";
-    }
-    s << " ] ";
-    return s;
-}
-
-}
-
-namespace std {
-
-inline std::ostream& operator<<(std::ostream& s, const std::list<dogen::sml::qname>& v) {
-    s << "[ ";
-    for (auto i(v.begin()); i != v.end(); ++i) {
-        if (i != v.begin()) s << ", ";
-        s << *i;
-    }
-    s << "] ";
-    return s;
-}
-
-}
-
-namespace std {
-
-inline std::ostream& operator<<(std::ostream& s, const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& v) {
-    s << "[";
-    for (auto i(v.begin()); i != v.end(); ++i) {
-        if (i != v.begin()) s << ", ";
-        s << "[ { " << "\"__type__\": " << "\"key\"" << ", " << "\"data\": ";
-        s << i->first;
-        s << " }, { " << "\"__type__\": " << "\"value\"" << ", " << "\"data\": ";
-        s << i->second;
-        s << " } ]";
-    }
-    s << " ] ";
-    return s;
-}
-
-}
-
 namespace dogen {
 namespace dia_to_sml {
 
@@ -163,8 +113,6 @@ std::ostream& operator<<(std::ostream& s, const context& v) {
       << "\"child_id_to_parent_ids\": " << v.child_id_to_parent_ids() << ", "
       << "\"parent_ids\": " << v.parent_ids() << ", "
       << "\"id_to_qname\": " << v.id_to_qname() << ", "
-      << "\"original_parent\": " << v.original_parent() << ", "
-      << "\"leaves\": " << v.leaves() << ", "
       << "\"top_level_module_names\": " << v.top_level_module_names() << ", "
       << "\"model\": " << v.model()
       << " }";
diff --git a/projects/dia_to_sml/src/serialization/context_ser.cpp b/projects/dia_to_sml/src/serialization/context_ser.cpp
index c26f281..063aa04 100644
--- a/projects/dia_to_sml/src/serialization/context_ser.cpp
+++ b/projects/dia_to_sml/src/serialization/context_ser.cpp
@@ -51,8 +51,6 @@ void save(Archive& ar,
     ar << make_nvp("child_id_to_parent_ids", v.child_id_to_parent_ids_);
     ar << make_nvp("parent_ids", v.parent_ids_);
     ar << make_nvp("id_to_qname", v.id_to_qname_);
-    ar << make_nvp("original_parent", v.original_parent_);
-    ar << make_nvp("leaves", v.leaves_);
     ar << make_nvp("top_level_module_names", v.top_level_module_names_);
     ar << make_nvp("model", v.model_);
 }
@@ -65,8 +63,6 @@ void load(Archive& ar,
     ar >> make_nvp("child_id_to_parent_ids", v.child_id_to_parent_ids_);
     ar >> make_nvp("parent_ids", v.parent_ids_);
     ar >> make_nvp("id_to_qname", v.id_to_qname_);
-    ar >> make_nvp("original_parent", v.original_parent_);
-    ar >> make_nvp("leaves", v.leaves_);
     ar >> make_nvp("top_level_module_names", v.top_level_module_names_);
     ar >> make_nvp("model", v.model_);
 }
diff --git a/projects/dia_to_sml/src/test_data/context_td.cpp b/projects/dia_to_sml/src/test_data/context_td.cpp
index 2a8dea7..d8800be 100644
--- a/projects/dia_to_sml/src/test_data/context_td.cpp
+++ b/projects/dia_to_sml/src/test_data/context_td.cpp
@@ -72,30 +72,6 @@ std::unordered_map<std::string, dogen::sml::qname> create_std_unordered_map_std_
     return r;
 }
 
-std::unordered_map<dogen::sml::qname, dogen::sml::qname> create_std_unordered_map_dogen_sml_qname_dogen_sml_qname(unsigned int position) {
-    std::unordered_map<dogen::sml::qname, dogen::sml::qname> r;
-    for (unsigned int i(0); i < 4; ++i) {
-        r.insert(std::make_pair(create_dogen_sml_qname(position + i), create_dogen_sml_qname(position + i)));
-    }
-    return r;
-}
-
-std::list<dogen::sml::qname> create_std_list_dogen_sml_qname(unsigned int position) {
-    std::list<dogen::sml::qname> r;
-    for (unsigned int i(0); i < 4; ++i) {
-        r.push_back(create_dogen_sml_qname(position + i));
-    }
-    return r;
-}
-
-std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> > create_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_qname_(unsigned int position) {
-    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> > r;
-    for (unsigned int i(0); i < 4; ++i) {
-        r.insert(std::make_pair(create_dogen_sml_qname(position + i), create_std_list_dogen_sml_qname(position + i)));
-    }
-    return r;
-}
-
 dogen::sml::model
 create_dogen_sml_model(const unsigned int position) {
     return dogen::sml::model_generator::create(position);
@@ -114,10 +90,8 @@ populate(const unsigned int position, result_type& v) {
     v.child_id_to_parent_ids(create_std_unordered_map_std_string_std_list_std_string_(position + 1));
     v.parent_ids(create_std_unordered_set_std_string(position + 2));
     v.id_to_qname(create_std_unordered_map_std_string_dogen_sml_qname(position + 3));
-    v.original_parent(create_std_unordered_map_dogen_sml_qname_dogen_sml_qname(position + 4));
-    v.leaves(create_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_qname_(position + 5));
-    v.top_level_module_names(create_std_unordered_set_std_string(position + 6));
-    v.model(create_dogen_sml_model(position + 7));
+    v.top_level_module_names(create_std_unordered_set_std_string(position + 4));
+    v.model(create_dogen_sml_model(position + 5));
 }
 
 context_generator::result_type
diff --git a/projects/dia_to_sml/src/types/context.cpp b/projects/dia_to_sml/src/types/context.cpp
index 2b1f488..dcce53f 100644
--- a/projects/dia_to_sml/src/types/context.cpp
+++ b/projects/dia_to_sml/src/types/context.cpp
@@ -31,16 +31,12 @@ context::context(
     const std::unordered_map<std::string, std::list<std::string> >& child_id_to_parent_ids,
     const std::unordered_set<std::string>& parent_ids,
     const std::unordered_map<std::string, dogen::sml::qname>& id_to_qname,
-    const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& original_parent,
-    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& leaves,
     const std::unordered_set<std::string>& top_level_module_names,
     const dogen::sml::model& model)
     : is_target_(is_target),
       child_id_to_parent_ids_(child_id_to_parent_ids),
       parent_ids_(parent_ids),
       id_to_qname_(id_to_qname),
-      original_parent_(original_parent),
-      leaves_(leaves),
       top_level_module_names_(top_level_module_names),
       model_(model) { }
 
@@ -50,8 +46,6 @@ void context::swap(context& other) noexcept {
     swap(child_id_to_parent_ids_, other.child_id_to_parent_ids_);
     swap(parent_ids_, other.parent_ids_);
     swap(id_to_qname_, other.id_to_qname_);
-    swap(original_parent_, other.original_parent_);
-    swap(leaves_, other.leaves_);
     swap(top_level_module_names_, other.top_level_module_names_);
     swap(model_, other.model_);
 }
@@ -61,8 +55,6 @@ bool context::operator==(const context& rhs) const {
         child_id_to_parent_ids_ == rhs.child_id_to_parent_ids_ &&
         parent_ids_ == rhs.parent_ids_ &&
         id_to_qname_ == rhs.id_to_qname_ &&
-        original_parent_ == rhs.original_parent_ &&
-        leaves_ == rhs.leaves_ &&
         top_level_module_names_ == rhs.top_level_module_names_ &&
         model_ == rhs.model_;
 }
@@ -129,38 +121,6 @@ void context::id_to_qname(const std::unordered_map<std::string, dogen::sml::qnam
     id_to_qname_ = std::move(v);
 }
 
-const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& context::original_parent() const {
-    return original_parent_;
-}
-
-std::unordered_map<dogen::sml::qname, dogen::sml::qname>& context::original_parent() {
-    return original_parent_;
-}
-
-void context::original_parent(const std::unordered_map<dogen::sml::qname, dogen::sml::qname>& v) {
-    original_parent_ = v;
-}
-
-void context::original_parent(const std::unordered_map<dogen::sml::qname, dogen::sml::qname>&& v) {
-    original_parent_ = std::move(v);
-}
-
-const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& context::leaves() const {
-    return leaves_;
-}
-
-std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& context::leaves() {
-    return leaves_;
-}
-
-void context::leaves(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >& v) {
-    leaves_ = v;
-}
-
-void context::leaves(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::qname> >&& v) {
-    leaves_ = std::move(v);
-}
-
 const std::unordered_set<std::string>& context::top_level_module_names() const {
     return top_level_module_names_;
 }
diff --git a/projects/dia_to_sml/src/types/transformer.cpp b/projects/dia_to_sml/src/types/transformer.cpp
index 40f3437..2949014 100644
--- a/projects/dia_to_sml/src/types/transformer.cpp
+++ b/projects/dia_to_sml/src/types/transformer.cpp
@@ -55,10 +55,11 @@ const std::string empty;
 const std::string unsigned_int("unsigned int");
 const std::string identity_attribute_key("IDENTITY_ATTRIBUTE");
 const std::string empty_dia_object_name("Dia object name is empty");
-const std::string original_parent_not_found("Object has no original parent: ");
 const std::string parent_not_found("Object has a parent but its not defined: ");
 const std::string empty_parent_container(
     "Object has an entry in child to parent container but its empty: ");
+const std::string parent_relationship_not_found(
+    "Object is a child but there are no parent relationships");
 const std::string missing_module_for_id("Missing module for dia object ID: ");
 const std::string missing_module_for_qname("Missing module for qname: ");
 const std::string missing_qname_for_id("Missing QName for dia object ID: ");
@@ -70,8 +71,6 @@ const std::string object_has_invalid_type("Invalid dia type: ");
 const std::string invalid_stereotype_in_graph("Invalid stereotype: ");
 const std::string immutabilty_with_inheritance(
     "Immutability not supported with inheritance: ");
-const std::string multiple_inheritance(
-    "Child has more than one parent, but multiple inheritance not supported:");
 
 }
 
@@ -214,6 +213,37 @@ sml::enumerator transformer::to_enumerator(const processed_property& p,
     return r;
 }
 
+std::list<sml::qname>
+transformer::parent_qnames_for_id(const std::string& id) const {
+    std::list<sml::qname> r;
+
+    const auto i(context_.child_id_to_parent_ids().find(id));
+    if (i == context_.child_id_to_parent_ids().end()) {
+        BOOST_LOG_SEV(lg, debug) << "ID has no parent: " << id;
+        return r;
+    }
+
+    if (i->second.empty()) {
+        BOOST_LOG_SEV(lg, error) << empty_parent_container << id;
+        BOOST_THROW_EXCEPTION(transformation_error(
+                empty_parent_container + id));
+    }
+
+    for (const auto& parent_id : i->second) {
+        const auto j(context_.id_to_qname().find(parent_id));
+        if (j == context_.id_to_qname().end()) {
+            BOOST_LOG_SEV(lg, error) << "Object has a parent but there is"
+                                     << " no QName mapping defined."
+                                     << " Child ID: '" << id
+                                     << "' Parent ID: '" << parent_id << "'";
+
+            BOOST_THROW_EXCEPTION(transformation_error(parent_not_found + id));
+        }
+        r.push_back(j->second);
+    }
+    return r;
+}
+
 void transformer::update_abstract_object(sml::abstract_object& ao,
     const processed_object& o, const profile& p) {
 
@@ -222,50 +252,27 @@ void transformer::update_abstract_object(sml::abstract_object& ao,
     ao.is_fluent(p.is_fluent());
     ao.is_versioned(p.is_versioned());
     ao.is_visitable(p.is_visitable());
+    ao.is_immutable(p.is_immutable());
 
     for (const auto us : p.unknown_stereotypes()) {
         const auto qn(to_qname(us));
-        ao.modeled_concepts().push_back(qn);
+        using sml::relationship_types;
+        ao.relationships()[relationship_types::modeled_concepts].push_back(qn);
     }
 
-    for (const auto& p : o.properties()) {
-        const auto property(to_property(p));
-        ao.properties().push_back(property);
-        update_model_references(property.type());
-    }
-
-    const auto i(context_.child_id_to_parent_ids().find(o.id()));
-    if (i != context_.child_id_to_parent_ids().end()) {
-        if (i->second.empty()) {
-            BOOST_LOG_SEV(lg, error) << empty_parent_container << o.id();
-            BOOST_THROW_EXCEPTION(
-                transformation_error(empty_parent_container + o.id()));
-        }
+    update_properties(ao, o);
 
-        if (i->second.size() > 1) {
-            BOOST_LOG_SEV(lg, error) << multiple_inheritance << o.id();
-            BOOST_THROW_EXCEPTION(
-                transformation_error(multiple_inheritance + o.id()));
-        }
+    const auto parent_qnames(parent_qnames_for_id(o.id()));
+    ao.is_child(!parent_qnames.empty());
+    if (ao.is_child()) {
+        BOOST_LOG_SEV(lg, debug) << "Setting parents for: "
+                                 << ao.name().simple_name()
+                                 << ". Total parents: " << parent_qnames.size();
 
-        const auto parent_name(i->second.front());
-        const auto j(context_.id_to_qname().find(parent_name));
-        if (j == context_.id_to_qname().end()) {
-            BOOST_LOG_SEV(lg, error) << "Object has a parent but "
-                                     << " there is no QName mapping defined."
-                                     << " Child ID: '" << o.id()
-                                     << "' Parent ID: '" << parent_name << "'";
-
-            BOOST_THROW_EXCEPTION(
-                transformation_error(parent_not_found + o.id()));
-        }
-
-        BOOST_LOG_SEV(lg, debug) << "Setting parent for: "
-                                 << ao.name().simple_name() << " as "
-                                 << j->second.simple_name();
-        ao.parent_name(j->second);
+        using sml::relationship_types;
+        ao.relationships()[relationship_types::parents] = parent_qnames;
     } else {
-        BOOST_LOG_SEV(lg, debug) << "Object has no parent: "
+        BOOST_LOG_SEV(lg, debug) << "Object has no parents: "
                                  << ao.name().simple_name();
     }
 
@@ -273,50 +280,8 @@ void transformer::update_abstract_object(sml::abstract_object& ao,
     ao.is_parent(j != context_.parent_ids().end());
     context_.id_to_qname().insert(std::make_pair(o.id(), ao.name()));
 
-    if (!ao.parent_name()) {
-        context_.original_parent().insert(
-            std::make_pair(ao.name(), ao.name()));
-    } else {
-        const auto k(context_.original_parent().find(*ao.parent_name()));
-        if (k == context_.original_parent().end()) {
-            BOOST_LOG_SEV(lg, error) << "Could not find the original parent of "
-                                     << ao.name().simple_name();
-
-            BOOST_THROW_EXCEPTION(
-                transformation_error(original_parent_not_found +
-                    ao.name().simple_name()));
-        }
-        ao.original_parent_name(k->second);
-        context_.original_parent().insert(
-            std::make_pair(ao.name(), k->second));
-    }
-
-    using sml::generation_types;
-    // FIXME: massive hack
-    const bool is_service(dynamic_cast<sml::service*>(&ao) != 0);
-    if (!ao.is_parent() && ao.parent_name() && !is_service) {
-        auto parent(ao.parent_name());
-        while (parent) {
-            auto k(context_.leaves().find(*parent));
-            if (k == context_.leaves().end()) {
-                const std::list<sml::qname> l { ao.name() };
-                context_.leaves().insert(std::make_pair(*parent, l));
-            } else
-                k->second.push_back(ao.name());
-
-            auto j(context_.model().objects().find(*parent));
-            if (j == context_.model().objects().end()) {
-                BOOST_LOG_SEV(lg, error) << "Could not find the parent of "
-                                         << parent->simple_name();
-                BOOST_THROW_EXCEPTION(transformation_error(parent_not_found +
-                        parent->simple_name()));
-            }
-            parent = j->second->parent_name();
-        }
-    }
-
-    ao.is_immutable(p.is_immutable());
-    if ((ao.is_parent() || ao.parent_name()) && p.is_immutable())  {
+    // FIXME: move to validator
+    if ((ao.is_parent() || ao.is_child()) && p.is_immutable())  {
         BOOST_LOG_SEV(lg, error) << immutabilty_with_inheritance
                                  << ao.name().simple_name();
 
@@ -331,7 +296,7 @@ void transformer::update_abstract_entity(sml::abstract_entity& ae,
     update_abstract_object(ae, o, p);
     ae.is_aggregate_root(p.is_aggregate_root());
 
-    for (const auto& p : ae.properties()) {
+    for (const auto& p : ae.local_properties()) {
         sml::meta_data_reader reader(p.meta_data());
         if (reader.has_key(sml::tags::identity_attribute))
             ae.identity().push_back(p);
@@ -485,36 +450,19 @@ void transformer::from_note(const processed_object& o) {
 void transformer::to_concept(const processed_object& o, const profile& p) {
     sml::concept c;
     update_element(c, o, p);
+    update_properties(c, o);
 
-    for (const auto& prop : o.properties()) {
-        auto property(to_property(prop));
-        property.type(to_nested_qname(prop.type()));
-        update_model_references(property.type());
-        c.properties().push_back(property);
-    }
+    const auto parent_qnames(parent_qnames_for_id(o.id()));
+    if (!parent_qnames.empty()) {
+        BOOST_LOG_SEV(lg, debug) << "Setting parents for: "
+                                 << c.name().simple_name()
+                                 << ". Total parents: " << parent_qnames.size();
 
-    const auto i(context_.child_id_to_parent_ids().find(o.id()));
-    if (i != context_.child_id_to_parent_ids().end()) {
-        if (i->second.empty()) {
-            BOOST_LOG_SEV(lg, error) << empty_parent_container << o.id();
-            BOOST_THROW_EXCEPTION(
-                transformation_error(empty_parent_container + o.id()));
-        }
-
-        for (const auto& concept_id : i->second) {
-            const auto j(context_.id_to_qname().find(concept_id));
-            if (j == context_.id_to_qname().end()) {
-                BOOST_LOG_SEV(lg, error) << "Object has a parent but "
-                                         << " there is no QName mapping."
-                                         << " Child ID: '" << o.id()
-                                         << "' Parent ID: '" << concept_id
-                                         << "'";
-
-                BOOST_THROW_EXCEPTION(
-                    transformation_error(parent_not_found + o.id()));
-            }
-            c.refines().push_back(j->second);
-        }
+        using sml::relationship_types;
+        c.refines(parent_qnames);
+    } else {
+        BOOST_LOG_SEV(lg, debug) << "Object has no parents: "
+                                 << c.name().simple_name();
     }
     context_.model().concepts().insert(std::make_pair(c.name(), c));
 }
diff --git a/projects/dia_to_sml/src/types/workflow.cpp b/projects/dia_to_sml/src/types/workflow.cpp
index 5a53aa7..a23d229 100644
--- a/projects/dia_to_sml/src/types/workflow.cpp
+++ b/projects/dia_to_sml/src/types/workflow.cpp
@@ -98,29 +98,12 @@ void workflow::graph_to_context_activity(const graph_type& g) {
     boost::depth_first_search(g, boost::visitor(v));
 }
 
-void workflow::post_process_model_activity() {
-    for (auto& pair : context_.model().objects()) {
-        auto i(context_.leaves().find(pair.first));
-        if (i == context_.leaves().end())
-            continue;
-
-        // for every base (abstract) type which has concrete
-        // implementations (leafs), find them and add them to the type
-        // itself; then add each leaf type to the model's leaf
-        // container.
-        pair.second->leaves(i->second);
-        for (const auto& j : i->second)
-            context_.model().leaves().insert(j);
-    }
-}
-
 sml::model workflow::execute(const dia::diagram& diagram,
     const std::string& model_name, const std::string& external_module_path,
     bool is_target) {
 
     initialise_context_activity(model_name, external_module_path, is_target);
     graph_to_context_activity(build_graph_activity(diagram));
-    post_process_model_activity();
 
     BOOST_LOG_SEV(lg, debug) << "Final model: " << context_.model();
     return context_.model();
diff --git a/projects/om/include/dogen/om/types/concept_formatter_interface.hpp b/projects/om/include/dogen/om/types/concept_formatter_interface.hpp
index 13a6a87..f888bfc 100644
--- a/projects/om/include/dogen/om/types/concept_formatter_interface.hpp
+++ b/projects/om/include/dogen/om/types/concept_formatter_interface.hpp
@@ -26,7 +26,6 @@
 #endif
 
 #include "dogen/sml/types/concept.hpp"
-#include "dogen/sml/types/property_cache_interface.hpp"
 #include "dogen/om/types/file.hpp"
 #include "dogen/om/types/annotation.hpp"
 #include "dogen/om/types/file_formatter_interface.hpp"
@@ -52,8 +51,7 @@ public:
      * @brief Format the concept according to some grammar into the
      * stream.
      */
-    virtual file format(const sml::concept& c, const annotation& a,
-        const sml::property_cache_interface& pc) const = 0;
+    virtual file format(const sml::concept& c, const annotation& a) const = 0;
 };
 
 } }
diff --git a/projects/om/include/dogen/om/types/cpp_types_main_header_file_formatter.hpp b/projects/om/include/dogen/om/types/cpp_types_main_header_file_formatter.hpp
index ebadaec..2c91c80 100644
--- a/projects/om/include/dogen/om/types/cpp_types_main_header_file_formatter.hpp
+++ b/projects/om/include/dogen/om/types/cpp_types_main_header_file_formatter.hpp
@@ -30,7 +30,6 @@
 #include <ostream>
 #include "dogen/sml/types/qname.hpp"
 #include "dogen/sml/types/type_visitor.hpp"
-#include "dogen/sml/types/property_cache_interface.hpp"
 #include "dogen/om/types/comment_formatter.hpp"
 #include "dogen/om/types/type_formatter_interface.hpp"
 #include "dogen/om/types/module_formatter_interface.hpp"
@@ -159,8 +158,7 @@ public:
 
     file format(const sml::module& module, const annotation& a) const override;
 
-    file format(const sml::type& t, const annotation& a,
-        const sml::property_cache_interface& c) const override;
+    file format(const sml::type& t, const annotation& a) const override;
 
 private:
     mutable std::shared_ptr<context> context_;
diff --git a/projects/om/include/dogen/om/types/type_formatter_interface.hpp b/projects/om/include/dogen/om/types/type_formatter_interface.hpp
index 4e76679..af90315 100644
--- a/projects/om/include/dogen/om/types/type_formatter_interface.hpp
+++ b/projects/om/include/dogen/om/types/type_formatter_interface.hpp
@@ -26,7 +26,6 @@
 #endif
 
 #include "dogen/sml/types/type.hpp"
-#include "dogen/sml/types/property_cache_interface.hpp"
 #include "dogen/om/types/file.hpp"
 #include "dogen/om/types/annotation.hpp"
 #include "dogen/om/types/file_formatter_interface.hpp"
@@ -52,8 +51,7 @@ public:
      * @brief Format the type according to some grammar into the
      * stream.
      */
-    virtual file format(const sml::type& t, const annotation& a,
-        const sml::property_cache_interface& pc) const = 0;
+    virtual file format(const sml::type& t, const annotation& a) const = 0;
 };
 
 } }
diff --git a/projects/om/include/dogen/om/types/workflow.hpp b/projects/om/include/dogen/om/types/workflow.hpp
index 080b166..47cf378 100644
--- a/projects/om/include/dogen/om/types/workflow.hpp
+++ b/projects/om/include/dogen/om/types/workflow.hpp
@@ -34,7 +34,6 @@
 #include "dogen/sml/types/tags.hpp"
 #include "dogen/sml/types/model.hpp"
 #include "dogen/sml/types/meta_data_reader.hpp"
-#include "dogen/sml/types/property_cache.hpp"
 #include "dogen/om/types/file.hpp"
 #include "dogen/om/types/licence.hpp"
 #include "dogen/om/types/modeline_group.hpp"
diff --git a/projects/om/spec/cpp_types_main_header_file_formatter_spec.cpp b/projects/om/spec/cpp_types_main_header_file_formatter_spec.cpp
index ad2ad3f..4a0b733 100644
--- a/projects/om/spec/cpp_types_main_header_file_formatter_spec.cpp
+++ b/projects/om/spec/cpp_types_main_header_file_formatter_spec.cpp
@@ -30,7 +30,6 @@
 #include "dogen/sml/types/tags.hpp"
 #include "dogen/sml/types/meta_data_writer.hpp"
 #include "dogen/sml/test/mock_model_factory.hpp"
-#include "dogen/sml/types/property_cache_interface.hpp"
 #include "dogen/sml/io/model_io.hpp"
 #include "dogen/sml/io/module_io.hpp"
 #include "dogen/sml/io/abstract_object_io.hpp"
@@ -163,36 +162,11 @@ namespace some_module_0 {
 )");
 
 /*
-  FIXME: remvoed for now
+  FIXME: removed for now
   public:
   some_type_0(some_type_0&&);
  */
 
-class mock_property_cache : public dogen::sml::property_cache_interface {
-public:
-    mock_property_cache() = default;
-    mock_property_cache(const mock_property_cache&) = default;
-    mock_property_cache(mock_property_cache&&) = default;
-    mock_property_cache& operator=(const mock_property_cache&) = default;
-
-public:
-    std::list<dogen::sml::property>
-    get_all_properties(const dogen::sml::abstract_object&) const override {
-        return std::list<dogen::sml::property> {};
-    }
-
-    std::list<dogen::sml::property>
-    get_local_properties(const dogen::sml::abstract_object&) const override {
-        return std::list<dogen::sml::property> {};
-    }
-
-    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >
-    get_inehrited_properties(const dogen::sml::abstract_object&) const override {
-        return std::unordered_map<dogen::sml::qname,
-                                  std::list<dogen::sml::property> > {};
-    }
-};
-
 const std::string element_not_found("element not found: ");
 
 const dogen::sml::abstract_object&
@@ -240,11 +214,10 @@ BOOST_AUTO_TEST_CASE(enumeration_with_two_enumerators_produces_expected_types_he
     BOOST_REQUIRE(m.enumerations().size() == 1);
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
     const auto e(m.enumerations().begin()->second);
     BOOST_LOG_SEV(lg, debug) << "enumeration: " << e;
 
-    const auto r(f.format(e, empty_annotation, c));
+    const auto r(f.format(e, empty_annotation));
     BOOST_CHECK(r.contents() == enumeration_two_enumerators);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>"
                              << enumeration_two_enumerators
@@ -260,11 +233,10 @@ BOOST_AUTO_TEST_CASE(object_with_no_properties_produces_expected_types_header) {
     BOOST_REQUIRE(m.objects().size() == 1);
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
     const auto& o(find_object(m, 0));
     BOOST_LOG_SEV(lg, debug) << "object: " << o;
 
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == object_no_properties);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>" << object_no_properties
                              << "<end>";
@@ -282,8 +254,7 @@ BOOST_AUTO_TEST_CASE(parent_object_produces_expected_types_header) {
     BOOST_LOG_SEV(lg, debug) << "object: " << o;
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == parent_object);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>" << parent_object << "<end>";
     BOOST_LOG_SEV(lg, debug) << "actual: <start>" << r << "<end>";
@@ -300,8 +271,7 @@ BOOST_AUTO_TEST_CASE(leaf_child_object_produces_expected_types_header) {
     BOOST_LOG_SEV(lg, debug) << "object: " << o;
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == leaf_child_object);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>" << leaf_child_object
                              << "<end>";
@@ -320,9 +290,7 @@ BOOST_AUTO_TEST_CASE(non_leaf_child_object_produces_expected_types_header) {
     BOOST_LOG_SEV(lg, debug) << "object: " << o;
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
-
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == non_leaf_child_object);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>" << non_leaf_child_object
                              << "<end>";
@@ -343,8 +311,7 @@ BOOST_AUTO_TEST_CASE(generating_explicitly_defaulted_functions_produces_expected
     BOOST_LOG_SEV(lg, debug) << "model: " << m;
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == all_explicitly_defaulted_functions);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>"
                              << all_explicitly_defaulted_functions << "<end>";
@@ -369,9 +336,7 @@ BOOST_AUTO_TEST_CASE(generating_manual_default_constructor_produces_expected_typ
     BOOST_LOG_SEV(lg, debug) << "model: " << m;
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
-
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == manual_default_constructor);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>"
                              << manual_default_constructor << "<end>";
@@ -396,9 +361,7 @@ BOOST_AUTO_TEST_CASE(generating_manual_move_constructor_produces_expected_types_
     BOOST_LOG_SEV(lg, debug) << "model: " << m;
 
     dogen::om::cpp_types_main_header_file_formatter f;
-    mock_property_cache c;
-
-    const auto r(f.format(o, empty_annotation, c));
+    const auto r(f.format(o, empty_annotation));
     BOOST_CHECK(r.contents() == manual_move_constructor);
     BOOST_LOG_SEV(lg, debug) << "expected: <start>"
                              << manual_move_constructor << "<end>";
diff --git a/projects/om/src/types/cpp_types_main_header_file_formatter.cpp b/projects/om/src/types/cpp_types_main_header_file_formatter.cpp
index 81e53cc..83e61ec 100644
--- a/projects/om/src/types/cpp_types_main_header_file_formatter.cpp
+++ b/projects/om/src/types/cpp_types_main_header_file_formatter.cpp
@@ -47,6 +47,9 @@ auto lg(logger_factory("om.cpp_types_main_header_file_formatter"));
 
 const std::string empty;
 const std::string missing_context_ptr("Context pointer is null");
+const std::string parent_not_found("Type is a child but parent not found");
+const std::string multiple_inheritance_found(
+    "Multiple inheritance is not supported");
 const bool start_on_first_line(true);
 const bool use_documentation_tool_markup(true);
 const bool last_line_is_blank(true);
@@ -75,9 +78,8 @@ public:
     ~context() noexcept = default;
 
 public:
-    context(std::ostream& s, const sml::property_cache_interface& pc,
-        cpp_formatters::indenter& ind, cpp_formatters::utility& u)
-        : stream_(s), property_cache_(pc), indenter_(ind), utility_(u),
+    context(std::ostream& s, cpp_formatters::indenter& ind,
+        cpp_formatters::utility& u) : stream_(s), indenter_(ind), utility_(u),
           first_line_is_blank_(false), overwrite_(false) { }
 
 public:
@@ -87,13 +89,6 @@ public:
     std::ostream& stream() { return stream_; }
 
     /**
-     * @brief Cache that provides access to properties in SML objects.
-     */
-    const sml::property_cache_interface& property_cache() const {
-        return property_cache_;
-    }
-
-    /**
      * @brief Indentation facilities.
      */
     cpp_formatters::indenter& indenter() { return indenter_; }
@@ -121,7 +116,6 @@ public:
 
 private:
     std::ostream& stream_;
-    const sml::property_cache_interface& property_cache_;
     cpp_formatters::indenter& indenter_;
     cpp_formatters::utility& utility_;
     bool first_line_is_blank_;
@@ -231,11 +225,22 @@ open_class(const sml::abstract_object& o) const {
     if (!o.is_parent())
         context_->stream() << " final";
 
-    if (o.parent_name()) {
-        context_->stream() << " :";
+    if (o.is_child()) {
+        const auto i(o.relationships().find(sml::relationship_types::parents));
+        if (i == o.relationships().end() || i->second.empty()) {
+            BOOST_LOG_SEV(lg, error) << parent_not_found;
+            BOOST_THROW_EXCEPTION(formatting_error(parent_not_found));
+        }
+
+        if (i->second.size() > 1) {
+            BOOST_LOG_SEV(lg, error) << multiple_inheritance_found;
+            BOOST_THROW_EXCEPTION(formatting_error(multiple_inheritance_found));
+        }
 
+        const std::string parent_simple_name(i->second.front().simple_name());
+        context_->stream() << " :";
         context_->stream() << " public ";
-        context_->stream() << o.parent_name()->simple_name();
+        context_->stream() << parent_simple_name;
     }
     context_->stream() << " {" << std::endl;
     context_->first_line_is_blank(false);
@@ -271,7 +276,7 @@ explicitly_defaulted_functions(const sml::abstract_object& o) const {
                           << "&&) = default;" << std::endl;
     }
 
-    if (!o.is_parent() && !o.parent_name()) {
+    if (!o.is_parent() && !o.is_child()) {
         context_->stream() << context_->indenter() << "~" << sn
                           << "() = default;" << std::endl;
     }
@@ -281,7 +286,7 @@ explicitly_defaulted_functions(const sml::abstract_object& o) const {
                           << "& operator=(const " << sn << "&) = delete;"
                           << std::endl;
     } else {
-        const auto p(context_->property_cache().get_all_properties(o));
+        const auto p(o.all_properties());
         if (p.empty()) {
             context_->stream() << context_->indenter() << sn
                               << "& operator=(const " << sn
@@ -317,7 +322,7 @@ complete_constructor(const sml::abstract_object& o) const {
             return;
     }
 
-    const auto& props(context_->property_cache().get_all_properties(o));
+    const auto& props(o.all_properties());
     if (props.empty())
         return;
 
@@ -372,7 +377,7 @@ move_constructor(const sml::abstract_object& o) const {
     if (reader.is_false(types::generate_explicit_move_constructor))
         return;
 
-    const auto& props(context_->property_cache().get_all_properties(o));
+    const auto& props(o.all_properties());
     if (props.empty())
         return;
 
@@ -409,7 +414,7 @@ destructor(const sml::abstract_object& o) const {
          */
         context_->stream() << context_->indenter() << "virtual ~" << sn
                           << "() noexcept = 0;" << std::endl;
-    } else if (o.parent_name()) {
+    } else if (o.is_parent()) {
         context_->stream() << context_->indenter() << "virtual ~" << sn
                           << "() noexcept { }" << std::endl;
     }
@@ -534,7 +539,7 @@ void cpp_types_main_header_file_formatter::compound_type_getter_and_setter(
 
 void cpp_types_main_header_file_formatter::
 getters_and_setters(const sml::abstract_object& o) const {
-    if (o.properties().empty())
+    if (o.local_properties().empty())
         return;
 
     if (context_->first_line_is_blank())
@@ -542,7 +547,7 @@ getters_and_setters(const sml::abstract_object& o) const {
 
     context_->utility().public_access_specifier();
     bool is_first(true);
-    for (const auto p : o.properties()) {
+    for (const auto p : o.local_properties()) {
         if (!is_first)
             context_->utility().blank_line();
 
@@ -558,14 +563,14 @@ getters_and_setters(const sml::abstract_object& o) const {
 
 void cpp_types_main_header_file_formatter::
 member_variables(const sml::abstract_object& o) const {
-    if (o.properties().empty())
+    if (o.local_properties().empty())
         return;
 
     if (context_->first_line_is_blank())
         context_->utility().blank_line();
 
     context_->utility().public_access_specifier();
-    for (const auto p : o.properties()) {
+    for (const auto p : o.local_properties()) {
         sml::meta_data_reader reader(p.meta_data());
         context_->stream() << context_->indenter()
                           << reader.get(sml::tags::cpp::types::complete_name)
@@ -608,13 +613,13 @@ equality(const sml::abstract_object& o) const {
         context_->utility().close_scope();
     }
 
-    if (!o.is_parent() && !o.parent_name())
+    if (!o.is_parent() && !o.is_child())
         return;
 
     context_->utility().blank_line();
     context_->utility().public_access_specifier();
     using types = sml::tags::cpp::types;
-    if (o.is_parent() && !o.parent_name()) {
+    if (o.is_parent() && !o.is_child()) {
         context_->stream() << context_->indenter()
                           << "virtual bool equals(const " << sn
                           <<  "& other) const = 0;"
@@ -665,7 +670,7 @@ swap(const sml::abstract_object& o) const {
     if (reader.is_false(sml::tags::cpp::types::generate_swap))
         return;
 
-    const auto props(context_->property_cache().get_all_properties(o));
+    const auto props(o.all_properties());
     if ((props.empty() && !o.is_parent()) || o.is_immutable())
         return;
 
@@ -688,7 +693,7 @@ swap(const sml::abstract_object& o) const {
 void cpp_types_main_header_file_formatter::
 assignment(const sml::abstract_object& o) const {
     // assignment is only available in leaf classes - MEC++-33
-    const auto props(context_->property_cache().get_all_properties(o));
+    const auto props(o.all_properties());
     if (props.empty() || o.is_parent() || o.is_immutable())
         return;
 
@@ -893,13 +898,12 @@ format(const sml::module& module, const annotation& a) const {
 }
 
 file cpp_types_main_header_file_formatter::
-format(const sml::type& t, const annotation& a,
-    const sml::property_cache_interface& c) const {
+format(const sml::type& t, const annotation& a) const {
 
     std::ostringstream s;
     cpp_formatters::indenter ind;
     cpp_formatters::utility u(s, ind);
-    context_ = std::shared_ptr<context>(new context(s, c, ind, u));
+    context_ = std::shared_ptr<context>(new context(s, ind, u));
 
     const cpp_includes i = cpp_includes();
     sml::meta_data_reader reader(t.meta_data());
diff --git a/projects/om/src/types/workflow.cpp b/projects/om/src/types/workflow.cpp
index 5cd8be8..f451891 100644
--- a/projects/om/src/types/workflow.cpp
+++ b/projects/om/src/types/workflow.cpp
@@ -55,8 +55,6 @@ namespace om {
 
 class workflow::context {
 public:
-    sml::property_cache& property_cache() { return property_cache_; }
-
     const std::unordered_map<std::string, modeline_group>&
     modeline_groups() { return modeline_groups_; }
 
@@ -82,7 +80,6 @@ public:
     std::list<file>& files() { return files_; }
 
 private:
-    sml::property_cache property_cache_;
     std::unordered_map<std::string, modeline_group> modeline_groups_;
     std::unordered_map<std::string, licence> licences_;
     std::string code_generation_marker_;
@@ -209,7 +206,6 @@ void workflow::setup_reference_data_subworkflow(const sml::model& m) {
     hydrate_modelines_activity();
     hydrate_licences_activity();
     create_marker_activity(m);
-    context_->property_cache().populate(m);
 }
 
 void workflow::operator()(const sml::type& t) const {
@@ -219,7 +215,6 @@ void workflow::operator()(const sml::type& t) const {
     const auto modeline(extract_modeline(md));
     const auto marker(extract_marker(md));
     const annotation a(modeline, licence, marker);
-    const auto& pc(context_->property_cache());
 
     sml::meta_data_reader reader(md);
     for (const auto f : type_formatters_) {
@@ -228,7 +223,7 @@ void workflow::operator()(const sml::type& t) const {
         if (status == sml::tags::status_unsupported)
             continue;
 
-        auto file(f->format(t, a, pc));
+        auto file(f->format(t, a));
         file.overwrite(status == sml::tags::status_handcrafted);
         context_->files().push_back(file);
     }
@@ -262,7 +257,6 @@ void workflow::operator()(const sml::concept& c) const {
     const auto modeline(extract_modeline(md));
     const auto marker(extract_marker(md));
     const annotation a(modeline, licence, marker);
-    const auto& pc(context_->property_cache());
 
     sml::meta_data_reader reader(md);
     for (const auto f : concept_formatters_) {
@@ -271,7 +265,7 @@ void workflow::operator()(const sml::concept& c) const {
         if (status == sml::tags::status_unsupported)
             continue;
 
-        auto file(f->format(c, a, pc));
+        auto file(f->format(c, a));
         file.overwrite(status == sml::tags::status_handcrafted);
         context_->files().push_back(file);
     }
diff --git a/projects/sml/include/dogen/sml/hash/all_hash.hpp b/projects/sml/include/dogen/sml/hash/all_hash.hpp
index edfe07e..d95f5e4 100644
--- a/projects/sml/include/dogen/sml/hash/all_hash.hpp
+++ b/projects/sml/include/dogen/sml/hash/all_hash.hpp
@@ -36,6 +36,7 @@
 #include "dogen/sml/hash/primitive_hash.hpp"
 #include "dogen/sml/hash/property_hash.hpp"
 #include "dogen/sml/hash/qname_hash.hpp"
+#include "dogen/sml/hash/relationship_types_hash.hpp"
 #include "dogen/sml/hash/repository_hash.hpp"
 #include "dogen/sml/hash/service_hash.hpp"
 #include "dogen/sml/hash/service_types_hash.hpp"
diff --git a/projects/sml/include/dogen/sml/hash/relationship_types_hash.hpp b/projects/sml/include/dogen/sml/hash/relationship_types_hash.hpp
new file mode 100644
index 0000000..ce7ac48
--- /dev/null
+++ b/projects/sml/include/dogen/sml/hash/relationship_types_hash.hpp
@@ -0,0 +1,43 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_HASH_RELATIONSHIP_TYPES_HASH_HPP
+#define DOGEN_SML_HASH_RELATIONSHIP_TYPES_HASH_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include <functional>
+#include "dogen/sml/types/relationship_types.hpp"
+
+namespace std {
+
+template<>
+struct hash<dogen::sml::relationship_types> {
+public:
+    size_t operator()(const dogen::sml::relationship_types& v) const {
+        return std::hash<unsigned int>()(static_cast<unsigned int>(v));
+    }
+};
+
+}
+
+#endif
diff --git a/projects/sml/include/dogen/sml/io/all_io.hpp b/projects/sml/include/dogen/sml/io/all_io.hpp
index 1b13bbb..21ec32f 100644
--- a/projects/sml/include/dogen/sml/io/all_io.hpp
+++ b/projects/sml/include/dogen/sml/io/all_io.hpp
@@ -36,6 +36,7 @@
 #include "dogen/sml/io/primitive_io.hpp"
 #include "dogen/sml/io/property_io.hpp"
 #include "dogen/sml/io/qname_io.hpp"
+#include "dogen/sml/io/relationship_types_io.hpp"
 #include "dogen/sml/io/repository_io.hpp"
 #include "dogen/sml/io/service_io.hpp"
 #include "dogen/sml/io/service_types_io.hpp"
diff --git a/projects/sml/include/dogen/sml/io/relationship_types_io.hpp b/projects/sml/include/dogen/sml/io/relationship_types_io.hpp
new file mode 100644
index 0000000..fb66ed3
--- /dev/null
+++ b/projects/sml/include/dogen/sml/io/relationship_types_io.hpp
@@ -0,0 +1,38 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_IO_RELATIONSHIP_TYPES_IO_HPP
+#define DOGEN_SML_IO_RELATIONSHIP_TYPES_IO_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include <iosfwd>
+#include "dogen/sml/types/relationship_types.hpp"
+
+namespace dogen {
+namespace sml {
+
+std::ostream& operator<<(std::ostream& s, const relationship_types& v);
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/serialization/all_ser.hpp b/projects/sml/include/dogen/sml/serialization/all_ser.hpp
index 8569b2c..bd75559 100644
--- a/projects/sml/include/dogen/sml/serialization/all_ser.hpp
+++ b/projects/sml/include/dogen/sml/serialization/all_ser.hpp
@@ -37,6 +37,7 @@
 #include "dogen/sml/serialization/property_ser.hpp"
 #include "dogen/sml/serialization/qname_ser.hpp"
 #include "dogen/sml/serialization/registrar_ser.hpp"
+#include "dogen/sml/serialization/relationship_types_ser.hpp"
 #include "dogen/sml/serialization/repository_ser.hpp"
 #include "dogen/sml/serialization/service_ser.hpp"
 #include "dogen/sml/serialization/service_types_ser.hpp"
diff --git a/projects/sml/include/dogen/sml/serialization/relationship_types_ser.hpp b/projects/sml/include/dogen/sml/serialization/relationship_types_ser.hpp
new file mode 100644
index 0000000..db7e0fb
--- /dev/null
+++ b/projects/sml/include/dogen/sml/serialization/relationship_types_ser.hpp
@@ -0,0 +1,37 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_SERIALIZATION_RELATIONSHIP_TYPES_SER_HPP
+#define DOGEN_SML_SERIALIZATION_RELATIONSHIP_TYPES_SER_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include <boost/serialization/nvp.hpp>
+#include "dogen/sml/types/relationship_types.hpp"
+
+template<class Archive>
+void serialize(Archive& ar, dogen::sml::relationship_types& v, unsigned int /*version*/){
+    using boost::serialization::make_nvp;
+    ar & make_nvp("relationship_types", v);
+}
+
+#endif
diff --git a/projects/sml/include/dogen/sml/test_data/all_td.hpp b/projects/sml/include/dogen/sml/test_data/all_td.hpp
index 08ad3ff..73743bc 100644
--- a/projects/sml/include/dogen/sml/test_data/all_td.hpp
+++ b/projects/sml/include/dogen/sml/test_data/all_td.hpp
@@ -36,6 +36,7 @@
 #include "dogen/sml/test_data/primitive_td.hpp"
 #include "dogen/sml/test_data/property_td.hpp"
 #include "dogen/sml/test_data/qname_td.hpp"
+#include "dogen/sml/test_data/relationship_types_td.hpp"
 #include "dogen/sml/test_data/repository_td.hpp"
 #include "dogen/sml/test_data/service_td.hpp"
 #include "dogen/sml/test_data/service_types_td.hpp"
diff --git a/projects/sml/include/dogen/sml/test_data/relationship_types_td.hpp b/projects/sml/include/dogen/sml/test_data/relationship_types_td.hpp
new file mode 100644
index 0000000..f3033f0
--- /dev/null
+++ b/projects/sml/include/dogen/sml/test_data/relationship_types_td.hpp
@@ -0,0 +1,51 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TEST_DATA_RELATIONSHIP_TYPES_TD_HPP
+#define DOGEN_SML_TEST_DATA_RELATIONSHIP_TYPES_TD_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include "dogen/sml/types/relationship_types.hpp"
+
+namespace dogen {
+namespace sml {
+
+class relationship_types_generator {
+public:
+    relationship_types_generator();
+
+public:
+    typedef dogen::sml::relationship_types result_type;
+
+public:
+    static void populate(const unsigned int position, result_type& v);
+    static result_type create(const unsigned int position);
+    result_type operator()();
+
+private:
+    unsigned int position_;
+};
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/abstract_entity.hpp b/projects/sml/include/dogen/sml/types/abstract_entity.hpp
index 56112a7..7807390 100644
--- a/projects/sml/include/dogen/sml/types/abstract_entity.hpp
+++ b/projects/sml/include/dogen/sml/types/abstract_entity.hpp
@@ -77,19 +77,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
         const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts,
         const bool is_aggregate_root,
         const std::list<dogen::sml::property>& identity);
 
diff --git a/projects/sml/include/dogen/sml/types/abstract_object.hpp b/projects/sml/include/dogen/sml/types/abstract_object.hpp
index 31207cf..14c0af0 100644
--- a/projects/sml/include/dogen/sml/types/abstract_object.hpp
+++ b/projects/sml/include/dogen/sml/types/abstract_object.hpp
@@ -26,17 +26,20 @@
 #endif
 
 #include <algorithm>
-#include <boost/optional.hpp>
 #include <boost/property_tree/ptree.hpp>
 #include <iosfwd>
 #include <list>
 #include <string>
+#include <unordered_map>
+#include "dogen/sml/hash/qname_hash.hpp"
+#include "dogen/sml/hash/relationship_types_hash.hpp"
 #include "dogen/sml/serialization/abstract_object_fwd_ser.hpp"
 #include "dogen/sml/types/generation_types.hpp"
 #include "dogen/sml/types/operation.hpp"
 #include "dogen/sml/types/origin_types.hpp"
 #include "dogen/sml/types/property.hpp"
 #include "dogen/sml/types/qname.hpp"
+#include "dogen/sml/types/relationship_types.hpp"
 #include "dogen/sml/types/type.hpp"
 
 namespace dogen {
@@ -48,6 +51,7 @@ namespace sml {
 class abstract_object : public dogen::sml::type {
 public:
     abstract_object(const abstract_object&) = default;
+    abstract_object(abstract_object&&) = default;
 
 public:
     abstract_object();
@@ -55,28 +59,26 @@ public:
     virtual ~abstract_object() noexcept = 0;
 
 public:
-    abstract_object(abstract_object&& rhs);
-
-public:
     abstract_object(
         const std::string& documentation,
         const boost::property_tree::ptree& meta_data,
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
-        const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts);
+        const bool is_fluent);
 
 private:
     template<typename Archive>
@@ -90,55 +92,65 @@ public:
 
 public:
     /**
-     * @brief State of this entity.
+     * @brief All the properties associated with this type.
+     *
+     * This is a union of the following sets:
      *
-     * Does not include inherited attributes.
+     * @li the set of all properies obtained via inheritance relationships;
+     * @li the set of all properies obtained via modeling of concepts, including any refinements;
+     * @li the set of all properies directly associated with the type (local).
+     *
+     * The first and third sets are cached in this object. The second isn't as we do
+     * not have a need for it.
      */
     /**@{*/
-    const std::list<dogen::sml::property>& properties() const;
-    std::list<dogen::sml::property>& properties();
-    void properties(const std::list<dogen::sml::property>& v);
-    void properties(const std::list<dogen::sml::property>&& v);
+    const std::list<dogen::sml::property>& all_properties() const;
+    std::list<dogen::sml::property>& all_properties();
+    void all_properties(const std::list<dogen::sml::property>& v);
+    void all_properties(const std::list<dogen::sml::property>&& v);
     /**@}*/
 
     /**
-     * @brief Operations (methods) that can be executed.
+     * @brief The set of all properies directly associated with the type.
      */
     /**@{*/
-    const std::list<dogen::sml::operation>& operations() const;
-    std::list<dogen::sml::operation>& operations();
-    void operations(const std::list<dogen::sml::operation>& v);
-    void operations(const std::list<dogen::sml::operation>&& v);
+    const std::list<dogen::sml::property>& local_properties() const;
+    std::list<dogen::sml::property>& local_properties();
+    void local_properties(const std::list<dogen::sml::property>& v);
+    void local_properties(const std::list<dogen::sml::property>&& v);
     /**@}*/
 
     /**
-     * @brief Qualified name for the object's parent, if it it has one.
+     * @brief The set of all properies obtained via inheritance, by parent name.
      */
     /**@{*/
-    const boost::optional<dogen::sml::qname>& parent_name() const;
-    boost::optional<dogen::sml::qname>& parent_name();
-    void parent_name(const boost::optional<dogen::sml::qname>& v);
-    void parent_name(const boost::optional<dogen::sml::qname>&& v);
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties() const;
+    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties();
+    void inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v);
+    void inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >&& v);
     /**@}*/
 
     /**
-     * @brief Qualified name for the root of the inheritance hierarchy, if the object is part of one.
+     * @brief Operations (methods) that can be executed.
      */
     /**@{*/
-    const boost::optional<dogen::sml::qname>& original_parent_name() const;
-    boost::optional<dogen::sml::qname>& original_parent_name();
-    void original_parent_name(const boost::optional<dogen::sml::qname>& v);
-    void original_parent_name(const boost::optional<dogen::sml::qname>&& v);
+    const std::list<dogen::sml::operation>& operations() const;
+    std::list<dogen::sml::operation>& operations();
+    void operations(const std::list<dogen::sml::operation>& v);
+    void operations(const std::list<dogen::sml::operation>&& v);
     /**@}*/
 
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships() const;
+    std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships();
+    void relationships(const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& v);
+    void relationships(const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >&& v);
+
     /**
-     * @brief All concrete types which are indirectly or directly derived from this type.
+     * @brief How many type arguments does this type have
      */
     /**@{*/
-    const std::list<dogen::sml::qname>& leaves() const;
-    std::list<dogen::sml::qname>& leaves();
-    void leaves(const std::list<dogen::sml::qname>& v);
-    void leaves(const std::list<dogen::sml::qname>&& v);
+    unsigned int number_of_type_arguments() const;
+    void number_of_type_arguments(const unsigned int v);
     /**@}*/
 
     /**
@@ -150,11 +162,11 @@ public:
     /**@}*/
 
     /**
-     * @brief How many type arguments does this type have
+     * @brief If true, the type has at least one parent.
      */
     /**@{*/
-    unsigned int number_of_type_arguments() const;
-    void number_of_type_arguments(const unsigned int v);
+    bool is_child() const;
+    void is_child(const bool v);
     /**@}*/
 
     /**
@@ -168,6 +180,14 @@ public:
     /**@}*/
 
     /**
+     * @brief True if the type is at the top of an inheritance hierarchy.
+     */
+    /**@{*/
+    bool is_inheritance_root() const;
+    void is_inheritance_root(const bool v);
+    /**@}*/
+
+    /**
      * @brief If true, do not generate setters for the type's properties.
      */
     /**@{*/
@@ -202,16 +222,6 @@ public:
     void is_fluent(const bool v);
     /**@}*/
 
-    /**
-     * @brief List of concepts modeled by this object.
-     */
-    /**@{*/
-    const std::list<dogen::sml::qname>& modeled_concepts() const;
-    std::list<dogen::sml::qname>& modeled_concepts();
-    void modeled_concepts(const std::list<dogen::sml::qname>& v);
-    void modeled_concepts(const std::list<dogen::sml::qname>&& v);
-    /**@}*/
-
 protected:
     bool compare(const abstract_object& rhs) const;
 public:
@@ -221,19 +231,20 @@ protected:
     void swap(abstract_object& other) noexcept;
 
 private:
-    std::list<dogen::sml::property> properties_;
+    std::list<dogen::sml::property> all_properties_;
+    std::list<dogen::sml::property> local_properties_;
+    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> > inherited_properties_;
     std::list<dogen::sml::operation> operations_;
-    boost::optional<dogen::sml::qname> parent_name_;
-    boost::optional<dogen::sml::qname> original_parent_name_;
-    std::list<dogen::sml::qname> leaves_;
-    bool is_parent_;
+    std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> > relationships_;
     unsigned int number_of_type_arguments_;
+    bool is_parent_;
+    bool is_child_;
     bool is_visitable_;
+    bool is_inheritance_root_;
     bool is_immutable_;
     bool is_versioned_;
     bool is_comparable_;
     bool is_fluent_;
-    std::list<dogen::sml::qname> modeled_concepts_;
 };
 
 inline abstract_object::~abstract_object() noexcept { }
diff --git a/projects/sml/include/dogen/sml/types/all.hpp b/projects/sml/include/dogen/sml/types/all.hpp
index cebe765..51753c3 100644
--- a/projects/sml/include/dogen/sml/types/all.hpp
+++ b/projects/sml/include/dogen/sml/types/all.hpp
@@ -22,16 +22,15 @@
 #include "dogen/sml/types/abstract_object.hpp"
 #include "dogen/sml/types/all_model_items_traversal.hpp"
 #include "dogen/sml/types/all_types_traversal.hpp"
-#include "dogen/sml/types/association_traversal.hpp"
-#include "dogen/sml/types/cache_error.hpp"
 #include "dogen/sml/types/concept.hpp"
 #include "dogen/sml/types/entity.hpp"
 #include "dogen/sml/types/enumeration.hpp"
 #include "dogen/sml/types/enumerator.hpp"
 #include "dogen/sml/types/factory.hpp"
-#include "dogen/sml/types/generalisation_traversal.hpp"
 #include "dogen/sml/types/generation_types.hpp"
 #include "dogen/sml/types/hydration_error.hpp"
+#include "dogen/sml/types/indexer.hpp"
+#include "dogen/sml/types/indexing_error.hpp"
 #include "dogen/sml/types/injection_error.hpp"
 #include "dogen/sml/types/injector.hpp"
 #include "dogen/sml/types/json_hydrator.hpp"
@@ -50,9 +49,8 @@
 #include "dogen/sml/types/parameter.hpp"
 #include "dogen/sml/types/primitive.hpp"
 #include "dogen/sml/types/property.hpp"
-#include "dogen/sml/types/property_cache.hpp"
-#include "dogen/sml/types/property_cache_interface.hpp"
 #include "dogen/sml/types/qname.hpp"
+#include "dogen/sml/types/relationship_types.hpp"
 #include "dogen/sml/types/repository.hpp"
 #include "dogen/sml/types/resolution_error.hpp"
 #include "dogen/sml/types/resolver.hpp"
diff --git a/projects/sml/include/dogen/sml/types/association_traversal.hpp b/projects/sml/include/dogen/sml/types/association_traversal.hpp
deleted file mode 100644
index 3d92b5b..0000000
--- a/projects/sml/include/dogen/sml/types/association_traversal.hpp
+++ /dev/null
@@ -1,71 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_ASSOCIATION_TRAVERSAL_HPP
-#define DOGEN_SML_TYPES_ASSOCIATION_TRAVERSAL_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-#include "dogen/sml/types/model.hpp"
-
-namespace dogen {
-namespace sml {
-
-/**
- * @brief Performs a traversal across all types in a domain model.
- */
-/**@{*/
-// template<typename EventVisitor>
-// void association_traversal(const model& m, const abstract_object& o,
-//     const EventVisitor& ev) {
-//     for (const auto& c : m.concepts())
-//         ev.on_next_type(c);
-
-//     for (const auto& p : m.primitives())
-//         ev.on_next_type(p);
-
-//     for (const auto& e : m.enumerations())
-//         ev.on_next_type(e);
-
-//     for (const auto& o : m.objects())
-//         ev.on_next_type(o);
-// }
-
-// template<typename EventVisitor>
-// void association_traversal(model& m, EventVisitor& ev) {
-//     for (const auto& c : m.concepts())
-//         ev.on_next_type(c);
-
-//     for (const auto& p : m.primitives())
-//         ev.on_next_type(p);
-
-//     for (const auto& e : m.enumerations())
-//         ev.on_next_type(e);
-
-//     for (const auto& o : m.objects())
-//         ev.on_next_type(o);
-// }
-/**@}*/
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/association_traversal_fwd.hpp b/projects/sml/include/dogen/sml/types/association_traversal_fwd.hpp
deleted file mode 100644
index 6bc2fe8..0000000
--- a/projects/sml/include/dogen/sml/types/association_traversal_fwd.hpp
+++ /dev/null
@@ -1,35 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_ASSOCIATION_TRAVERSAL_FWD_HPP
-#define DOGEN_SML_TYPES_ASSOCIATION_TRAVERSAL_FWD_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-namespace dogen {
-namespace sml {
-
-class association_traversal;
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/cache_error.hpp b/projects/sml/include/dogen/sml/types/cache_error.hpp
deleted file mode 100644
index ac98e93..0000000
--- a/projects/sml/include/dogen/sml/types/cache_error.hpp
+++ /dev/null
@@ -1,54 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_CACHE_ERROR_HPP
-#define DOGEN_SML_TYPES_CACHE_ERROR_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-#include <boost/exception/info.hpp>
-#include <string>
-
-namespace dogen {
-namespace sml {
-
-/**
- * @brief An error occurred while indexing or querying a cache.
- */
-class cache_error : public virtual std::exception, public virtual boost::exception {
-public:
-    cache_error() = default;
-    ~cache_error() noexcept = default;
-
-public:
-    cache_error(const std::string& message) : message_(message) { }
-
-public:
-    const char* what() const noexcept { return(message_.c_str()); }
-
-private:
-    const std::string message_;
-};
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/cache_error_fwd.hpp b/projects/sml/include/dogen/sml/types/cache_error_fwd.hpp
deleted file mode 100644
index 9ba7c3a..0000000
--- a/projects/sml/include/dogen/sml/types/cache_error_fwd.hpp
+++ /dev/null
@@ -1,38 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_CACHE_ERROR_FWD_HPP
-#define DOGEN_SML_TYPES_CACHE_ERROR_FWD_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-#include <boost/exception/info.hpp>
-#include <string>
-
-namespace dogen {
-namespace sml {
-
-class cache_error;
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/concept.hpp b/projects/sml/include/dogen/sml/types/concept.hpp
index 1350850..ad046ca 100644
--- a/projects/sml/include/dogen/sml/types/concept.hpp
+++ b/projects/sml/include/dogen/sml/types/concept.hpp
@@ -29,6 +29,8 @@
 #include <boost/property_tree/ptree.hpp>
 #include <list>
 #include <string>
+#include <unordered_map>
+#include "dogen/sml/hash/qname_hash.hpp"
 #include "dogen/sml/serialization/concept_fwd_ser.hpp"
 #include "dogen/sml/types/generation_types.hpp"
 #include "dogen/sml/types/operation.hpp"
@@ -55,7 +57,9 @@ public:
 
 public:
     concept(
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::string& documentation,
         const boost::property_tree::ptree& meta_data,
         const dogen::sml::qname& name,
@@ -73,15 +77,42 @@ private:
 
 public:
     /**
-     * @brief State of this entity.
+     * @brief All the properties associated with this type.
      *
-     * Does not include inherited attributes.
+     * This is a union of the following sets:
+     *
+     * @li the set of all properies obtained via inheritance relationships;
+     * @li the set of all properies obtained via modeling of concepts, including any refinements;
+     * @li the set of all properies directly associated with the type (local).
+     *
+     * The first and third sets are cached in this object. The second isn't as we do
+     * not have a need for it.
+     */
+    /**@{*/
+    const std::list<dogen::sml::property>& all_properties() const;
+    std::list<dogen::sml::property>& all_properties();
+    void all_properties(const std::list<dogen::sml::property>& v);
+    void all_properties(const std::list<dogen::sml::property>&& v);
+    /**@}*/
+
+    /**
+     * @brief The set of all properies directly associated with the type.
+     */
+    /**@{*/
+    const std::list<dogen::sml::property>& local_properties() const;
+    std::list<dogen::sml::property>& local_properties();
+    void local_properties(const std::list<dogen::sml::property>& v);
+    void local_properties(const std::list<dogen::sml::property>&& v);
+    /**@}*/
+
+    /**
+     * @brief The set of all properies obtained via inheritance, by parent name.
      */
     /**@{*/
-    const std::list<dogen::sml::property>& properties() const;
-    std::list<dogen::sml::property>& properties();
-    void properties(const std::list<dogen::sml::property>& v);
-    void properties(const std::list<dogen::sml::property>&& v);
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties() const;
+    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties();
+    void inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v);
+    void inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >&& v);
     /**@}*/
 
     /**
@@ -166,7 +197,9 @@ public:
     concept& operator=(concept other);
 
 private:
-    std::list<dogen::sml::property> properties_;
+    std::list<dogen::sml::property> all_properties_;
+    std::list<dogen::sml::property> local_properties_;
+    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> > inherited_properties_;
     std::string documentation_;
     boost::property_tree::ptree meta_data_;
     dogen::sml::qname name_;
diff --git a/projects/sml/include/dogen/sml/types/entity.hpp b/projects/sml/include/dogen/sml/types/entity.hpp
index 7766931..2d16267 100644
--- a/projects/sml/include/dogen/sml/types/entity.hpp
+++ b/projects/sml/include/dogen/sml/types/entity.hpp
@@ -51,19 +51,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
         const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts,
         const bool is_aggregate_root,
         const std::list<dogen::sml::property>& identity);
 
diff --git a/projects/sml/include/dogen/sml/types/factory.hpp b/projects/sml/include/dogen/sml/types/factory.hpp
index 0e99416..fed7991 100644
--- a/projects/sml/include/dogen/sml/types/factory.hpp
+++ b/projects/sml/include/dogen/sml/types/factory.hpp
@@ -51,19 +51,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
-        const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts);
+        const bool is_fluent);
 
 private:
     template<typename Archive>
diff --git a/projects/sml/include/dogen/sml/types/generalisation_traversal.hpp b/projects/sml/include/dogen/sml/types/generalisation_traversal.hpp
deleted file mode 100644
index e69de29..0000000
diff --git a/projects/sml/include/dogen/sml/types/generalisation_traversal_fwd.hpp b/projects/sml/include/dogen/sml/types/generalisation_traversal_fwd.hpp
deleted file mode 100644
index f55f239..0000000
--- a/projects/sml/include/dogen/sml/types/generalisation_traversal_fwd.hpp
+++ /dev/null
@@ -1,35 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_GENERALISATION_TRAVERSAL_FWD_HPP
-#define DOGEN_SML_TYPES_GENERALISATION_TRAVERSAL_FWD_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-namespace dogen {
-namespace sml {
-
-class generalisation_traversal;
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/indexer.hpp b/projects/sml/include/dogen/sml/types/indexer.hpp
new file mode 100644
index 0000000..c6adf62
--- /dev/null
+++ b/projects/sml/include/dogen/sml/types/indexer.hpp
@@ -0,0 +1,76 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TYPES_INDEXER_HPP
+#define DOGEN_SML_TYPES_INDEXER_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include "dogen/sml/types/type_visitor.hpp"
+#include "dogen/sml/types/model.hpp"
+
+namespace dogen {
+namespace sml {
+
+/**
+ * @brief Populates all of the indexing data structures across the
+ * model.
+ *
+ * The indexer expects to receive a partial model such as ones coming
+ * straight out of Dia to SML transformation.
+ *
+ * The indexing data structures are those like all properties,
+ * inherited properties, leaves, etc.
+ */
+class indexer : private type_visitor {
+public:
+    indexer() = default;
+    indexer(const indexer&) = default;
+    indexer(indexer&&) = default;
+    indexer& operator=(const indexer&) = default;
+
+public:
+    virtual ~indexer() noexcept { }
+
+private:
+    void index(abstract_object& o) const;
+
+private:
+    using type_visitor::visit;
+    void visit(enumeration& e) const override;
+    void visit(service& s) const override;
+    void visit(factory& f) const override;
+    void visit(repository& r) const override;
+    void visit(value_object& vo) const override;
+    void visit(keyed_entity& ke) const override;
+    void visit(entity& e) const override;
+
+public:
+    /**
+     * @brief Indexes the supplied model.
+     */
+    void index(model& m) const;
+};
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/indexer_fwd.hpp b/projects/sml/include/dogen/sml/types/indexer_fwd.hpp
new file mode 100644
index 0000000..ef6b0ca
--- /dev/null
+++ b/projects/sml/include/dogen/sml/types/indexer_fwd.hpp
@@ -0,0 +1,35 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TYPES_INDEXER_FWD_HPP
+#define DOGEN_SML_TYPES_INDEXER_FWD_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+namespace dogen {
+namespace sml {
+
+class indexer;
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/indexing_error.hpp b/projects/sml/include/dogen/sml/types/indexing_error.hpp
new file mode 100644
index 0000000..68feb1a
--- /dev/null
+++ b/projects/sml/include/dogen/sml/types/indexing_error.hpp
@@ -0,0 +1,54 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TYPES_INDEXING_ERROR_HPP
+#define DOGEN_SML_TYPES_INDEXING_ERROR_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include <boost/exception/info.hpp>
+#include <string>
+
+namespace dogen {
+namespace sml {
+
+/**
+ * @brief An error occurred while trying to index a model.
+ */
+class indexing_error : public virtual std::exception, public virtual boost::exception {
+public:
+    indexing_error() = default;
+    ~indexing_error() noexcept = default;
+
+public:
+    indexing_error(const std::string& message) : message_(message) { }
+
+public:
+    const char* what() const noexcept { return(message_.c_str()); }
+
+private:
+    const std::string message_;
+};
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/indexing_error_fwd.hpp b/projects/sml/include/dogen/sml/types/indexing_error_fwd.hpp
new file mode 100644
index 0000000..267172c
--- /dev/null
+++ b/projects/sml/include/dogen/sml/types/indexing_error_fwd.hpp
@@ -0,0 +1,38 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TYPES_INDEXING_ERROR_FWD_HPP
+#define DOGEN_SML_TYPES_INDEXING_ERROR_FWD_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+#include <boost/exception/info.hpp>
+#include <string>
+
+namespace dogen {
+namespace sml {
+
+class indexing_error;
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/keyed_entity.hpp b/projects/sml/include/dogen/sml/types/keyed_entity.hpp
index 3dc29d1..4619a88 100644
--- a/projects/sml/include/dogen/sml/types/keyed_entity.hpp
+++ b/projects/sml/include/dogen/sml/types/keyed_entity.hpp
@@ -62,19 +62,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
         const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts,
         const bool is_aggregate_root,
         const std::list<dogen::sml::property>& identity,
         const dogen::sml::qname& unversioned_key,
diff --git a/projects/sml/include/dogen/sml/types/property_cache.hpp b/projects/sml/include/dogen/sml/types/property_cache.hpp
deleted file mode 100644
index 7ada6a6..0000000
--- a/projects/sml/include/dogen/sml/types/property_cache.hpp
+++ /dev/null
@@ -1,93 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_PROPERTY_CACHE_HPP
-#define DOGEN_SML_TYPES_PROPERTY_CACHE_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-#include "dogen/sml/types/model.hpp"
-#include "dogen/sml/types/property.hpp"
-#include "dogen/sml/types/property_cache_interface.hpp"
-
-namespace dogen {
-namespace sml {
-
-class property_cache : public property_cache_interface {
-public:
-    property_cache(const property_cache&) = delete;
-    property_cache(property_cache&&) = delete;
-    property_cache& operator=(const property_cache&) = default;
-
-public:
-    property_cache();
-    virtual ~property_cache() noexcept { }
-
-public:
-public:
-    /**
-     * @brief Populates all the data structures required for querying.
-     *
-     * @param m model to populate the cache with.
-     */
-    void populate(const sml::model& m);
-
-    /**
-     * @brief Returns true if populating has been done, false otherwise.
-     */
-    bool is_populated() const;
-
-private:
-    /**
-     * @brief If not populated throws a population error.
-     */
-    void ensure_populated() const;
-
-public:
-    /**
-     * @pre is_populated must be true.
-     */
-    std::list<property>
-    get_all_properties(const abstract_object& o) const override;
-
-    /**
-     * @pre is_populated must be true.
-     */
-    std::list<property>
-    get_local_properties(const abstract_object& o) const override;
-
-    /**
-     * @pre is_populated must be true.
-     */
-    std::unordered_map<qname, std::list<property> >
-    get_inehrited_properties(const abstract_object& o) const override;
-
-private:
-    bool is_populated_;
-    std::unordered_map<qname, std::list<property> > all_properties_;
-    std::unordered_map<qname, std::list<property> > local_properties_;
-    std::unordered_map<qname, std::list<property> > inherited_properties_;
-};
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/property_cache_fwd.hpp b/projects/sml/include/dogen/sml/types/property_cache_fwd.hpp
deleted file mode 100644
index 819f367..0000000
--- a/projects/sml/include/dogen/sml/types/property_cache_fwd.hpp
+++ /dev/null
@@ -1,35 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_PROPERTY_CACHE_FWD_HPP
-#define DOGEN_SML_TYPES_PROPERTY_CACHE_FWD_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-namespace dogen {
-namespace sml {
-
-class property_cache;
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/property_cache_interface.hpp b/projects/sml/include/dogen/sml/types/property_cache_interface.hpp
deleted file mode 100644
index 6a1f28a..0000000
--- a/projects/sml/include/dogen/sml/types/property_cache_interface.hpp
+++ /dev/null
@@ -1,86 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_PROPERTY_CACHE_INTERFACE_HPP
-#define DOGEN_SML_TYPES_PROPERTY_CACHE_INTERFACE_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-#include <list>
-#include <unordered_map>
-#include "dogen/sml/types/property.hpp"
-#include "dogen/sml/types/abstract_object.hpp"
-
-namespace dogen {
-namespace sml {
-
-/**
- * @brief Indexes model information and provides a querying interface.
- */
-class property_cache_interface {
-public:
-    property_cache_interface() = default;
-    property_cache_interface(const property_cache_interface&) = delete;
-    property_cache_interface(property_cache_interface&&) = delete;
-    property_cache_interface& operator=(const property_cache_interface&) = default;
-
-public:
-    virtual ~property_cache_interface() noexcept;
-
-public:
-    /**
-     * @brief Get all properties associated with this object.
-     *
-     * This includes properties obtained via concepts, local
-     * properties, inherited properties, etc.
-     *
-     */
-    virtual std::list<property>
-    get_all_properties(const abstract_object& o) const = 0;
-
-    /**
-     * @brief Get the properties "local" to the object.
-     *
-     * Local properties are defined to be properties that belong to
-     * the type directly, and those that belong to concepts that the
-     * object models. Properties that belong to concepts modeled by
-     * parent classes are not included.
-     *
-     */
-    virtual std::list<property>
-    get_local_properties(const abstract_object& o) const = 0;
-
-    /**
-     * @brief Properties that the type inherited.
-     *
-     * Includes properties obtained by direct parents -
-     * e.g. equivalent to calling all properties on each parent.
-     *
-     * @return map with properties, by parent.
-     */
-    virtual std::unordered_map<qname, std::list<property> >
-    get_inehrited_properties(const abstract_object& o) const = 0;
-};
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/property_cache_interface_fwd.hpp b/projects/sml/include/dogen/sml/types/property_cache_interface_fwd.hpp
deleted file mode 100644
index 297dd5f..0000000
--- a/projects/sml/include/dogen/sml/types/property_cache_interface_fwd.hpp
+++ /dev/null
@@ -1,35 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#ifndef DOGEN_SML_TYPES_PROPERTY_CACHE_INTERFACE_FWD_HPP
-#define DOGEN_SML_TYPES_PROPERTY_CACHE_INTERFACE_FWD_HPP
-
-#if defined(_MSC_VER) && (_MSC_VER >= 1200)
-#pragma once
-#endif
-
-namespace dogen {
-namespace sml {
-
-class property_cache_interface;
-
-} }
-
-#endif
diff --git a/projects/sml/include/dogen/sml/types/relationship_types.hpp b/projects/sml/include/dogen/sml/types/relationship_types.hpp
new file mode 100644
index 0000000..fedb1b1
--- /dev/null
+++ b/projects/sml/include/dogen/sml/types/relationship_types.hpp
@@ -0,0 +1,48 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TYPES_RELATIONSHIP_TYPES_HPP
+#define DOGEN_SML_TYPES_RELATIONSHIP_TYPES_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+namespace dogen {
+namespace sml {
+
+/**
+ * @brief Ways in which a type can be related to another for indexing purposes.
+ */
+enum class relationship_types : unsigned int {
+    invalid = 0, ///< Represents an uninitialised enum
+    original_parents = 1, ///< Types at the root of the inheritance hierarchy.
+    parents = 2, ///< Types that are direct parents of this type.
+    regular_associations = 3, ///< Types that are involved in aggregation or composition relationships.
+    pointer_associations = 4, ///< Types that are involved in aggregation or composition relationships via a pointer.
+    leaves = 5, ///< Types that are at the bottom of the inheritance tree.
+    visitor = 6, ///< Type that provides visitation services for this type.
+    key = 7, ///< Types that are used in the identity function of this type.
+    modeled_concepts = 8 ///< Concepts modeled by this type.
+};
+
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/relationship_types_fwd.hpp b/projects/sml/include/dogen/sml/types/relationship_types_fwd.hpp
new file mode 100644
index 0000000..199c756
--- /dev/null
+++ b/projects/sml/include/dogen/sml/types/relationship_types_fwd.hpp
@@ -0,0 +1,34 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#ifndef DOGEN_SML_TYPES_RELATIONSHIP_TYPES_FWD_HPP
+#define DOGEN_SML_TYPES_RELATIONSHIP_TYPES_FWD_HPP
+
+#if defined(_MSC_VER) && (_MSC_VER >= 1200)
+#pragma once
+#endif
+
+namespace dogen {
+namespace sml {
+
+enum class relationship_types : unsigned int;
+} }
+
+#endif
diff --git a/projects/sml/include/dogen/sml/types/repository.hpp b/projects/sml/include/dogen/sml/types/repository.hpp
index 4725c32..6fdd5cb 100644
--- a/projects/sml/include/dogen/sml/types/repository.hpp
+++ b/projects/sml/include/dogen/sml/types/repository.hpp
@@ -56,19 +56,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
-        const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts);
+        const bool is_fluent);
 
 private:
     template<typename Archive>
diff --git a/projects/sml/include/dogen/sml/types/service.hpp b/projects/sml/include/dogen/sml/types/service.hpp
index 89ad8b9..c919904 100644
--- a/projects/sml/include/dogen/sml/types/service.hpp
+++ b/projects/sml/include/dogen/sml/types/service.hpp
@@ -58,19 +58,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
         const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts,
         const dogen::sml::service_types& type);
 
 private:
diff --git a/projects/sml/include/dogen/sml/types/tags.hpp b/projects/sml/include/dogen/sml/types/tags.hpp
index ee128bc..5a98b0d 100644
--- a/projects/sml/include/dogen/sml/types/tags.hpp
+++ b/projects/sml/include/dogen/sml/types/tags.hpp
@@ -94,19 +94,6 @@ struct tags {
     static const std::string generate_preamble;
 
     /**
-     * @brief Name of the top-level parent of the inheritance
-     * hierarchy.
-     */
-
-    static const std::string original_parent_name;
-
-    /**
-     * @brief True if the top-level parent of the hierarchy is
-     * visitable.
-     */
-    static const std::string is_original_parent_visitable;
-
-    /**
      * @brief If true, the type cannot be inherited from.
      */
     static const std::string is_final;
diff --git a/projects/sml/include/dogen/sml/types/value_object.hpp b/projects/sml/include/dogen/sml/types/value_object.hpp
index a623ec1..3a84b97 100644
--- a/projects/sml/include/dogen/sml/types/value_object.hpp
+++ b/projects/sml/include/dogen/sml/types/value_object.hpp
@@ -58,19 +58,20 @@ public:
         const dogen::sml::qname& name,
         const dogen::sml::generation_types& generation_type,
         const dogen::sml::origin_types& origin_type,
-        const std::list<dogen::sml::property>& properties,
+        const std::list<dogen::sml::property>& all_properties,
+        const std::list<dogen::sml::property>& local_properties,
+        const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
         const std::list<dogen::sml::operation>& operations,
-        const boost::optional<dogen::sml::qname>& parent_name,
-        const boost::optional<dogen::sml::qname>& original_parent_name,
-        const std::list<dogen::sml::qname>& leaves,
-        const bool is_parent,
+        const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
         const unsigned int number_of_type_arguments,
+        const bool is_parent,
+        const bool is_child,
         const bool is_visitable,
+        const bool is_inheritance_root,
         const bool is_immutable,
         const bool is_versioned,
         const bool is_comparable,
         const bool is_fluent,
-        const std::list<dogen::sml::qname>& modeled_concepts,
         const dogen::sml::value_object_types& type);
 
 private:
diff --git a/projects/sml/spec/injector_spec.cpp b/projects/sml/spec/injector_spec.cpp
index c24e85b..71700b8 100644
--- a/projects/sml/spec/injector_spec.cpp
+++ b/projects/sml/spec/injector_spec.cpp
@@ -111,7 +111,7 @@ BOOST_AUTO_TEST_CASE(entity_object_does_not_result_in_injected_keys) {
         if (is_type_zero(qn)) {
             BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
             const auto& o(dynamic_cast<dogen::sml::entity&>(*pair.second));
-            BOOST_REQUIRE(o.properties().size() == 1);
+            BOOST_REQUIRE(o.local_properties().size() == 1);
             BOOST_REQUIRE(!o.identity().empty());
         }
     }
@@ -136,7 +136,7 @@ BOOST_AUTO_TEST_CASE(unversioned_keyed_object_with_no_identity_attributes_throws
             BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
             using dogen::sml::keyed_entity;
             auto& o(dynamic_cast<keyed_entity&>(*pair.second));
-            BOOST_REQUIRE(o.properties().size() == 1);
+            BOOST_REQUIRE(o.local_properties().size() == 1);
             BOOST_REQUIRE(!o.is_versioned());
             o.identity().clear();
         }
@@ -159,7 +159,7 @@ BOOST_AUTO_TEST_CASE(unversioned_keyed_object_has_unversioned_key_injected) {
         if (is_type_zero(qn)) {
             BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
             auto& ae(dynamic_cast<dogen::sml::abstract_entity&>(*pair.second));
-            BOOST_REQUIRE(ae.properties().size() == 1);
+            BOOST_REQUIRE(ae.local_properties().size() == 1);
             BOOST_REQUIRE(!ae.is_versioned());
             BOOST_REQUIRE(ae.identity().size() == 1);
         }
@@ -208,7 +208,7 @@ BOOST_AUTO_TEST_CASE(versioned_keyed_object_has_both_keys_injected) {
         if (is_type_zero(qn)) {
             BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
             auto& ae(dynamic_cast<dogen::sml::abstract_entity&>(*pair.second));
-            BOOST_REQUIRE(ae.properties().size() == 1);
+            BOOST_REQUIRE(ae.local_properties().size() == 1);
             BOOST_REQUIRE(!ae.is_versioned());
             BOOST_REQUIRE(ae.identity().size() == 1);
             ae.is_versioned(true);
@@ -264,7 +264,7 @@ BOOST_AUTO_TEST_CASE(versioned_object_has_version_propery_injected) {
     auto m(mock_model_factory::build_single_type_model());
     BOOST_REQUIRE(m.objects().size() == 1);
     auto& ob(*m.objects().begin()->second);
-    BOOST_REQUIRE(ob.properties().empty());
+    BOOST_REQUIRE(ob.local_properties().empty());
     ob.is_versioned(true);
     BOOST_LOG_SEV(lg, debug) << "before: " << ob;
 
@@ -274,9 +274,9 @@ BOOST_AUTO_TEST_CASE(versioned_object_has_version_propery_injected) {
     BOOST_REQUIRE(m.objects().size() == 1);
     auto& oa(*m.objects().begin()->second);
     BOOST_LOG_SEV(lg, debug) << "object after: " << oa;
-    BOOST_REQUIRE(oa.properties().size() == 1);
-    BOOST_CHECK(oa.properties().front().name() == version_name);
-    BOOST_CHECK(!oa.properties().front().documentation().empty());
+    BOOST_REQUIRE(oa.local_properties().size() == 1);
+    BOOST_CHECK(oa.local_properties().front().name() == version_name);
+    BOOST_CHECK(!oa.local_properties().front().documentation().empty());
 }
 
 BOOST_AUTO_TEST_CASE(visitable_object_with_no_leaves_throws) {
@@ -286,6 +286,7 @@ BOOST_AUTO_TEST_CASE(visitable_object_with_no_leaves_throws) {
     BOOST_REQUIRE(m.objects().size() == 1);
     auto& ob(*m.objects().begin()->second);
     ob.is_visitable(true);
+    ob.is_inheritance_root(true);
     BOOST_LOG_SEV(lg, debug) << "model: " << m;
 
     dogen::sml::injector i;
@@ -329,10 +330,20 @@ BOOST_AUTO_TEST_CASE(visitable_object_has_visitor_injected) {
             BOOST_CHECK(!s.is_versioned());
             BOOST_CHECK(!s.is_visitable());
             BOOST_CHECK(!s.is_immutable());
-            BOOST_CHECK(!s.parent_name());
-            BOOST_CHECK(!s.original_parent_name());
-            BOOST_CHECK(s.leaves().empty());
-            BOOST_CHECK(s.modeled_concepts().empty());
+
+            using dogen::sml::relationship_types;
+            auto i(s.relationships().find(relationship_types::parents));
+            BOOST_CHECK(i == s.relationships().end());
+
+            i = s.relationships().find(relationship_types::original_parents);
+            BOOST_CHECK(i == s.relationships().end());
+
+            i = s.relationships().find(relationship_types::leaves);
+            BOOST_CHECK(i == s.relationships().end());
+
+            i = s.relationships().find(relationship_types::modeled_concepts);
+            BOOST_CHECK(i == s.relationships().end());
+
             BOOST_CHECK(s.number_of_type_arguments() == 0);
 
             BOOST_REQUIRE(s.operations().size() == 1);
diff --git a/projects/sml/spec/resolver_spec.cpp b/projects/sml/spec/resolver_spec.cpp
index e2883c5..ec8fdf9 100644
--- a/projects/sml/spec/resolver_spec.cpp
+++ b/projects/sml/spec/resolver_spec.cpp
@@ -75,6 +75,14 @@ bool is_type_two(const dogen::sml::qname& qn) {
     return mock_model_factory::simple_name(2) == qn.simple_name();
 }
 
+dogen::sml::qname parent_name(const dogen::sml::abstract_object& o) {
+    using dogen::sml::relationship_types;
+    const auto i(o.relationships().find(relationship_types::parents));
+    BOOST_REQUIRE(i != o.relationships().end());
+    BOOST_REQUIRE(i->second.size() == 1);
+    return i->second.front();
+}
+
 }
 
 using dogen::utility::test::contains_checker;
@@ -97,9 +105,10 @@ BOOST_AUTO_TEST_CASE(object_with_property_type_in_the_same_model_resolves_succes
 
     for (const auto& pair : m.objects()) {
         auto& o(*pair.second);
-        BOOST_CHECK(o.properties().size() == 1 || o.properties().empty());
-        if (o.properties().size() == 1)
-            o.properties().begin()->type().type().model_name("");
+        auto& props(o.local_properties());
+        BOOST_CHECK(props.size() == 1 || props.empty());
+        if (props.size() == 1)
+            props.begin()->type().type().model_name().clear();
     }
     const auto original(m);
     BOOST_LOG_SEV(lg, debug) << "original: " << original;
@@ -120,8 +129,9 @@ BOOST_AUTO_TEST_CASE(object_with_property_type_in_the_same_model_resolves_succes
             found = true;
 
             const auto& o(*pair.second);
-            BOOST_CHECK(o.properties().size() == 1);
-            const auto& prop(o.properties().front());
+            auto& props(o.local_properties());
+            BOOST_CHECK(props.size() == 1);
+            const auto& prop(props.front());
             BOOST_LOG_SEV(lg, debug) << "property: " << prop;
             BOOST_CHECK(is_type_one(prop.type().type()));
             BOOST_CHECK(is_model_zero(prop.type().type()));
@@ -154,8 +164,9 @@ BOOST_AUTO_TEST_CASE(object_with_property_type_in_different_model_results_in_suc
             found = true;
 
             const auto& o(*pair.second);
-            BOOST_CHECK(o.properties().size() == 1);
-            const auto& prop(o.properties().front());
+            auto& props(o.local_properties());
+            BOOST_CHECK(props.size() == 1);
+            const auto& prop(props.front());
             BOOST_LOG_SEV(lg, debug) << "property: " << prop;
 
             BOOST_CHECK(is_type_one(prop.type().type()));
@@ -190,18 +201,18 @@ BOOST_AUTO_TEST_CASE(object_with_parent_in_the_same_model_resolves_successfully)
     bool found(false);
     for (const auto pair : combined.objects()) {
         const auto& qn(pair.first);
-        if (is_type_zero(qn)) {
-            BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
-            found = true;
-
-            const auto& o(*pair.second);
-            const auto pn(o.parent_name());
-            BOOST_REQUIRE(pn);
-            BOOST_LOG_SEV(lg, debug) << "parent: " << *pn;
-            BOOST_CHECK(is_type_one(*pn));
-            BOOST_CHECK(is_model_zero(*pn));
-            const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
-        }
+        if (!is_type_zero(qn))
+            continue;
+
+        BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
+        found = true;
+
+        const auto& o(*pair.second);
+        const auto& pn(parent_name(o));
+        BOOST_LOG_SEV(lg, debug) << "parent: " << pn;
+        BOOST_CHECK(is_type_one(pn));
+        BOOST_CHECK(is_model_zero(pn));
+        const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
     }
     BOOST_CHECK(found);
 }
@@ -222,18 +233,18 @@ BOOST_AUTO_TEST_CASE(object_with_parent_in_different_models_resolves_successfull
     bool found(false);
     for (const auto pair : combined.objects()) {
         const auto& qn(pair.first);
-        if (is_type_zero(qn)) {
-            BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
-            found = true;
-
-            const auto& o(*pair.second);
-            const auto pn(o.parent_name());
-            BOOST_REQUIRE(pn);
-            BOOST_LOG_SEV(lg, debug) << "parent: " << *pn;
-            BOOST_CHECK(is_type_one(*pn));
-            BOOST_CHECK(is_model_one(*pn));
-            const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
-        }
+        if (!is_type_zero(qn))
+            continue;
+
+        BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
+        found = true;
+
+        const auto& o(*pair.second);
+        const auto& pn(parent_name(o));
+        BOOST_LOG_SEV(lg, debug) << "parent: " << pn;
+        BOOST_CHECK(is_type_one(pn));
+        BOOST_CHECK(is_model_one(pn));
+        const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
     }
     BOOST_CHECK(found);
 }
@@ -260,22 +271,20 @@ BOOST_AUTO_TEST_CASE(object_with_third_degree_parent_in_same_model_resolves_succ
             found_one = true;
 
             const auto& o(*pair.second);
-            const auto pn(o.parent_name());
-            BOOST_REQUIRE(pn);
-            BOOST_LOG_SEV(lg, debug) << "parent: " << *pn;
-            BOOST_CHECK(is_type_one(*pn));
-            BOOST_CHECK(is_model_zero(*pn));
+            const auto& pn(parent_name(o));
+            BOOST_LOG_SEV(lg, debug) << "parent: " << pn;
+            BOOST_CHECK(is_type_one(pn));
+            BOOST_CHECK(is_model_zero(pn));
             const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
         } else if (is_type_one(qn)) {
             BOOST_LOG_SEV(lg, debug) << "found object: " << qn;
             found_two = true;
 
             const auto& o(*pair.second);
-            const auto pn(o.parent_name());
-            BOOST_REQUIRE(pn);
-            BOOST_LOG_SEV(lg, debug) << "parent: " << *pn;
-            BOOST_CHECK(is_type_two(*pn));
-            BOOST_CHECK(is_model_zero(*pn));
+            const auto& pn(parent_name(o));
+            BOOST_LOG_SEV(lg, debug) << "parent: " << pn;
+            BOOST_CHECK(is_type_two(pn));
+            BOOST_CHECK(is_model_zero(pn));
             const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
         }
     }
@@ -320,11 +329,10 @@ BOOST_AUTO_TEST_CASE(object_with_third_degree_parent_in_different_models_resolve
             found = true;
 
             const auto& o(*pair.second);
-            const auto pn(o.parent_name());
-            BOOST_REQUIRE(pn);
-            BOOST_LOG_SEV(lg, debug) << "parent: " << *pn;
-            BOOST_CHECK(is_type_one(*pn));
-            BOOST_CHECK(is_model_one(*pn));
+            const auto& pn(parent_name(o));
+            BOOST_LOG_SEV(lg, debug) << "parent: " << pn;
+            BOOST_CHECK(is_type_one(pn));
+            BOOST_CHECK(is_model_one(pn));
             const auto vo(dynamic_cast<const dogen::sml::value_object&>(o));
         }
     }
diff --git a/projects/sml/src/hash/abstract_object_hash.cpp b/projects/sml/src/hash/abstract_object_hash.cpp
index ed30ef4..5443176 100644
--- a/projects/sml/src/hash/abstract_object_hash.cpp
+++ b/projects/sml/src/hash/abstract_object_hash.cpp
@@ -24,6 +24,7 @@
 #include "dogen/sml/hash/origin_types_hash.hpp"
 #include "dogen/sml/hash/property_hash.hpp"
 #include "dogen/sml/hash/qname_hash.hpp"
+#include "dogen/sml/hash/relationship_types_hash.hpp"
 #include "dogen/sml/hash/type_hash.hpp"
 
 namespace {
@@ -43,21 +44,20 @@ inline std::size_t hash_std_list_dogen_sml_property(const std::list<dogen::sml::
     return seed;
 }
 
-inline std::size_t hash_std_list_dogen_sml_operation(const std::list<dogen::sml::operation>& v){
+inline std::size_t hash_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v){
     std::size_t seed(0);
     for (const auto i : v) {
-        combine(seed, i);
+        combine(seed, i.first);
+        combine(seed, hash_std_list_dogen_sml_property(i.second));
     }
     return seed;
 }
 
-inline std::size_t hash_boost_optional_dogen_sml_qname(const boost::optional<dogen::sml::qname>& v){
+inline std::size_t hash_std_list_dogen_sml_operation(const std::list<dogen::sml::operation>& v){
     std::size_t seed(0);
-
-    if (!v)
-        return seed;
-
-    combine(seed, *v);
+    for (const auto i : v) {
+        combine(seed, i);
+    }
     return seed;
 }
 
@@ -69,6 +69,15 @@ inline std::size_t hash_std_list_dogen_sml_qname(const std::list<dogen::sml::qna
     return seed;
 }
 
+inline std::size_t hash_std_unordered_map_dogen_sml_relationship_types_std_list_dogen_sml_qname_(const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& v){
+    std::size_t seed(0);
+    for (const auto i : v) {
+        combine(seed, i.first);
+        combine(seed, hash_std_list_dogen_sml_qname(i.second));
+    }
+    return seed;
+}
+
 }
 
 namespace dogen {
@@ -79,19 +88,20 @@ std::size_t abstract_object_hasher::hash(const abstract_object&v) {
 
     combine(seed, dynamic_cast<const dogen::sml::type&>(v));
 
-    combine(seed, hash_std_list_dogen_sml_property(v.properties()));
+    combine(seed, hash_std_list_dogen_sml_property(v.all_properties()));
+    combine(seed, hash_std_list_dogen_sml_property(v.local_properties()));
+    combine(seed, hash_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(v.inherited_properties()));
     combine(seed, hash_std_list_dogen_sml_operation(v.operations()));
-    combine(seed, hash_boost_optional_dogen_sml_qname(v.parent_name()));
-    combine(seed, hash_boost_optional_dogen_sml_qname(v.original_parent_name()));
-    combine(seed, hash_std_list_dogen_sml_qname(v.leaves()));
-    combine(seed, v.is_parent());
+    combine(seed, hash_std_unordered_map_dogen_sml_relationship_types_std_list_dogen_sml_qname_(v.relationships()));
     combine(seed, v.number_of_type_arguments());
+    combine(seed, v.is_parent());
+    combine(seed, v.is_child());
     combine(seed, v.is_visitable());
+    combine(seed, v.is_inheritance_root());
     combine(seed, v.is_immutable());
     combine(seed, v.is_versioned());
     combine(seed, v.is_comparable());
     combine(seed, v.is_fluent());
-    combine(seed, hash_std_list_dogen_sml_qname(v.modeled_concepts()));
 
     return seed;
 }
diff --git a/projects/sml/src/hash/concept_hash.cpp b/projects/sml/src/hash/concept_hash.cpp
index a02faca..d946d07 100644
--- a/projects/sml/src/hash/concept_hash.cpp
+++ b/projects/sml/src/hash/concept_hash.cpp
@@ -42,6 +42,15 @@ inline std::size_t hash_std_list_dogen_sml_property(const std::list<dogen::sml::
     return seed;
 }
 
+inline std::size_t hash_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v){
+    std::size_t seed(0);
+    for (const auto i : v) {
+        combine(seed, i.first);
+        combine(seed, hash_std_list_dogen_sml_property(i.second));
+    }
+    return seed;
+}
+
 inline std::size_t hash_boost_property_tree_ptree(const boost::property_tree::ptree& v) {
     std::size_t seed(0);
     for (const auto& node : v) {
@@ -77,7 +86,9 @@ namespace sml {
 std::size_t concept_hasher::hash(const concept&v) {
     std::size_t seed(0);
 
-    combine(seed, hash_std_list_dogen_sml_property(v.properties()));
+    combine(seed, hash_std_list_dogen_sml_property(v.all_properties()));
+    combine(seed, hash_std_list_dogen_sml_property(v.local_properties()));
+    combine(seed, hash_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(v.inherited_properties()));
     combine(seed, v.documentation());
     combine(seed, hash_boost_property_tree_ptree(v.meta_data()));
     combine(seed, v.name());
diff --git a/projects/sml/src/io/abstract_object_io.cpp b/projects/sml/src/io/abstract_object_io.cpp
index 28f398d..a253da6 100644
--- a/projects/sml/src/io/abstract_object_io.cpp
+++ b/projects/sml/src/io/abstract_object_io.cpp
@@ -28,6 +28,7 @@
 #include "dogen/sml/io/origin_types_io.hpp"
 #include "dogen/sml/io/property_io.hpp"
 #include "dogen/sml/io/qname_io.hpp"
+#include "dogen/sml/io/relationship_types_io.hpp"
 #include "dogen/sml/io/type_io.hpp"
 
 namespace dogen {
diff --git a/projects/sml/src/io/concept_io.cpp b/projects/sml/src/io/concept_io.cpp
index b170793..39fee5e 100644
--- a/projects/sml/src/io/concept_io.cpp
+++ b/projects/sml/src/io/concept_io.cpp
@@ -42,6 +42,24 @@ inline std::ostream& operator<<(std::ostream& s, const std::list<dogen::sml::pro
 
 }
 
+namespace std {
+
+inline std::ostream& operator<<(std::ostream& s, const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v) {
+    s << "[";
+    for (auto i(v.begin()); i != v.end(); ++i) {
+        if (i != v.begin()) s << ", ";
+        s << "[ { " << "\"__type__\": " << "\"key\"" << ", " << "\"data\": ";
+        s << i->first;
+        s << " }, { " << "\"__type__\": " << "\"value\"" << ", " << "\"data\": ";
+        s << i->second;
+        s << " } ]";
+    }
+    s << " ] ";
+    return s;
+}
+
+}
+
 
 inline std::string tidy_up_string(std::string s) {
     boost::replace_all(s, "\r\n", "<new_line>");
@@ -94,7 +112,9 @@ namespace sml {
 std::ostream& operator<<(std::ostream& s, const concept& v) {
     s << " { "
       << "\"__type__\": " << "\"dogen::sml::concept\"" << ", "
-      << "\"properties\": " << v.properties() << ", "
+      << "\"all_properties\": " << v.all_properties() << ", "
+      << "\"local_properties\": " << v.local_properties() << ", "
+      << "\"inherited_properties\": " << v.inherited_properties() << ", "
       << "\"documentation\": " << "\"" << tidy_up_string(v.documentation()) << "\"" << ", "
       << "\"meta_data\": " << v.meta_data() << ", "
       << "\"name\": " << v.name() << ", "
diff --git a/projects/sml/src/io/relationship_types_io.cpp b/projects/sml/src/io/relationship_types_io.cpp
new file mode 100644
index 0000000..1a1039e
--- /dev/null
+++ b/projects/sml/src/io/relationship_types_io.cpp
@@ -0,0 +1,67 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#include <ostream>
+#include <stdexcept>
+#include "dogen/sml/io/relationship_types_io.hpp"
+
+namespace dogen {
+namespace sml {
+
+std::ostream& operator<<(std::ostream& s, const relationship_types& v) {
+    s << "{ " << "\"__type__\": " << "\"relationship_types\", " << "\"value\": ";
+
+    std::string attr;
+    switch (v) {
+    case relationship_types::invalid:
+        attr = "\"invalid\"";
+        break;
+    case relationship_types::original_parents:
+        attr = "\"original_parents\"";
+        break;
+    case relationship_types::parents:
+        attr = "\"parents\"";
+        break;
+    case relationship_types::regular_associations:
+        attr = "\"regular_associations\"";
+        break;
+    case relationship_types::pointer_associations:
+        attr = "\"pointer_associations\"";
+        break;
+    case relationship_types::leaves:
+        attr = "\"leaves\"";
+        break;
+    case relationship_types::visitor:
+        attr = "\"visitor\"";
+        break;
+    case relationship_types::key:
+        attr = "\"key\"";
+        break;
+    case relationship_types::modeled_concepts:
+        attr = "\"modeled_concepts\"";
+        break;
+    default:
+        throw std::invalid_argument("Invalid value for relationship_types");
+    }
+    s << attr << " }";
+    return s;
+}
+
+} }
\ No newline at end of file
diff --git a/projects/sml/src/serialization/abstract_object_ser.cpp b/projects/sml/src/serialization/abstract_object_ser.cpp
index dbf615e..83a6258 100644
--- a/projects/sml/src/serialization/abstract_object_ser.cpp
+++ b/projects/sml/src/serialization/abstract_object_ser.cpp
@@ -30,7 +30,6 @@
 #include <boost/property_tree/ptree_serialization.hpp>
 #include <boost/serialization/list.hpp>
 #include <boost/serialization/nvp.hpp>
-#include <boost/serialization/optional.hpp>
 #include <boost/serialization/string.hpp>
 #include "dogen/sml/serialization/abstract_object_ser.hpp"
 #include "dogen/sml/serialization/entity_ser.hpp"
@@ -41,10 +40,12 @@
 #include "dogen/sml/serialization/origin_types_ser.hpp"
 #include "dogen/sml/serialization/property_ser.hpp"
 #include "dogen/sml/serialization/qname_ser.hpp"
+#include "dogen/sml/serialization/relationship_types_ser.hpp"
 #include "dogen/sml/serialization/repository_ser.hpp"
 #include "dogen/sml/serialization/service_ser.hpp"
 #include "dogen/sml/serialization/type_ser.hpp"
 #include "dogen/sml/serialization/value_object_ser.hpp"
+#include "dogen/utility/serialization/unordered_map.hpp"
 
 #ifdef __linux__
 #include "eos/portable_iarchive.hpp"
@@ -64,19 +65,20 @@ void save(Archive& ar,
     const unsigned int /*version*/) {
     ar << make_nvp("type", base_object<dogen::sml::type>(v));
 
-    ar << make_nvp("properties", v.properties_);
+    ar << make_nvp("all_properties", v.all_properties_);
+    ar << make_nvp("local_properties", v.local_properties_);
+    ar << make_nvp("inherited_properties", v.inherited_properties_);
     ar << make_nvp("operations", v.operations_);
-    ar << make_nvp("parent_name", v.parent_name_);
-    ar << make_nvp("original_parent_name", v.original_parent_name_);
-    ar << make_nvp("leaves", v.leaves_);
-    ar << make_nvp("is_parent", v.is_parent_);
+    ar << make_nvp("relationships", v.relationships_);
     ar << make_nvp("number_of_type_arguments", v.number_of_type_arguments_);
+    ar << make_nvp("is_parent", v.is_parent_);
+    ar << make_nvp("is_child", v.is_child_);
     ar << make_nvp("is_visitable", v.is_visitable_);
+    ar << make_nvp("is_inheritance_root", v.is_inheritance_root_);
     ar << make_nvp("is_immutable", v.is_immutable_);
     ar << make_nvp("is_versioned", v.is_versioned_);
     ar << make_nvp("is_comparable", v.is_comparable_);
     ar << make_nvp("is_fluent", v.is_fluent_);
-    ar << make_nvp("modeled_concepts", v.modeled_concepts_);
 }
 
 template<typename Archive>
@@ -85,19 +87,20 @@ void load(Archive& ar,
     const unsigned int /*version*/) {
     ar >> make_nvp("type", base_object<dogen::sml::type>(v));
 
-    ar >> make_nvp("properties", v.properties_);
+    ar >> make_nvp("all_properties", v.all_properties_);
+    ar >> make_nvp("local_properties", v.local_properties_);
+    ar >> make_nvp("inherited_properties", v.inherited_properties_);
     ar >> make_nvp("operations", v.operations_);
-    ar >> make_nvp("parent_name", v.parent_name_);
-    ar >> make_nvp("original_parent_name", v.original_parent_name_);
-    ar >> make_nvp("leaves", v.leaves_);
-    ar >> make_nvp("is_parent", v.is_parent_);
+    ar >> make_nvp("relationships", v.relationships_);
     ar >> make_nvp("number_of_type_arguments", v.number_of_type_arguments_);
+    ar >> make_nvp("is_parent", v.is_parent_);
+    ar >> make_nvp("is_child", v.is_child_);
     ar >> make_nvp("is_visitable", v.is_visitable_);
+    ar >> make_nvp("is_inheritance_root", v.is_inheritance_root_);
     ar >> make_nvp("is_immutable", v.is_immutable_);
     ar >> make_nvp("is_versioned", v.is_versioned_);
     ar >> make_nvp("is_comparable", v.is_comparable_);
     ar >> make_nvp("is_fluent", v.is_fluent_);
-    ar >> make_nvp("modeled_concepts", v.modeled_concepts_);
 }
 
 } }
diff --git a/projects/sml/src/serialization/concept_ser.cpp b/projects/sml/src/serialization/concept_ser.cpp
index 2ff2ec1..8966384 100644
--- a/projects/sml/src/serialization/concept_ser.cpp
+++ b/projects/sml/src/serialization/concept_ser.cpp
@@ -37,6 +37,7 @@
 #include "dogen/sml/serialization/origin_types_ser.hpp"
 #include "dogen/sml/serialization/property_ser.hpp"
 #include "dogen/sml/serialization/qname_ser.hpp"
+#include "dogen/utility/serialization/unordered_map.hpp"
 
 #ifdef __linux__
 #include "eos/portable_iarchive.hpp"
@@ -50,7 +51,9 @@ template<typename Archive>
 void save(Archive& ar,
     const dogen::sml::concept& v,
     const unsigned int /*version*/) {
-    ar << make_nvp("properties", v.properties_);
+    ar << make_nvp("all_properties", v.all_properties_);
+    ar << make_nvp("local_properties", v.local_properties_);
+    ar << make_nvp("inherited_properties", v.inherited_properties_);
     ar << make_nvp("documentation", v.documentation_);
     ar << make_nvp("meta_data", v.meta_data_);
     ar << make_nvp("name", v.name_);
@@ -64,7 +67,9 @@ template<typename Archive>
 void load(Archive& ar,
     dogen::sml::concept& v,
     const unsigned int /*version*/) {
-    ar >> make_nvp("properties", v.properties_);
+    ar >> make_nvp("all_properties", v.all_properties_);
+    ar >> make_nvp("local_properties", v.local_properties_);
+    ar >> make_nvp("inherited_properties", v.inherited_properties_);
     ar >> make_nvp("documentation", v.documentation_);
     ar >> make_nvp("meta_data", v.meta_data_);
     ar >> make_nvp("name", v.name_);
diff --git a/projects/sml/src/test/mock_model_factory.cpp b/projects/sml/src/test/mock_model_factory.cpp
index 4b90a43..3f564cc 100644
--- a/projects/sml/src/test/mock_model_factory.cpp
+++ b/projects/sml/src/test/mock_model_factory.cpp
@@ -278,6 +278,43 @@ mock_exception(const unsigned int i, const dogen::sml::qname& model_qname,
     return r;
 }
 
+void add_relationship(dogen::sml::abstract_object& target,
+    const dogen::sml::type& relative, const dogen::sml::relationship_types rt) {
+    using dogen::sml::relationship_types;
+    target.relationships()[rt].push_back(relative.name());
+}
+
+const bool add_leaf(true);
+
+void parent_to_child(dogen::sml::abstract_object& parent,
+    dogen::sml::abstract_object& child,
+    dogen::sml::abstract_object& original_parent,
+    const bool add_leaf_relationship = true) {
+    using dogen::sml::relationship_types;
+    add_relationship(child, parent, relationship_types::parents);
+    add_relationship(child, original_parent,
+        relationship_types::original_parents);
+
+    original_parent.is_inheritance_root(true);
+    if (add_leaf_relationship)
+        add_relationship(parent, child, relationship_types::leaves);
+
+    parent.is_parent(true);
+    child.is_child(true);
+}
+
+void parent_to_child(dogen::sml::abstract_object& parent,
+    dogen::sml::abstract_object& child,
+    const bool add_leaf_relationship = true) {
+    parent_to_child(parent, child, parent, add_leaf_relationship);
+}
+
+void insert_object(dogen::sml::model& m,
+    boost::shared_ptr<dogen::sml::abstract_object> o) {
+    m.objects().insert(std::make_pair(o->name(), o));
+}
+
+
 }
 
 namespace dogen {
@@ -347,7 +384,7 @@ build_multi_type_model(const unsigned int n, const unsigned int type_n,
     case object_types::value_object:
         for (unsigned int i(0); i < type_n; ++i) {
             const auto o(mock_value_object(i, r.name(), mod_n));
-            r.objects().insert(std::make_pair(o->name(), o));
+            insert_object(r, o);
         }
         break;
     case object_types::enumeration:
@@ -359,7 +396,7 @@ build_multi_type_model(const unsigned int n, const unsigned int type_n,
     case object_types::exception:
         for (unsigned int i(0); i < type_n; ++i) {
             const auto e(mock_exception(i, r.name(), mod_n));
-            r.objects().insert(std::make_pair(e->name(), e));
+            insert_object(r, e);
         }
         break;
     default:
@@ -396,14 +433,14 @@ object_with_property(const object_types ot, const property_types pt) {
         BOOST_LOG_SEV(lg, error) << invalid_object_type;
         BOOST_THROW_EXCEPTION(building_error(invalid_object_type));
     }
-    o0->properties().push_back(p);
+    o0->all_properties().push_back(p);
+    o0->local_properties().push_back(p);
 
     model r(build_empty_model(0));
-
-    r.objects().insert(std::make_pair(o0->name(), o0));
+    insert_object(r, o0);
     if (pt == property_types::value_object ||
         pt == property_types::boost_shared_ptr)
-        r.objects().insert(std::make_pair(o1->name(), o1));
+        insert_object(r, o1);
 
     if (pt == property_types::unsigned_int ||
         pt == property_types::boolean) {
@@ -418,7 +455,7 @@ object_with_property(const object_types ot, const property_types pt) {
         boost::shared_ptr<value_object> o2(new value_object());
         o2->name(qn);
         o2->type(dogen::sml::value_object_types::smart_pointer);
-        r.objects().insert(std::make_pair(o2->name(), o2));
+        insert_object(r, o2);
     } else if (pt == property_types::std_pair) {
 
         sml::primitive b;
@@ -432,7 +469,7 @@ object_with_property(const object_types ot, const property_types pt) {
         boost::shared_ptr<value_object> o2(new value_object());
         o2->name(qn);
         o2->type(sml::value_object_types::plain);
-        r.objects().insert(std::make_pair(o2->name(), o2));
+        insert_object(r, o2);
     } else if (pt == property_types::boost_variant) {
         sml::primitive b;
         b.name().simple_name(boolean);
@@ -449,7 +486,7 @@ object_with_property(const object_types ot, const property_types pt) {
         boost::shared_ptr<value_object> o2(new value_object());
         o2->name(qn);
         o2->type(sml::value_object_types::plain);
-        r.objects().insert(std::make_pair(o2->name(), o2));
+        insert_object(r, o2);
     } else if (pt == property_types::std_string) {
         dogen::sml::qname qn;
         qn.simple_name("string");
@@ -458,7 +495,7 @@ object_with_property(const object_types ot, const property_types pt) {
         boost::shared_ptr<value_object> o2(new value_object());
         o2->name(qn);
         o2->type(sml::value_object_types::plain);
-        r.objects().insert(std::make_pair(o2->name(), o2));
+        insert_object(r, o2);
     }
 
     return r;
@@ -472,21 +509,22 @@ mock_model_factory::object_with_property_type_in_different_model() {
     property p;
     p.name(property_name(0));
     p.type(mock_qname(*o1));
-    o0->properties().push_back(p);
+    o0->all_properties().push_back(p);
+    o0->local_properties().push_back(p);
 
     qname m0_qn;
     m0_qn.model_name(model_name(0));
 
     model m0;
     m0.name(m0_qn);
-    m0.objects().insert(std::make_pair(o0->name(), o0));
+    insert_object(m0, o0);
 
     qname m1_qn;
     m1_qn.model_name(model_name(1));
 
     model m1;
     m1.name(m1_qn);
-    m1.objects().insert(std::make_pair(o1->name(), o1));
+    insert_object(m1, o1);
 
     return std::array<model, 2> {{ m0, m1 }};
 }
@@ -498,13 +536,14 @@ model mock_model_factory::object_with_missing_property_type() {
     property p;
     p.name(property_name(0));
     p.type(mock_qname(*o1));
-    o0->properties().push_back(p);
+    o0->all_properties().push_back(p);
+    o0->local_properties().push_back(p);
 
     qname mn_qn;
     mn_qn.model_name(model_name(0));
 
     model r(build_empty_model(0));
-    r.objects().insert(std::make_pair(o0->name(), o0));
+    insert_object(r, o0);
 
     return r;
 }
@@ -519,7 +558,8 @@ object_with_parent_in_the_same_model(bool add_property) {
         property p;
         p.name(property_name(0));
         p.type(mock_nested_qname(property_types::unsigned_int));
-        o0->properties().push_back(p);
+        o0->all_properties().push_back(p);
+        o0->local_properties().push_back(p);
 
         sml::primitive ui;
         ui.name(p.type().type());
@@ -531,16 +571,13 @@ object_with_parent_in_the_same_model(bool add_property) {
         property p;
         p.name(property_name(1));
         p.type(mock_nested_qname(property_types::unsigned_int));
-        o1->properties().push_back(p);
+        o1->all_properties().push_back(p);
+        o1->local_properties().push_back(p);
     }
 
-    o0->parent_name(o1->name());
-    o0->original_parent_name(o1->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
-
-    r.objects().insert(std::make_pair(o0->name(), o0));
-    r.objects().insert(std::make_pair(o1->name(), o1));
+    parent_to_child(*o1, *o0);
+    insert_object(r, o0);
+    insert_object(r, o1);
 
     return r;
 }
@@ -549,13 +586,10 @@ model mock_model_factory::object_with_missing_child_in_the_same_model() {
     const auto mn(mock_model_qname(0));
     auto o0(mock_value_object(0, mn));
     auto o1(mock_value_object(1, mn));
-    o0->parent_name(o1->name());
-    o0->original_parent_name(o1->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
 
+    parent_to_child(*o1, *o0);
     model r(build_empty_model(0));
-    r.objects().insert(std::make_pair(o1->name(), o1));
+    insert_object(r, o1);
 
     return r;
 }
@@ -564,16 +598,13 @@ std::array<model, 2> mock_model_factory::
 object_with_parent_in_different_models() {
     auto o0(mock_value_object(0));
     auto o1(mock_value_object(1));
-    o0->original_parent_name(o1->name());
-    o0->parent_name(o1->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
+    parent_to_child(*o1, *o0);
 
     model m0(build_empty_model(0));
-    m0.objects().insert(std::make_pair(o0->name(), o0));
+    insert_object(m0, o0);
 
     model m1(build_empty_model(1));
-    m1.objects().insert(std::make_pair(o1->name(), o1));
+    insert_object(m1, o1);
     m1.name(mock_model_qname(1));
     m1.origin_type(origin_types::user);
 
@@ -587,28 +618,17 @@ model mock_model_factory::object_with_three_children_in_same_model() {
     auto o2(mock_value_object(2, mn));
     auto o3(mock_value_object(3, mn));
 
-    o0->parent_name(o3->name());
-    o0->original_parent_name(o3->name());
-
-    o1->parent_name(o3->name());
-    o1->original_parent_name(o3->name());
-
-    o2->parent_name(o3->name());
-    o2->original_parent_name(o3->name());
-
-    o3->is_parent(true);
-    o3->leaves().push_back(o0->name());
-    o3->leaves().push_back(o1->name());
-    o3->leaves().push_back(o2->name());
+    parent_to_child(*o3, *o0);
+    parent_to_child(*o3, *o1);
+    parent_to_child(*o3, *o2);
 
     model r(build_empty_model(0));
-    r.objects().insert(std::make_pair(o0->name(), o0));
-    r.objects().insert(std::make_pair(o1->name(), o1));
-    r.objects().insert(std::make_pair(o2->name(), o2));
-    r.objects().insert(std::make_pair(o3->name(), o3));
+    insert_object(r, o0);
+    insert_object(r, o1);
+    insert_object(r, o2);
+    insert_object(r, o3);
     r.name(mn);
     return r;
-
 }
 
 model mock_model_factory::
@@ -622,7 +642,8 @@ object_with_third_degree_parent_in_same_model(bool add_property) {
         property p;
         p.name(property_name(0));
         p.type(mock_nested_qname(property_types::unsigned_int));
-        o0->properties().push_back(p);
+        o0->all_properties().push_back(p);
+        o0->local_properties().push_back(p);
 
         sml::primitive ui;
         ui.name(p.type().type());
@@ -634,7 +655,8 @@ object_with_third_degree_parent_in_same_model(bool add_property) {
         property p;
         p.name(property_name(1));
         p.type(mock_nested_qname(property_types::unsigned_int));
-        o1->properties().push_back(p);
+        o1->all_properties().push_back(p);
+        o1->local_properties().push_back(p);
     }
 
     auto o2(mock_value_object(2, mn));
@@ -642,7 +664,8 @@ object_with_third_degree_parent_in_same_model(bool add_property) {
         property p;
         p.name(property_name(2));
         p.type(mock_nested_qname(property_types::unsigned_int));
-        o2->properties().push_back(p);
+        o2->all_properties().push_back(p);
+        o2->local_properties().push_back(p);
     }
 
     auto o3(mock_value_object(3, mn));
@@ -650,29 +673,19 @@ object_with_third_degree_parent_in_same_model(bool add_property) {
         property p;
         p.name(property_name(3));
         p.type(mock_nested_qname(property_types::unsigned_int));
-        o3->properties().push_back(p);
+        o3->all_properties().push_back(p);
+        o3->local_properties().push_back(p);
     }
 
-    o0->parent_name(o1->name());
-    o0->original_parent_name(o3->name());
-
-    o1->parent_name(o2->name());
-    o1->original_parent_name(o3->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
+    parent_to_child(*o1, *o0, *o3, !add_leaf);
+    parent_to_child(*o2, *o1, *o3, !add_leaf);
+    parent_to_child(*o3, *o2, *o3, !add_leaf);
+    add_relationship(*o3, *o0, relationship_types::leaves);
 
-    o2->parent_name(o3->name());
-    o2->original_parent_name(o3->name());
-    o2->is_parent(true);
-    o2->leaves().push_back(o0->name());
-
-    o3->leaves().push_back(o0->name());
-    o3->is_parent(true);
-
-    r.objects().insert(std::make_pair(o0->name(), o0));
-    r.objects().insert(std::make_pair(o1->name(), o1));
-    r.objects().insert(std::make_pair(o2->name(), o2));
-    r.objects().insert(std::make_pair(o3->name(), o3));
+    insert_object(r, o0);
+    insert_object(r, o1);
+    insert_object(r, o2);
+    insert_object(r, o3);
 
     return r;
 }
@@ -684,26 +697,15 @@ model mock_model_factory::object_with_third_degree_parent_missing() {
     auto o2(mock_value_object(2, mn));
     auto o3(mock_value_object(3, mn));
 
-    o0->parent_name(o1->name());
-    o0->original_parent_name(o3->name());
-
-    o1->parent_name(o2->name());
-    o1->original_parent_name(o3->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
-
-    o2->parent_name(o3->name());
-    o2->original_parent_name(o3->name());
-    o2->is_parent(true);
-    o2->leaves().push_back(o0->name());
-
-    o3->is_parent(true);
-    o3->leaves().push_back(o0->name());
+    parent_to_child(*o1, *o0, *o3, !add_leaf);
+    parent_to_child(*o2, *o1, *o3, !add_leaf);
+    parent_to_child(*o3, *o2, *o3, !add_leaf);
+    add_relationship(*o3, *o0, relationship_types::leaves);
 
     model r(build_empty_model(0));
-    r.objects().insert(std::make_pair(o0->name(), o0));
-    r.objects().insert(std::make_pair(o1->name(), o1));
-    r.objects().insert(std::make_pair(o2->name(), o2));
+    insert_object(r, o0);
+    insert_object(r, o1);
+    insert_object(r, o2);
     r.name(mn);
     return r;
 }
@@ -715,33 +717,22 @@ mock_model_factory::object_with_third_degree_parent_in_different_models() {
     auto o2(mock_value_object(2));
     auto o3(mock_value_object(3));
 
-    o0->parent_name(o1->name());
-    o0->original_parent_name(o3->name());
-
-    o1->parent_name(o2->name());
-    o1->original_parent_name(o3->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
-
-    o2->parent_name(o3->name());
-    o2->original_parent_name(o3->name());
-    o2->is_parent(true);
-    o2->leaves().push_back(o0->name());
-
-    o3->is_parent(true);
-    o3->leaves().push_back(o0->name());
+    parent_to_child(*o1, *o0, *o3, !add_leaf);
+    parent_to_child(*o2, *o1, *o3, !add_leaf);
+    parent_to_child(*o3, *o2, *o3, !add_leaf);
+    add_relationship(*o3, *o0, relationship_types::leaves);
 
     model m0(build_empty_model(0));
-    m0.objects().insert(std::make_pair(o0->name(), o0));
+    insert_object(m0, o0);
 
     model m1(build_empty_model(1));
-    m1.objects().insert(std::make_pair(o1->name(), o1));
+    insert_object(m1, o1);
 
     model m2(build_empty_model(2));
-    m2.objects().insert(std::make_pair(o2->name(), o2));
+    insert_object(m2, o2);
 
     model m3(build_empty_model(3));
-    m3.objects().insert(std::make_pair(o3->name(), o3));
+    insert_object(m3, o3);
 
     return std::array<model, 4>{{ m0, m1, m2, m3 }};
 }
@@ -753,30 +744,19 @@ object_with_missing_third_degree_parent_in_different_models() {
     auto o2(mock_value_object(2));
     auto o3(mock_value_object(3));
 
-    o0->parent_name(o1->name());
-    o0->original_parent_name(o3->name());
-
-    o1->parent_name(o2->name());
-    o1->original_parent_name(o3->name());
-    o1->is_parent(true);
-    o1->leaves().push_back(o0->name());
-
-    o2->parent_name(o3->name());
-    o2->original_parent_name(o3->name());
-    o2->is_parent(true);
-    o2->leaves().push_back(o0->name());
-
-    o3->is_parent(true);
-    o3->leaves().push_back(o0->name());
+    parent_to_child(*o1, *o0, *o3, !add_leaf);
+    parent_to_child(*o2, *o1, *o3, !add_leaf);
+    parent_to_child(*o3, *o2, *o3, !add_leaf);
+    add_relationship(*o3, *o0, relationship_types::leaves);
 
     model m0(build_empty_model(0));
-    m0.objects().insert(std::make_pair(o0->name(), o0));
+    insert_object(m0, o0);
 
     model m1(build_empty_model(1));
-    m1.objects().insert(std::make_pair(o1->name(), o1));
+    insert_object(m1, o1);
 
     model m2(build_empty_model(2));
-    m2.objects().insert(std::make_pair(o2->name(), o2));
+    insert_object(m2, o2);
 
     return std::array<model, 4>{{ m0, m1, m2 }};
 }
diff --git a/projects/sml/src/test_data/abstract_object_td.cpp b/projects/sml/src/test_data/abstract_object_td.cpp
index 7620af0..9c3a72d 100644
--- a/projects/sml/src/test_data/abstract_object_td.cpp
+++ b/projects/sml/src/test_data/abstract_object_td.cpp
@@ -28,6 +28,7 @@
 #include "dogen/sml/test_data/origin_types_td.hpp"
 #include "dogen/sml/test_data/property_td.hpp"
 #include "dogen/sml/test_data/qname_td.hpp"
+#include "dogen/sml/test_data/relationship_types_td.hpp"
 #include "dogen/sml/test_data/repository_td.hpp"
 #include "dogen/sml/test_data/service_td.hpp"
 #include "dogen/sml/test_data/type_td.hpp"
@@ -48,6 +49,19 @@ std::list<dogen::sml::property> create_std_list_dogen_sml_property(unsigned int
     return r;
 }
 
+dogen::sml::qname
+create_dogen_sml_qname(const unsigned int position) {
+    return dogen::sml::qname_generator::create(position);
+}
+
+std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> > create_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(unsigned int position) {
+    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> > r;
+    for (unsigned int i(0); i < 4; ++i) {
+        r.insert(std::make_pair(create_dogen_sml_qname(position + i), create_std_list_dogen_sml_property(position + i)));
+    }
+    return r;
+}
+
 dogen::sml::operation
 create_dogen_sml_operation(const unsigned int position) {
     return dogen::sml::operation_generator::create(position);
@@ -61,16 +75,9 @@ std::list<dogen::sml::operation> create_std_list_dogen_sml_operation(unsigned in
     return r;
 }
 
-dogen::sml::qname
-create_dogen_sml_qname(const unsigned int position) {
-    return dogen::sml::qname_generator::create(position);
-}
-
-boost::optional<dogen::sml::qname>
-create_boost_optional_dogen_sml_qname(unsigned int position) {
-    boost::optional<dogen::sml::qname> r(
-        create_dogen_sml_qname(position));
-    return r;
+dogen::sml::relationship_types
+create_dogen_sml_relationship_types(const unsigned int position) {
+    return dogen::sml::relationship_types_generator::create(position);
 }
 
 std::list<dogen::sml::qname> create_std_list_dogen_sml_qname(unsigned int position) {
@@ -81,14 +88,22 @@ std::list<dogen::sml::qname> create_std_list_dogen_sml_qname(unsigned int positi
     return r;
 }
 
-bool create_bool(const unsigned int position) {
-    return (position % 2) == 0;
+std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> > create_std_unordered_map_dogen_sml_relationship_types_std_list_dogen_sml_qname_(unsigned int position) {
+    std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> > r;
+    for (unsigned int i(0); i < 4; ++i) {
+        r.insert(std::make_pair(create_dogen_sml_relationship_types(position + i), create_std_list_dogen_sml_qname(position + i)));
+    }
+    return r;
 }
 
 unsigned int create_unsigned_int(const unsigned int position) {
     return static_cast<unsigned int>(position);
 }
 
+bool create_bool(const unsigned int position) {
+    return (position % 2) == 0;
+}
+
 }
 
 namespace dogen {
@@ -98,19 +113,20 @@ namespace sml {
 void abstract_object_generator::
 populate(const unsigned int position, result_type& v) {
     dogen::sml::type_generator::populate(position, v);
-    v.properties(create_std_list_dogen_sml_property(position + 0));
-    v.operations(create_std_list_dogen_sml_operation(position + 1));
-    v.parent_name(create_boost_optional_dogen_sml_qname(position + 2));
-    v.original_parent_name(create_boost_optional_dogen_sml_qname(position + 3));
-    v.leaves(create_std_list_dogen_sml_qname(position + 4));
-    v.is_parent(create_bool(position + 5));
-    v.number_of_type_arguments(create_unsigned_int(position + 6));
-    v.is_visitable(create_bool(position + 7));
-    v.is_immutable(create_bool(position + 8));
-    v.is_versioned(create_bool(position + 9));
-    v.is_comparable(create_bool(position + 10));
-    v.is_fluent(create_bool(position + 11));
-    v.modeled_concepts(create_std_list_dogen_sml_qname(position + 12));
+    v.all_properties(create_std_list_dogen_sml_property(position + 0));
+    v.local_properties(create_std_list_dogen_sml_property(position + 1));
+    v.inherited_properties(create_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(position + 2));
+    v.operations(create_std_list_dogen_sml_operation(position + 3));
+    v.relationships(create_std_unordered_map_dogen_sml_relationship_types_std_list_dogen_sml_qname_(position + 4));
+    v.number_of_type_arguments(create_unsigned_int(position + 5));
+    v.is_parent(create_bool(position + 6));
+    v.is_child(create_bool(position + 7));
+    v.is_visitable(create_bool(position + 8));
+    v.is_inheritance_root(create_bool(position + 9));
+    v.is_immutable(create_bool(position + 10));
+    v.is_versioned(create_bool(position + 11));
+    v.is_comparable(create_bool(position + 12));
+    v.is_fluent(create_bool(position + 13));
 }
 
 abstract_object_generator::result_type*
diff --git a/projects/sml/src/test_data/concept_td.cpp b/projects/sml/src/test_data/concept_td.cpp
index 63d6a2a..112fbc7 100644
--- a/projects/sml/src/test_data/concept_td.cpp
+++ b/projects/sml/src/test_data/concept_td.cpp
@@ -41,6 +41,19 @@ std::list<dogen::sml::property> create_std_list_dogen_sml_property(unsigned int
     return r;
 }
 
+dogen::sml::qname
+create_dogen_sml_qname(const unsigned int position) {
+    return dogen::sml::qname_generator::create(position);
+}
+
+std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> > create_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(unsigned int position) {
+    std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> > r;
+    for (unsigned int i(0); i < 4; ++i) {
+        r.insert(std::make_pair(create_dogen_sml_qname(position + i), create_std_list_dogen_sml_property(position + i)));
+    }
+    return r;
+}
+
 std::string create_std_string(const unsigned int position) {
     std::ostringstream s;
     s << "a_string_" << position;
@@ -57,11 +70,6 @@ create_boost_property_tree_ptree(const unsigned int position) {
     return r;
 }
 
-dogen::sml::qname
-create_dogen_sml_qname(const unsigned int position) {
-    return dogen::sml::qname_generator::create(position);
-}
-
 dogen::sml::generation_types
 create_dogen_sml_generation_types(const unsigned int position) {
     return dogen::sml::generation_types_generator::create(position);
@@ -102,14 +110,16 @@ concept_generator::concept_generator() : position_(0) { }
 
 void concept_generator::
 populate(const unsigned int position, result_type& v) {
-    v.properties(create_std_list_dogen_sml_property(position + 0));
-    v.documentation(create_std_string(position + 1));
-    v.meta_data(create_boost_property_tree_ptree(position + 2));
-    v.name(create_dogen_sml_qname(position + 3));
-    v.generation_type(create_dogen_sml_generation_types(position + 4));
-    v.origin_type(create_dogen_sml_origin_types(position + 5));
-    v.operations(create_std_list_dogen_sml_operation(position + 6));
-    v.refines(create_std_list_dogen_sml_qname(position + 7));
+    v.all_properties(create_std_list_dogen_sml_property(position + 0));
+    v.local_properties(create_std_list_dogen_sml_property(position + 1));
+    v.inherited_properties(create_std_unordered_map_dogen_sml_qname_std_list_dogen_sml_property_(position + 2));
+    v.documentation(create_std_string(position + 3));
+    v.meta_data(create_boost_property_tree_ptree(position + 4));
+    v.name(create_dogen_sml_qname(position + 5));
+    v.generation_type(create_dogen_sml_generation_types(position + 6));
+    v.origin_type(create_dogen_sml_origin_types(position + 7));
+    v.operations(create_std_list_dogen_sml_operation(position + 8));
+    v.refines(create_std_list_dogen_sml_qname(position + 9));
 }
 
 concept_generator::result_type
diff --git a/projects/sml/src/test_data/relationship_types_td.cpp b/projects/sml/src/test_data/relationship_types_td.cpp
new file mode 100644
index 0000000..1c5aeeb
--- /dev/null
+++ b/projects/sml/src/test_data/relationship_types_td.cpp
@@ -0,0 +1,44 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#include "dogen/sml/test_data/relationship_types_td.hpp"
+
+namespace dogen {
+namespace sml {
+
+relationship_types_generator::relationship_types_generator() : position_(0) { }
+void relationship_types_generator::
+populate(const unsigned int position, result_type& v) {
+    v = static_cast<relationship_types>(position % 9);
+}
+
+relationship_types_generator::result_type
+relationship_types_generator::create(const unsigned int  position) {
+    result_type r;
+    relationship_types_generator::populate(position, r);
+    return r;
+}
+
+relationship_types_generator::result_type
+relationship_types_generator::operator()() {
+    return create(position_++);
+}
+
+} }
\ No newline at end of file
diff --git a/projects/sml/src/types/abstract_entity.cpp b/projects/sml/src/types/abstract_entity.cpp
index 3a8a71f..8ccf788 100644
--- a/projects/sml/src/types/abstract_entity.cpp
+++ b/projects/sml/src/types/abstract_entity.cpp
@@ -50,19 +50,20 @@ abstract_entity::abstract_entity(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
     const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts,
     const bool is_aggregate_root,
     const std::list<dogen::sml::property>& identity)
     : dogen::sml::abstract_object(documentation,
@@ -70,19 +71,20 @@ abstract_entity::abstract_entity(
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
-      is_fluent,
-      modeled_concepts),
+      is_fluent),
       is_aggregate_root_(is_aggregate_root),
       identity_(identity) { }
 
diff --git a/projects/sml/src/types/abstract_object.cpp b/projects/sml/src/types/abstract_object.cpp
index 5c22ed9..8e78f6b 100644
--- a/projects/sml/src/types/abstract_object.cpp
+++ b/projects/sml/src/types/abstract_object.cpp
@@ -27,6 +27,7 @@
 #include "dogen/sml/io/origin_types_io.hpp"
 #include "dogen/sml/io/property_io.hpp"
 #include "dogen/sml/io/qname_io.hpp"
+#include "dogen/sml/io/relationship_types_io.hpp"
 #include "dogen/sml/io/type_io.hpp"
 #include "dogen/sml/types/abstract_object.hpp"
 
@@ -46,28 +47,31 @@ inline std::ostream& operator<<(std::ostream& s, const std::list<dogen::sml::pro
 
 namespace std {
 
-inline std::ostream& operator<<(std::ostream& s, const std::list<dogen::sml::operation>& v) {
-    s << "[ ";
+inline std::ostream& operator<<(std::ostream& s, const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v) {
+    s << "[";
     for (auto i(v.begin()); i != v.end(); ++i) {
         if (i != v.begin()) s << ", ";
-        s << *i;
+        s << "[ { " << "\"__type__\": " << "\"key\"" << ", " << "\"data\": ";
+        s << i->first;
+        s << " }, { " << "\"__type__\": " << "\"value\"" << ", " << "\"data\": ";
+        s << i->second;
+        s << " } ]";
     }
-    s << "] ";
+    s << " ] ";
     return s;
 }
 
 }
 
-namespace boost {
-
-inline std::ostream& operator<<(std::ostream& s, const boost::optional<dogen::sml::qname>& v) {
-    s << "{ " << "\"__type__\": " << "\"boost::optional\"" << ", ";
+namespace std {
 
-    if (v)
-        s << "\"data\": " << *v;
-    else
-        s << "\"data\": ""\"<empty>\"";
-    s << " }";
+inline std::ostream& operator<<(std::ostream& s, const std::list<dogen::sml::operation>& v) {
+    s << "[ ";
+    for (auto i(v.begin()); i != v.end(); ++i) {
+        if (i != v.begin()) s << ", ";
+        s << *i;
+    }
+    s << "] ";
     return s;
 }
 
@@ -87,72 +91,77 @@ inline std::ostream& operator<<(std::ostream& s, const std::list<dogen::sml::qna
 
 }
 
+namespace std {
+
+inline std::ostream& operator<<(std::ostream& s, const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& v) {
+    s << "[";
+    for (auto i(v.begin()); i != v.end(); ++i) {
+        if (i != v.begin()) s << ", ";
+        s << "[ { " << "\"__type__\": " << "\"key\"" << ", " << "\"data\": ";
+        s << i->first;
+        s << " }, { " << "\"__type__\": " << "\"value\"" << ", " << "\"data\": ";
+        s << i->second;
+        s << " } ]";
+    }
+    s << " ] ";
+    return s;
+}
+
+}
+
 namespace dogen {
 namespace sml {
 
 abstract_object::abstract_object()
-    : is_parent_(static_cast<bool>(0)),
-      number_of_type_arguments_(static_cast<unsigned int>(0)),
+    : number_of_type_arguments_(static_cast<unsigned int>(0)),
+      is_parent_(static_cast<bool>(0)),
+      is_child_(static_cast<bool>(0)),
       is_visitable_(static_cast<bool>(0)),
+      is_inheritance_root_(static_cast<bool>(0)),
       is_immutable_(static_cast<bool>(0)),
       is_versioned_(static_cast<bool>(0)),
       is_comparable_(static_cast<bool>(0)),
       is_fluent_(static_cast<bool>(0)) { }
 
-abstract_object::abstract_object(abstract_object&& rhs)
-    : dogen::sml::type(
-        std::forward<dogen::sml::type>(rhs)),
-      properties_(std::move(rhs.properties_)),
-      operations_(std::move(rhs.operations_)),
-      parent_name_(std::move(rhs.parent_name_)),
-      original_parent_name_(std::move(rhs.original_parent_name_)),
-      leaves_(std::move(rhs.leaves_)),
-      is_parent_(std::move(rhs.is_parent_)),
-      number_of_type_arguments_(std::move(rhs.number_of_type_arguments_)),
-      is_visitable_(std::move(rhs.is_visitable_)),
-      is_immutable_(std::move(rhs.is_immutable_)),
-      is_versioned_(std::move(rhs.is_versioned_)),
-      is_comparable_(std::move(rhs.is_comparable_)),
-      is_fluent_(std::move(rhs.is_fluent_)),
-      modeled_concepts_(std::move(rhs.modeled_concepts_)) { }
-
 abstract_object::abstract_object(
     const std::string& documentation,
     const boost::property_tree::ptree& meta_data,
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
-    const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts)
+    const bool is_fluent)
     : dogen::sml::type(documentation,
       meta_data,
       name,
       generation_type,
       origin_type),
-      properties_(properties),
+      all_properties_(all_properties),
+      local_properties_(local_properties),
+      inherited_properties_(inherited_properties),
       operations_(operations),
-      parent_name_(parent_name),
-      original_parent_name_(original_parent_name),
-      leaves_(leaves),
-      is_parent_(is_parent),
+      relationships_(relationships),
       number_of_type_arguments_(number_of_type_arguments),
+      is_parent_(is_parent),
+      is_child_(is_child),
       is_visitable_(is_visitable),
+      is_inheritance_root_(is_inheritance_root),
       is_immutable_(is_immutable),
       is_versioned_(is_versioned),
       is_comparable_(is_comparable),
-      is_fluent_(is_fluent),
-      modeled_concepts_(modeled_concepts) { }
+      is_fluent_(is_fluent) { }
 
 void abstract_object::to_stream(std::ostream& s) const {
     boost::io::ios_flags_saver ifs(s);
@@ -166,19 +175,20 @@ void abstract_object::to_stream(std::ostream& s) const {
       << "\"__parent_0__\": ";
     type::to_stream(s);
     s << ", "
-      << "\"properties\": " << properties_ << ", "
+      << "\"all_properties\": " << all_properties_ << ", "
+      << "\"local_properties\": " << local_properties_ << ", "
+      << "\"inherited_properties\": " << inherited_properties_ << ", "
       << "\"operations\": " << operations_ << ", "
-      << "\"parent_name\": " << parent_name_ << ", "
-      << "\"original_parent_name\": " << original_parent_name_ << ", "
-      << "\"leaves\": " << leaves_ << ", "
-      << "\"is_parent\": " << is_parent_ << ", "
+      << "\"relationships\": " << relationships_ << ", "
       << "\"number_of_type_arguments\": " << number_of_type_arguments_ << ", "
+      << "\"is_parent\": " << is_parent_ << ", "
+      << "\"is_child\": " << is_child_ << ", "
       << "\"is_visitable\": " << is_visitable_ << ", "
+      << "\"is_inheritance_root\": " << is_inheritance_root_ << ", "
       << "\"is_immutable\": " << is_immutable_ << ", "
       << "\"is_versioned\": " << is_versioned_ << ", "
       << "\"is_comparable\": " << is_comparable_ << ", "
-      << "\"is_fluent\": " << is_fluent_ << ", "
-      << "\"modeled_concepts\": " << modeled_concepts_
+      << "\"is_fluent\": " << is_fluent_
       << " }";
 }
 
@@ -186,116 +196,126 @@ void abstract_object::swap(abstract_object& other) noexcept {
     type::swap(other);
 
     using std::swap;
-    swap(properties_, other.properties_);
+    swap(all_properties_, other.all_properties_);
+    swap(local_properties_, other.local_properties_);
+    swap(inherited_properties_, other.inherited_properties_);
     swap(operations_, other.operations_);
-    swap(parent_name_, other.parent_name_);
-    swap(original_parent_name_, other.original_parent_name_);
-    swap(leaves_, other.leaves_);
-    swap(is_parent_, other.is_parent_);
+    swap(relationships_, other.relationships_);
     swap(number_of_type_arguments_, other.number_of_type_arguments_);
+    swap(is_parent_, other.is_parent_);
+    swap(is_child_, other.is_child_);
     swap(is_visitable_, other.is_visitable_);
+    swap(is_inheritance_root_, other.is_inheritance_root_);
     swap(is_immutable_, other.is_immutable_);
     swap(is_versioned_, other.is_versioned_);
     swap(is_comparable_, other.is_comparable_);
     swap(is_fluent_, other.is_fluent_);
-    swap(modeled_concepts_, other.modeled_concepts_);
 }
 
 bool abstract_object::compare(const abstract_object& rhs) const {
     return type::compare(rhs) &&
-        properties_ == rhs.properties_ &&
+        all_properties_ == rhs.all_properties_ &&
+        local_properties_ == rhs.local_properties_ &&
+        inherited_properties_ == rhs.inherited_properties_ &&
         operations_ == rhs.operations_ &&
-        parent_name_ == rhs.parent_name_ &&
-        original_parent_name_ == rhs.original_parent_name_ &&
-        leaves_ == rhs.leaves_ &&
-        is_parent_ == rhs.is_parent_ &&
+        relationships_ == rhs.relationships_ &&
         number_of_type_arguments_ == rhs.number_of_type_arguments_ &&
+        is_parent_ == rhs.is_parent_ &&
+        is_child_ == rhs.is_child_ &&
         is_visitable_ == rhs.is_visitable_ &&
+        is_inheritance_root_ == rhs.is_inheritance_root_ &&
         is_immutable_ == rhs.is_immutable_ &&
         is_versioned_ == rhs.is_versioned_ &&
         is_comparable_ == rhs.is_comparable_ &&
-        is_fluent_ == rhs.is_fluent_ &&
-        modeled_concepts_ == rhs.modeled_concepts_;
+        is_fluent_ == rhs.is_fluent_;
 }
 
-const std::list<dogen::sml::property>& abstract_object::properties() const {
-    return properties_;
+const std::list<dogen::sml::property>& abstract_object::all_properties() const {
+    return all_properties_;
 }
 
-std::list<dogen::sml::property>& abstract_object::properties() {
-    return properties_;
+std::list<dogen::sml::property>& abstract_object::all_properties() {
+    return all_properties_;
 }
 
-void abstract_object::properties(const std::list<dogen::sml::property>& v) {
-    properties_ = v;
+void abstract_object::all_properties(const std::list<dogen::sml::property>& v) {
+    all_properties_ = v;
 }
 
-void abstract_object::properties(const std::list<dogen::sml::property>&& v) {
-    properties_ = std::move(v);
+void abstract_object::all_properties(const std::list<dogen::sml::property>&& v) {
+    all_properties_ = std::move(v);
 }
 
-const std::list<dogen::sml::operation>& abstract_object::operations() const {
-    return operations_;
+const std::list<dogen::sml::property>& abstract_object::local_properties() const {
+    return local_properties_;
 }
 
-std::list<dogen::sml::operation>& abstract_object::operations() {
-    return operations_;
+std::list<dogen::sml::property>& abstract_object::local_properties() {
+    return local_properties_;
 }
 
-void abstract_object::operations(const std::list<dogen::sml::operation>& v) {
-    operations_ = v;
+void abstract_object::local_properties(const std::list<dogen::sml::property>& v) {
+    local_properties_ = v;
 }
 
-void abstract_object::operations(const std::list<dogen::sml::operation>&& v) {
-    operations_ = std::move(v);
+void abstract_object::local_properties(const std::list<dogen::sml::property>&& v) {
+    local_properties_ = std::move(v);
 }
 
-const boost::optional<dogen::sml::qname>& abstract_object::parent_name() const {
-    return parent_name_;
+const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& abstract_object::inherited_properties() const {
+    return inherited_properties_;
 }
 
-boost::optional<dogen::sml::qname>& abstract_object::parent_name() {
-    return parent_name_;
+std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& abstract_object::inherited_properties() {
+    return inherited_properties_;
 }
 
-void abstract_object::parent_name(const boost::optional<dogen::sml::qname>& v) {
-    parent_name_ = v;
+void abstract_object::inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v) {
+    inherited_properties_ = v;
 }
 
-void abstract_object::parent_name(const boost::optional<dogen::sml::qname>&& v) {
-    parent_name_ = std::move(v);
+void abstract_object::inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >&& v) {
+    inherited_properties_ = std::move(v);
 }
 
-const boost::optional<dogen::sml::qname>& abstract_object::original_parent_name() const {
-    return original_parent_name_;
+const std::list<dogen::sml::operation>& abstract_object::operations() const {
+    return operations_;
 }
 
-boost::optional<dogen::sml::qname>& abstract_object::original_parent_name() {
-    return original_parent_name_;
+std::list<dogen::sml::operation>& abstract_object::operations() {
+    return operations_;
 }
 
-void abstract_object::original_parent_name(const boost::optional<dogen::sml::qname>& v) {
-    original_parent_name_ = v;
+void abstract_object::operations(const std::list<dogen::sml::operation>& v) {
+    operations_ = v;
 }
 
-void abstract_object::original_parent_name(const boost::optional<dogen::sml::qname>&& v) {
-    original_parent_name_ = std::move(v);
+void abstract_object::operations(const std::list<dogen::sml::operation>&& v) {
+    operations_ = std::move(v);
 }
 
-const std::list<dogen::sml::qname>& abstract_object::leaves() const {
-    return leaves_;
+const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& abstract_object::relationships() const {
+    return relationships_;
 }
 
-std::list<dogen::sml::qname>& abstract_object::leaves() {
-    return leaves_;
+std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& abstract_object::relationships() {
+    return relationships_;
 }
 
-void abstract_object::leaves(const std::list<dogen::sml::qname>& v) {
-    leaves_ = v;
+void abstract_object::relationships(const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& v) {
+    relationships_ = v;
 }
 
-void abstract_object::leaves(const std::list<dogen::sml::qname>&& v) {
-    leaves_ = std::move(v);
+void abstract_object::relationships(const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >&& v) {
+    relationships_ = std::move(v);
+}
+
+unsigned int abstract_object::number_of_type_arguments() const {
+    return number_of_type_arguments_;
+}
+
+void abstract_object::number_of_type_arguments(const unsigned int v) {
+    number_of_type_arguments_ = v;
 }
 
 bool abstract_object::is_parent() const {
@@ -306,12 +326,12 @@ void abstract_object::is_parent(const bool v) {
     is_parent_ = v;
 }
 
-unsigned int abstract_object::number_of_type_arguments() const {
-    return number_of_type_arguments_;
+bool abstract_object::is_child() const {
+    return is_child_;
 }
 
-void abstract_object::number_of_type_arguments(const unsigned int v) {
-    number_of_type_arguments_ = v;
+void abstract_object::is_child(const bool v) {
+    is_child_ = v;
 }
 
 bool abstract_object::is_visitable() const {
@@ -322,6 +342,14 @@ void abstract_object::is_visitable(const bool v) {
     is_visitable_ = v;
 }
 
+bool abstract_object::is_inheritance_root() const {
+    return is_inheritance_root_;
+}
+
+void abstract_object::is_inheritance_root(const bool v) {
+    is_inheritance_root_ = v;
+}
+
 bool abstract_object::is_immutable() const {
     return is_immutable_;
 }
@@ -354,20 +382,4 @@ void abstract_object::is_fluent(const bool v) {
     is_fluent_ = v;
 }
 
-const std::list<dogen::sml::qname>& abstract_object::modeled_concepts() const {
-    return modeled_concepts_;
-}
-
-std::list<dogen::sml::qname>& abstract_object::modeled_concepts() {
-    return modeled_concepts_;
-}
-
-void abstract_object::modeled_concepts(const std::list<dogen::sml::qname>& v) {
-    modeled_concepts_ = v;
-}
-
-void abstract_object::modeled_concepts(const std::list<dogen::sml::qname>&& v) {
-    modeled_concepts_ = std::move(v);
-}
-
 } }
\ No newline at end of file
diff --git a/projects/sml/src/types/association_traversal.cpp b/projects/sml/src/types/association_traversal.cpp
deleted file mode 100644
index bd4d04b..0000000
--- a/projects/sml/src/types/association_traversal.cpp
+++ /dev/null
@@ -1,2 +0,0 @@
-// dummy function to suppress ranlib warnings
-void association_traversal() { }
diff --git a/projects/sml/src/types/concept.cpp b/projects/sml/src/types/concept.cpp
index 37504e0..a70fadc 100644
--- a/projects/sml/src/types/concept.cpp
+++ b/projects/sml/src/types/concept.cpp
@@ -28,7 +28,9 @@ concept::concept()
       origin_type_(static_cast<dogen::sml::origin_types>(0)) { }
 
 concept::concept(concept&& rhs)
-    : properties_(std::move(rhs.properties_)),
+    : all_properties_(std::move(rhs.all_properties_)),
+      local_properties_(std::move(rhs.local_properties_)),
+      inherited_properties_(std::move(rhs.inherited_properties_)),
       documentation_(std::move(rhs.documentation_)),
       meta_data_(std::move(rhs.meta_data_)),
       name_(std::move(rhs.name_)),
@@ -38,7 +40,9 @@ concept::concept(concept&& rhs)
       refines_(std::move(rhs.refines_)) { }
 
 concept::concept(
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::string& documentation,
     const boost::property_tree::ptree& meta_data,
     const dogen::sml::qname& name,
@@ -46,7 +50,9 @@ concept::concept(
     const dogen::sml::origin_types& origin_type,
     const std::list<dogen::sml::operation>& operations,
     const std::list<dogen::sml::qname>& refines)
-    : properties_(properties),
+    : all_properties_(all_properties),
+      local_properties_(local_properties),
+      inherited_properties_(inherited_properties),
       documentation_(documentation),
       meta_data_(meta_data),
       name_(name),
@@ -57,7 +63,9 @@ concept::concept(
 
 void concept::swap(concept& other) noexcept {
     using std::swap;
-    swap(properties_, other.properties_);
+    swap(all_properties_, other.all_properties_);
+    swap(local_properties_, other.local_properties_);
+    swap(inherited_properties_, other.inherited_properties_);
     swap(documentation_, other.documentation_);
     swap(meta_data_, other.meta_data_);
     swap(name_, other.name_);
@@ -68,7 +76,9 @@ void concept::swap(concept& other) noexcept {
 }
 
 bool concept::operator==(const concept& rhs) const {
-    return properties_ == rhs.properties_ &&
+    return all_properties_ == rhs.all_properties_ &&
+        local_properties_ == rhs.local_properties_ &&
+        inherited_properties_ == rhs.inherited_properties_ &&
         documentation_ == rhs.documentation_ &&
         meta_data_ == rhs.meta_data_ &&
         name_ == rhs.name_ &&
@@ -84,20 +94,52 @@ concept& concept::operator=(concept other) {
     return *this;
 }
 
-const std::list<dogen::sml::property>& concept::properties() const {
-    return properties_;
+const std::list<dogen::sml::property>& concept::all_properties() const {
+    return all_properties_;
 }
 
-std::list<dogen::sml::property>& concept::properties() {
-    return properties_;
+std::list<dogen::sml::property>& concept::all_properties() {
+    return all_properties_;
 }
 
-void concept::properties(const std::list<dogen::sml::property>& v) {
-    properties_ = v;
+void concept::all_properties(const std::list<dogen::sml::property>& v) {
+    all_properties_ = v;
 }
 
-void concept::properties(const std::list<dogen::sml::property>&& v) {
-    properties_ = std::move(v);
+void concept::all_properties(const std::list<dogen::sml::property>&& v) {
+    all_properties_ = std::move(v);
+}
+
+const std::list<dogen::sml::property>& concept::local_properties() const {
+    return local_properties_;
+}
+
+std::list<dogen::sml::property>& concept::local_properties() {
+    return local_properties_;
+}
+
+void concept::local_properties(const std::list<dogen::sml::property>& v) {
+    local_properties_ = v;
+}
+
+void concept::local_properties(const std::list<dogen::sml::property>&& v) {
+    local_properties_ = std::move(v);
+}
+
+const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& concept::inherited_properties() const {
+    return inherited_properties_;
+}
+
+std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& concept::inherited_properties() {
+    return inherited_properties_;
+}
+
+void concept::inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& v) {
+    inherited_properties_ = v;
+}
+
+void concept::inherited_properties(const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >&& v) {
+    inherited_properties_ = std::move(v);
 }
 
 const std::string& concept::documentation() const {
diff --git a/projects/sml/src/types/entity.cpp b/projects/sml/src/types/entity.cpp
index 74ca0f4..8e349d9 100644
--- a/projects/sml/src/types/entity.cpp
+++ b/projects/sml/src/types/entity.cpp
@@ -31,19 +31,20 @@ entity::entity(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
     const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts,
     const bool is_aggregate_root,
     const std::list<dogen::sml::property>& identity)
     : dogen::sml::abstract_entity(documentation,
@@ -51,19 +52,20 @@ entity::entity(
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
       is_fluent,
-      modeled_concepts,
       is_aggregate_root,
       identity) { }
 
diff --git a/projects/sml/src/types/factory.cpp b/projects/sml/src/types/factory.cpp
index ac938c5..ecf9c82 100644
--- a/projects/sml/src/types/factory.cpp
+++ b/projects/sml/src/types/factory.cpp
@@ -31,37 +31,39 @@ factory::factory(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
-    const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts)
+    const bool is_fluent)
     : dogen::sml::abstract_object(documentation,
       meta_data,
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
-      is_fluent,
-      modeled_concepts) { }
+      is_fluent) { }
 
 void factory::to_stream(std::ostream& s) const {
     s << " { "
diff --git a/projects/sml/src/types/generalisation_traversal.cpp b/projects/sml/src/types/generalisation_traversal.cpp
deleted file mode 100644
index 0fa4cc3..0000000
--- a/projects/sml/src/types/generalisation_traversal.cpp
+++ /dev/null
@@ -1,2 +0,0 @@
-// dummy function to suppress ranlib warnings
-void generalisation_traversal() { }
diff --git a/projects/sml/src/types/indexer.cpp b/projects/sml/src/types/indexer.cpp
new file mode 100644
index 0000000..d51a9dd
--- /dev/null
+++ b/projects/sml/src/types/indexer.cpp
@@ -0,0 +1,74 @@
+/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
+ *
+ * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA.
+ *
+ */
+#include "dogen/utility/log/logger.hpp"
+#include "dogen/sml/io/qname_io.hpp"
+#include "dogen/sml/types/entity.hpp"
+#include "dogen/sml/types/enumeration.hpp"
+#include "dogen/sml/types/factory.hpp"
+#include "dogen/sml/types/keyed_entity.hpp"
+#include "dogen/sml/types/repository.hpp"
+#include "dogen/sml/types/service.hpp"
+#include "dogen/sml/types/value_object.hpp"
+#include "dogen/sml/types/indexer.hpp"
+
+using namespace dogen::utility::log;
+
+namespace {
+
+auto lg(logger_factory("sml.indexer"));
+
+}
+
+namespace dogen {
+namespace sml {
+
+void indexer::visit(enumeration& e) const {
+    // do nothing
+}
+
+void indexer::visit(service& s) const {
+    // do nothing
+}
+
+void indexer::visit(factory& f) const {
+    // do nothing
+}
+
+void indexer::visit(repository& r) const {
+    
+}
+
+void indexer::visit(value_object& vo) const {
+    
+}
+
+void indexer::visit(keyed_entity& ke) const {
+    
+}
+
+void indexer::visit(entity& e) const {
+    
+}
+
+void indexer::index(model& m) const {
+}
+
+} }
diff --git a/projects/sml/src/types/injector.cpp b/projects/sml/src/types/injector.cpp
index 49b9a69..5738e7b 100644
--- a/projects/sml/src/types/injector.cpp
+++ b/projects/sml/src/types/injector.cpp
@@ -118,8 +118,7 @@ boost::shared_ptr<abstract_object> injector::create_key(const qname& qn,
 
     const auto doc(versioned ? versioned_key_doc : unversioned_key_doc);
     r->documentation(doc + qn.simple_name());
-
-    r->properties(properties);
+    r->local_properties(properties);
 
     if (versioned)
         inject_version(*r);
@@ -239,8 +238,7 @@ void injector::inject_version(abstract_object& p) const {
     v.name(version_name);
     v.type(nqn);
     v.documentation(versioned_property_doc);
-
-    p.properties().push_back(v);
+    p.local_properties().push_back(v);
 }
 
 void injector::inject_version(model& m) const {
@@ -258,6 +256,13 @@ void injector::inject_version(model& m) const {
 
 boost::shared_ptr<abstract_object>
 injector::create_visitor(const abstract_object& ao) const {
+    const auto i(ao.relationships().find(relationship_types::leaves));
+    if (i == ao.relationships().end() || i->second.empty()) {
+        BOOST_LOG_SEV(lg, error) << zero_leaves << ao.name();
+        BOOST_THROW_EXCEPTION(injection_error(zero_leaves +
+                boost::lexical_cast<std::string>(ao.name())));
+    }
+    const auto& leaves(i->second);
     auto r(boost::make_shared<service>());
     qname qn;
     qn.simple_name(ao.name().simple_name() + "_" + visitor_name);
@@ -273,7 +278,8 @@ injector::create_visitor(const abstract_object& ao) const {
     r->type(service_types::visitor);
     r->documentation(visitor_doc + ao.name().simple_name());
 
-    for (const auto& l : ao.leaves()) {
+
+    for (const auto& l : leaves) {
         parameter p;
         p.name(visitor_argument_name);
 
@@ -314,16 +320,11 @@ void injector::inject_visitors(model& m) const {
     std::list<boost::shared_ptr<abstract_object> > visitors;
     for (auto& pair : m.objects()) {
         auto& ao(*pair.second);
+        const bool needs_visitor(ao.is_visitable() && ao.is_inheritance_root());
 
-        if (!ao.is_visitable())
+        if (!needs_visitor)
             continue;
 
-        if (ao.leaves().empty()) {
-            BOOST_LOG_SEV(lg, error) << zero_leaves << ao.name();
-            BOOST_THROW_EXCEPTION(injection_error(zero_leaves +
-                    boost::lexical_cast<std::string>(ao.name())));
-        }
-
         const auto v(create_visitor(ao));
         visitors.push_back(v);
         inject_accept(ao, *v);
diff --git a/projects/sml/src/types/keyed_entity.cpp b/projects/sml/src/types/keyed_entity.cpp
index 7be5453..f9023c6 100644
--- a/projects/sml/src/types/keyed_entity.cpp
+++ b/projects/sml/src/types/keyed_entity.cpp
@@ -53,19 +53,20 @@ keyed_entity::keyed_entity(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
     const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts,
     const bool is_aggregate_root,
     const std::list<dogen::sml::property>& identity,
     const dogen::sml::qname& unversioned_key,
@@ -75,19 +76,20 @@ keyed_entity::keyed_entity(
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
       is_fluent,
-      modeled_concepts,
       is_aggregate_root,
       identity),
       unversioned_key_(unversioned_key),
diff --git a/projects/sml/src/types/merger.cpp b/projects/sml/src/types/merger.cpp
index b7b9359..6b0aa71 100644
--- a/projects/sml/src/types/merger.cpp
+++ b/projects/sml/src/types/merger.cpp
@@ -25,7 +25,6 @@
 #include "dogen/sml/types/merging_error.hpp"
 #include "dogen/sml/io/qname_io.hpp"
 #include "dogen/sml/io/nested_qname_io.hpp"
-#include "dogen/sml/io/property_io.hpp"
 #include "dogen/sml/io/model_io.hpp"
 #include "dogen/sml/types/merger.hpp"
 
diff --git a/projects/sml/src/types/meta_data_tagger.cpp b/projects/sml/src/types/meta_data_tagger.cpp
index 286bd47..2de74f8 100644
--- a/projects/sml/src/types/meta_data_tagger.cpp
+++ b/projects/sml/src/types/meta_data_tagger.cpp
@@ -592,27 +592,24 @@ void meta_data_tagger::tag(abstract_object& o) const {
     writer.add_if_key_not_found(tags::cpp::types::is_simple_type,
         tags::bool_false);
 
-    if (o.original_parent_name()) {
-        const auto opn(*o.original_parent_name());
-        writer.add_if_key_not_found(tags::original_parent_name,
-            opn.simple_name());
-
-        const auto i(context_->model().objects().find(opn));
-        if (i == context_->model().objects().end()) {
-            BOOST_LOG_SEV(lg, error) << original_parent_not_found << opn;
-            BOOST_THROW_EXCEPTION(meta_data_error(original_parent_not_found +
-                    opn.simple_name()));
-        }
-
-        writer.add_if_key_not_found(tags::is_original_parent_visitable,
-            i->second->is_visitable() ? tags::bool_true : tags::bool_false);
-
-        writer.add_if_key_not_found(tags::cpp::types::generate_accept,
-            i->second->is_visitable() ? tags::bool_true : tags::bool_false);
+    const auto i(o.relationships().find(relationship_types::original_parents));
+    // FIXME:
+    if (i != o.relationships().end()) {
+        for (const auto& opn : i->second) {
+            const auto j(context_->model().objects().find(opn));
+            if (j == context_->model().objects().end()) {
+                BOOST_LOG_SEV(lg, error) << original_parent_not_found << opn;
+                BOOST_THROW_EXCEPTION(meta_data_error(
+                        original_parent_not_found + opn.simple_name()));
+            }
+
+            writer.add_if_key_not_found(tags::cpp::types::generate_accept,
+                j->second->is_visitable() ? tags::bool_true : tags::bool_false);
 
-        writer.add_if_key_not_found(
-            tags::cpp::types::qualified_original_parent_name,
-            cpp_qualified_name(opn));
+            writer.add_if_key_not_found(
+                tags::cpp::types::qualified_original_parent_name,
+                cpp_qualified_name(opn));
+        }
     }
 
     writer.add_if_key_not_found(tags::cpp::types::generate_accept,
diff --git a/projects/sml/src/types/property_cache.cpp b/projects/sml/src/types/property_cache.cpp
deleted file mode 100644
index 8c15f54..0000000
--- a/projects/sml/src/types/property_cache.cpp
+++ /dev/null
@@ -1,90 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#include <boost/throw_exception.hpp>
-#include "dogen/utility/log/logger.hpp"
-#include "dogen/sml/types/cache_error.hpp"
-#include "dogen/sml/types/property_cache.hpp"
-
-using namespace dogen::utility::log;
-
-namespace {
-
-auto lg(logger_factory("om_formatters.modeline_formatter"));
-const std::string not_populated("Attempt to query cache without populating");
-
-}
-
-namespace dogen {
-namespace sml {
-
-property_cache::property_cache() : is_populated_(false) { }
-
-void property_cache::populate(const model& m) {
-    is_populated_ = true;
-    for (const auto& pair : m.objects()) {
-        const auto& o(*pair.second);
-        local_properties_.insert(std::make_pair(o.name(), o.properties()));
-    }
-}
-
-bool property_cache::is_populated() const {
-    return is_populated_;
-}
-
-void property_cache::ensure_populated() const {
-    if (!is_populated()) {
-        BOOST_LOG_SEV(lg, error) << not_populated;
-        BOOST_THROW_EXCEPTION(cache_error(not_populated));
-    }
-}
-
-std::list<property>
-property_cache::get_all_properties(const abstract_object& o) const {
-    ensure_populated();
-    const auto i(all_properties_.find(o.name()));
-    if (i != all_properties_.end())
-        return i->second;
-    return std::list<property>{};
-}
-
-std::list<property>
-property_cache::get_local_properties(const abstract_object& o) const {
-    ensure_populated();
-    const auto i(local_properties_.find(o.name()));
-    if (i != local_properties_.end())
-        return i->second;
-    return std::list<property>{};
-}
-
-std::unordered_map<qname, std::list<property> >
-property_cache::get_inehrited_properties(const abstract_object& o) const {
-    ensure_populated();
-    std::unordered_map<qname, std::list<property> > r;
-
-    if (o.parent_name()) {
-        const auto i(inherited_properties_.find(*o.parent_name()));
-        if (i != inherited_properties_.end())
-            r.insert(std::make_pair(*o.parent_name(), i->second));
-    }
-    return r;
-}
-
-} }
diff --git a/projects/sml/src/types/property_cache_interface.cpp b/projects/sml/src/types/property_cache_interface.cpp
deleted file mode 100644
index 989b1e8..0000000
--- a/projects/sml/src/types/property_cache_interface.cpp
+++ /dev/null
@@ -1,28 +0,0 @@
-/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * Copyright (C) 2012 Kitanda <info@kitanda.co.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
- * MA 02110-1301, USA.
- *
- */
-#include "dogen/sml/types/property_cache_interface.hpp"
-
-namespace dogen {
-namespace sml {
-
-property_cache_interface::~property_cache_interface() noexcept { }
-
-} }
diff --git a/projects/sml/src/types/repository.cpp b/projects/sml/src/types/repository.cpp
index 0c0b90b..fdd1011 100644
--- a/projects/sml/src/types/repository.cpp
+++ b/projects/sml/src/types/repository.cpp
@@ -31,37 +31,39 @@ repository::repository(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
-    const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts)
+    const bool is_fluent)
     : dogen::sml::abstract_object(documentation,
       meta_data,
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
-      is_fluent,
-      modeled_concepts) { }
+      is_fluent) { }
 
 void repository::to_stream(std::ostream& s) const {
     s << " { "
diff --git a/projects/sml/src/types/resolver.cpp b/projects/sml/src/types/resolver.cpp
index 6d88d62..5572ead 100644
--- a/projects/sml/src/types/resolver.cpp
+++ b/projects/sml/src/types/resolver.cpp
@@ -99,9 +99,11 @@ expand_concept_hierarchy(const qname& qn, std::list<qname>& concepts) const {
 }
 
 void resolver::validate_inheritance_graph(const abstract_object& ao) const {
-    auto parent(ao.parent_name());
-    while (parent) {
-        qname pqn(*parent);
+    const auto i(ao.relationships().find(relationship_types::parents));
+    if (i == ao.relationships().end() || i->second.empty())
+        return;
+
+    for (const auto& pqn : i->second) {
         const auto i(model_.objects().find(pqn));
         if (i == model_.objects().end()) {
             std::ostringstream s;
@@ -111,7 +113,10 @@ void resolver::validate_inheritance_graph(const abstract_object& ao) const {
             BOOST_LOG_SEV(lg, error) << s.str();
             BOOST_THROW_EXCEPTION(resolution_error(s.str()));
         }
-        parent = i->second->parent_name();
+
+        // circular relationships should have been picked up by the
+        // graph during transformation.
+        validate_inheritance_graph(*i->second);
     }
 }
 
@@ -263,7 +268,7 @@ void resolver::resolve_concepts() {
         if (c.generation_type() == generation_types::no_generation)
             continue;
 
-        resolve_properties(c.name(), c.properties());
+        resolve_properties(c.name(), c.local_properties());
         validate_refinements(c);
     }
 }
@@ -279,10 +284,12 @@ void resolver::resolve_objects() {
             continue;
 
         validate_inheritance_graph(o);
-        resolve_properties(o.name(), o.properties());
+        resolve_properties(o.name(), o.local_properties());
         resolve_operations(o.name(), o.operations());
 
-        if (o.modeled_concepts().empty())
+        const auto rt(relationship_types::modeled_concepts);
+        const auto i(o.relationships().find(rt));
+        if (i == o.relationships().end() || i->second.empty())
             continue;
 
         /*
@@ -292,12 +299,12 @@ void resolver::resolve_objects() {
          * with other concepts.
          */
         std::list<qname> expanded_modeled_concepts;
-        for (const auto& qn : o.modeled_concepts())
+        for (const auto& qn : i->second)
             expand_concept_hierarchy(qn, expanded_modeled_concepts);
 
-        o.modeled_concepts().clear();
+        i->second.clear();
         for (const auto& qn : expanded_modeled_concepts)
-            o.modeled_concepts().push_back(qn);
+            i->second.push_back(qn);
     }
 
     /*
@@ -308,33 +315,50 @@ void resolver::resolve_objects() {
     for (auto& pair : model_.objects()) {
         auto& o(*pair.second);
 
-        if (o.modeled_concepts().empty())
+        const auto rt(relationship_types::modeled_concepts);
+        const auto i(o.relationships().find(rt));
+        if (i == o.relationships().end() || i->second.empty())
             continue;
 
         BOOST_LOG_SEV(lg, debug) << "Resolving concepts for type: " << o.name();
         std::set<qname> mc;
-        for (const auto& qn : o.modeled_concepts())
+        for (const auto& qn : i->second)
             mc.insert(qn);
 
         std::set<qname> pmc;
-        auto parent(o.parent_name());
-        while (parent) {
-            qname pqn(*parent);
-            const auto i(model_.objects().find(pqn));
-            for (const auto& qn : i->second->modeled_concepts())
+        const auto j(o.relationships().find(relationship_types::parents));
+        if (j == o.relationships().end() || j->second.empty())
+            continue;
+
+        for (const auto& pqn : j->second) {
+            const auto k(model_.objects().find(pqn));
+            if (k == model_.objects().end()) {
+                std::ostringstream s;
+                s << orphan_object << ": " << o.name().simple_name()
+                  << ". parent: " << pqn.simple_name();
+
+                BOOST_LOG_SEV(lg, error) << s.str();
+                BOOST_THROW_EXCEPTION(resolution_error(s.str()));
+            }
+
+            const auto m(o.relationships().find(rt));
+            if (m == o.relationships().end())
+                continue;
+
+            for (const auto& qn : m->second)
                 pmc.insert(qn);
-            parent = i->second->parent_name();
         }
 
         std::set<qname> result;
         std::set_difference(mc.begin(), mc.end(), pmc.begin(), pmc.end(),
             std::inserter(result, result.end()));
 
-        auto tmp(o.modeled_concepts());
-        o.modeled_concepts().clear();
+        // FIXME: can we not just push the result of the set difference?
+        auto tmp(i->second);
+        i->second.clear();
         for (const auto& qn : tmp) {
             if (result.find(qn) != result.end())
-                o.modeled_concepts().push_back(qn);
+                i->second.push_back(qn);
         }
     }
 }
diff --git a/projects/sml/src/types/service.cpp b/projects/sml/src/types/service.cpp
index 37e7cca..aa6b58e 100644
--- a/projects/sml/src/types/service.cpp
+++ b/projects/sml/src/types/service.cpp
@@ -35,38 +35,40 @@ service::service(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
     const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts,
     const dogen::sml::service_types& type)
     : dogen::sml::abstract_object(documentation,
       meta_data,
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
-      is_fluent,
-      modeled_concepts),
+      is_fluent),
       type_(type) { }
 
 void service::to_stream(std::ostream& s) const {
diff --git a/projects/sml/src/types/tags.cpp b/projects/sml/src/types/tags.cpp
index ceb8c99..14aa884 100644
--- a/projects/sml/src/types/tags.cpp
+++ b/projects/sml/src/types/tags.cpp
@@ -32,9 +32,6 @@ const std::string tags::modeline_group_name("MODELINE_GROUP");
 const std::string tags::comment("COMMENT");
 const std::string tags::identity_attribute("IDENTITY_ATTRIBUTE");
 const std::string tags::generate_preamble("generate_preamble");
-const std::string tags::original_parent_name("original_parent_name");
-const std::string tags::is_original_parent_visitable(
-    "is_original_parent_visitable");
 const std::string tags::is_final("is_final");
 
 const std::string tags::bool_true("true");
diff --git a/projects/sml/src/types/value_object.cpp b/projects/sml/src/types/value_object.cpp
index 9562372..aa0452a 100644
--- a/projects/sml/src/types/value_object.cpp
+++ b/projects/sml/src/types/value_object.cpp
@@ -35,38 +35,40 @@ value_object::value_object(
     const dogen::sml::qname& name,
     const dogen::sml::generation_types& generation_type,
     const dogen::sml::origin_types& origin_type,
-    const std::list<dogen::sml::property>& properties,
+    const std::list<dogen::sml::property>& all_properties,
+    const std::list<dogen::sml::property>& local_properties,
+    const std::unordered_map<dogen::sml::qname, std::list<dogen::sml::property> >& inherited_properties,
     const std::list<dogen::sml::operation>& operations,
-    const boost::optional<dogen::sml::qname>& parent_name,
-    const boost::optional<dogen::sml::qname>& original_parent_name,
-    const std::list<dogen::sml::qname>& leaves,
-    const bool is_parent,
+    const std::unordered_map<dogen::sml::relationship_types, std::list<dogen::sml::qname> >& relationships,
     const unsigned int number_of_type_arguments,
+    const bool is_parent,
+    const bool is_child,
     const bool is_visitable,
+    const bool is_inheritance_root,
     const bool is_immutable,
     const bool is_versioned,
     const bool is_comparable,
     const bool is_fluent,
-    const std::list<dogen::sml::qname>& modeled_concepts,
     const dogen::sml::value_object_types& type)
     : dogen::sml::abstract_object(documentation,
       meta_data,
       name,
       generation_type,
       origin_type,
-      properties,
+      all_properties,
+      local_properties,
+      inherited_properties,
       operations,
-      parent_name,
-      original_parent_name,
-      leaves,
-      is_parent,
+      relationships,
       number_of_type_arguments,
+      is_parent,
+      is_child,
       is_visitable,
+      is_inheritance_root,
       is_immutable,
       is_versioned,
       is_comparable,
-      is_fluent,
-      modeled_concepts),
+      is_fluent),
       type_(type) { }
 
 void value_object::to_stream(std::ostream& s) const {
diff --git a/test_data/dia_sml/expected/all_primitives.smlxml b/test_data/dia_sml/expected/all_primitives.smlxml
index 17ca224..778f1a9 100644
--- a/test_data/dia_sml/expected/all_primitives.smlxml
+++ b/test_data/dia_sml/expected/all_primitives.smlxml
@@ -95,7 +95,11 @@
 								<generation_type>1</generation_type>
 								<origin_type>1</origin_type>
 							</type>
-							<properties class_id="24" tracking_level="0" version="0">
+							<all_properties class_id="24" tracking_level="0" version="0">
+								<count>0</count>
+								<item_version>0</item_version>
+							</all_properties>
+							<local_properties>
 								<count>13</count>
 								<item_version>0</item_version>
 								<item class_id="25" tracking_level="0" version="0">
@@ -501,32 +505,30 @@
 									<is_immutable>0</is_immutable>
 									<is_fluent>0</is_fluent>
 								</item>
-							</properties>
-							<operations class_id="28" tracking_level="0" version="0">
+							</local_properties>
+							<inherited_properties class_id="28" tracking_level="0" version="0">
+								<count>0</count>
+								<bucket_count>11</bucket_count>
+								<item_version>0</item_version>
+							</inherited_properties>
+							<operations class_id="29" tracking_level="0" version="0">
 								<count>0</count>
 								<item_version>0</item_version>
 							</operations>
-							<parent_name class_id="29" tracking_level="0" version="0">
-								<initialized>0</initialized>
-							</parent_name>
-							<original_parent_name>
-								<initialized>0</initialized>
-							</original_parent_name>
-							<leaves class_id="30" tracking_level="0" version="0">
+							<relationships class_id="30" tracking_level="0" version="0">
 								<count>0</count>
+								<bucket_count>11</bucket_count>
 								<item_version>0</item_version>
-							</leaves>
-							<is_parent>0</is_parent>
+							</relationships>
 							<number_of_type_arguments>0</number_of_type_arguments>
+							<is_parent>0</is_parent>
+							<is_child>0</is_child>
 							<is_visitable>0</is_visitable>
+							<is_inheritance_root>0</is_inheritance_root>
 							<is_immutable>0</is_immutable>
 							<is_versioned>0</is_versioned>
 							<is_comparable>0</is_comparable>
 							<is_fluent>0</is_fluent>
-							<modeled_concepts>
-								<count>0</count>
-								<item_version>0</item_version>
-							</modeled_concepts>
 						</abstract_object>
 						<is_aggregate_root>0</is_aggregate_root>
 						<identity>
diff --git a/test_data/dia_sml/expected/boost_model.smlxml b/test_data/dia_sml/expected/boost_model.smlxml
index 33c9e6d..7f440d7 100644
--- a/test_data/dia_sml/expected/boost_model.smlxml
+++ b/test_data/dia_sml/expected/boost_model.smlxml
@@ -58,21 +58,9 @@
 		</item>
 	</references>
 	<leaves class_id="14" tracking_level="0" version="0">
-		<count>1</count>
+		<count>0</count>
 		<bucket_count>11</bucket_count>
 		<item_version>0</item_version>
-		<item>
-			<model_name>boost_model</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>class_derived</simple_name>
-		</item>
 	</leaves>
 	<modules class_id="15" tracking_level="0" version="0">
 		<count>1</count>
@@ -176,7 +164,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="27" tracking_level="0" version="0">
+						<all_properties class_id="27" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>7</count>
 							<item_version>0</item_version>
 							<item class_id="28" tracking_level="0" version="0">
@@ -588,32 +580,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="31" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="31" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="32" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="32" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="33" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -657,7 +647,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -691,32 +685,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -760,7 +752,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>6</count>
 							<item_version>0</item_version>
 							<item>
@@ -1012,32 +1008,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1081,7 +1075,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1116,32 +1114,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1185,7 +1181,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1219,44 +1219,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>1</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>boost_model</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>class_derived</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1300,7 +1286,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1334,58 +1324,49 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>boost_model</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>class_base</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>boost_model</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item class_id="34" tracking_level="0" version="0">
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>class_base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>boost_model</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>class_base</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1429,7 +1410,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>4</count>
 							<item_version>0</item_version>
 							<item>
@@ -1652,32 +1637,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1721,7 +1704,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>2</count>
 							<item_version>0</item_version>
 							<item>
@@ -1807,32 +1794,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1876,7 +1861,11 @@
 							<generation_type>2</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>3</count>
 							<item_version>0</item_version>
 							<item>
@@ -1979,32 +1968,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2050,7 +2037,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>2</count>
 							<item_version>0</item_version>
 							<item>
@@ -2134,32 +2125,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2203,7 +2192,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>3</count>
 							<item_version>0</item_version>
 							<item>
@@ -2470,32 +2463,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/class_in_a_package.smlxml b/test_data/dia_sml/expected/class_in_a_package.smlxml
index f354b88..fd49c19 100644
--- a/test_data/dia_sml/expected/class_in_a_package.smlxml
+++ b/test_data/dia_sml/expected/class_in_a_package.smlxml
@@ -137,7 +137,11 @@
 								<generation_type>1</generation_type>
 								<origin_type>1</origin_type>
 							</type>
-							<properties class_id="27" tracking_level="0" version="0">
+							<all_properties class_id="27" tracking_level="0" version="0">
+								<count>0</count>
+								<item_version>0</item_version>
+							</all_properties>
+							<local_properties>
 								<count>2</count>
 								<item_version>0</item_version>
 								<item class_id="28" tracking_level="0" version="0">
@@ -202,32 +206,30 @@
 									<is_immutable>0</is_immutable>
 									<is_fluent>0</is_fluent>
 								</item>
-							</properties>
-							<operations class_id="31" tracking_level="0" version="0">
+							</local_properties>
+							<inherited_properties class_id="31" tracking_level="0" version="0">
+								<count>0</count>
+								<bucket_count>11</bucket_count>
+								<item_version>0</item_version>
+							</inherited_properties>
+							<operations class_id="32" tracking_level="0" version="0">
 								<count>0</count>
 								<item_version>0</item_version>
 							</operations>
-							<parent_name class_id="32" tracking_level="0" version="0">
-								<initialized>0</initialized>
-							</parent_name>
-							<original_parent_name>
-								<initialized>0</initialized>
-							</original_parent_name>
-							<leaves>
+							<relationships class_id="33" tracking_level="0" version="0">
 								<count>0</count>
+								<bucket_count>11</bucket_count>
 								<item_version>0</item_version>
-							</leaves>
-							<is_parent>0</is_parent>
+							</relationships>
 							<number_of_type_arguments>0</number_of_type_arguments>
+							<is_parent>0</is_parent>
+							<is_child>0</is_child>
 							<is_visitable>0</is_visitable>
+							<is_inheritance_root>0</is_inheritance_root>
 							<is_immutable>0</is_immutable>
 							<is_versioned>0</is_versioned>
 							<is_comparable>0</is_comparable>
 							<is_fluent>0</is_fluent>
-							<modeled_concepts>
-								<count>0</count>
-								<item_version>0</item_version>
-							</modeled_concepts>
 						</abstract_object>
 						<is_aggregate_root>0</is_aggregate_root>
 						<identity>
diff --git a/test_data/dia_sml/expected/class_without_attributes.smlxml b/test_data/dia_sml/expected/class_without_attributes.smlxml
index b9c3bf8..4577512 100644
--- a/test_data/dia_sml/expected/class_without_attributes.smlxml
+++ b/test_data/dia_sml/expected/class_without_attributes.smlxml
@@ -136,35 +136,37 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="26" tracking_level="0" version="0">
+						<all_properties class_id="26" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
-						<operations class_id="27" tracking_level="0" version="0">
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties class_id="27" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="28" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="28" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="29" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/class_without_package.smlxml b/test_data/dia_sml/expected/class_without_package.smlxml
index e137975..a10375b 100644
--- a/test_data/dia_sml/expected/class_without_package.smlxml
+++ b/test_data/dia_sml/expected/class_without_package.smlxml
@@ -94,7 +94,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="23" tracking_level="0" version="0">
+						<all_properties class_id="23" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item class_id="24" tracking_level="0" version="0">
@@ -128,32 +132,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="27" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="27" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="28" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="28" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves class_id="29" tracking_level="0" version="0">
+						<relationships class_id="29" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/classes_inout_package.smlxml b/test_data/dia_sml/expected/classes_inout_package.smlxml
index 71a7b24..a7c4c12 100644
--- a/test_data/dia_sml/expected/classes_inout_package.smlxml
+++ b/test_data/dia_sml/expected/classes_inout_package.smlxml
@@ -134,7 +134,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="26" tracking_level="0" version="0">
+						<all_properties class_id="26" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item class_id="27" tracking_level="0" version="0">
@@ -168,32 +172,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="30" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="30" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="31" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="31" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="32" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -239,7 +241,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -273,32 +279,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/classes_without_package.smlxml b/test_data/dia_sml/expected/classes_without_package.smlxml
index c40b957..a428b4c 100644
--- a/test_data/dia_sml/expected/classes_without_package.smlxml
+++ b/test_data/dia_sml/expected/classes_without_package.smlxml
@@ -94,7 +94,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="23" tracking_level="0" version="0">
+						<all_properties class_id="23" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item class_id="24" tracking_level="0" version="0">
@@ -128,32 +132,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="27" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="27" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="28" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="28" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves class_id="29" tracking_level="0" version="0">
+						<relationships class_id="29" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -197,7 +199,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -231,32 +237,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -300,7 +304,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -334,32 +342,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -403,7 +409,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -437,32 +447,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -506,7 +514,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -540,32 +552,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/comments.smlxml b/test_data/dia_sml/expected/comments.smlxml
index 7e77332..53c3a9b 100644
--- a/test_data/dia_sml/expected/comments.smlxml
+++ b/test_data/dia_sml/expected/comments.smlxml
@@ -217,35 +217,37 @@ third line with &quot;quote&quot;
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="27" tracking_level="0" version="0">
+						<all_properties class_id="27" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
-						<operations class_id="28" tracking_level="0" version="0">
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties class_id="28" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="29" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="29" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="30" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -290,10 +292,14 @@ third line with &quot;quote&quot;
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>3</count>
 							<item_version>0</item_version>
-							<item class_id="30" tracking_level="0" version="0">
+							<item class_id="31" tracking_level="0" version="0">
 								<documentation>another brief comment
 </documentation>
 								<meta_data>
@@ -302,7 +308,7 @@ third line with &quot;quote&quot;
 									<data></data>
 								</meta_data>
 								<name>prop_0</name>
-								<type class_id="31" tracking_level="0" version="0">
+								<type class_id="32" tracking_level="0" version="0">
 									<type>
 										<model_name></model_name>
 										<external_module_path>
@@ -315,7 +321,7 @@ third line with &quot;quote&quot;
 										</module_path>
 										<simple_name>int</simple_name>
 									</type>
-									<children class_id="32" tracking_level="0" version="0">
+									<children class_id="33" tracking_level="0" version="0">
 										<count>0</count>
 										<item_version>0</item_version>
 									</children>
@@ -390,32 +396,30 @@ a second line
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/enumeration.smlxml b/test_data/dia_sml/expected/enumeration.smlxml
index 64713d7..45846e1 100644
--- a/test_data/dia_sml/expected/enumeration.smlxml
+++ b/test_data/dia_sml/expected/enumeration.smlxml
@@ -377,7 +377,11 @@ this is a long comment
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="29" tracking_level="0" version="0">
+						<all_properties class_id="29" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>3</count>
 							<item_version>0</item_version>
 							<item class_id="30" tracking_level="0" version="0">
@@ -474,32 +478,30 @@ this is a long comment
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="33" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="33" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="34" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="34" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="35" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/exception.smlxml b/test_data/dia_sml/expected/exception.smlxml
index 6780955..4bb6550 100644
--- a/test_data/dia_sml/expected/exception.smlxml
+++ b/test_data/dia_sml/expected/exception.smlxml
@@ -134,7 +134,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="26" tracking_level="0" version="0">
+						<all_properties class_id="26" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item class_id="27" tracking_level="0" version="0">
@@ -168,32 +172,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="30" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="30" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="31" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="31" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="32" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -239,35 +241,37 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</properties>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>4</type>
 				</px>
@@ -312,35 +316,37 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>4</type>
 				</px>
diff --git a/test_data/dia_sml/expected/std_model.smlxml b/test_data/dia_sml/expected/std_model.smlxml
index 4db63f9..3798991 100644
--- a/test_data/dia_sml/expected/std_model.smlxml
+++ b/test_data/dia_sml/expected/std_model.smlxml
@@ -43,21 +43,9 @@
 		</item>
 	</references>
 	<leaves class_id="14" tracking_level="0" version="0">
-		<count>1</count>
+		<count>0</count>
 		<bucket_count>11</bucket_count>
 		<item_version>0</item_version>
-		<item>
-			<model_name>std_model</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>derived</simple_name>
-		</item>
 	</leaves>
 	<modules class_id="15" tracking_level="0" version="0">
 		<count>1</count>
@@ -161,7 +149,11 @@
 							<generation_type>2</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="27" tracking_level="0" version="0">
+						<all_properties class_id="27" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>4</count>
 							<item_version>0</item_version>
 							<item class_id="28" tracking_level="0" version="0">
@@ -345,32 +337,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="31" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="31" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="32" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="32" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="33" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -414,7 +404,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>8</count>
 							<item_version>0</item_version>
 							<item>
@@ -665,32 +659,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -734,7 +726,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>6</count>
 							<item_version>0</item_version>
 							<item>
@@ -1057,32 +1053,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1126,7 +1120,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>4</count>
 							<item_version>0</item_version>
 							<item>
@@ -1445,32 +1443,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1514,7 +1510,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1567,44 +1567,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>1</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>std_model</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>derived</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1625,7 +1611,7 @@
 			</first>
 			<second>
 				<px class_id="3" tracking_level="1" version="0" object_id="_5">
-					<abstract_entity class_id="33" tracking_level="0" version="0">
+					<abstract_entity class_id="34" tracking_level="0" version="0">
 						<abstract_object>
 							<type>
 								<documentation></documentation>
@@ -1649,7 +1635,11 @@
 								<generation_type>1</generation_type>
 								<origin_type>1</origin_type>
 							</type>
-							<properties>
+							<all_properties>
+								<count>0</count>
+								<item_version>0</item_version>
+							</all_properties>
+							<local_properties>
 								<count>2</count>
 								<item_version>0</item_version>
 								<item>
@@ -1657,7 +1647,7 @@
 									<meta_data>
 										<count>1</count>
 										<item_version>0</item_version>
-										<item class_id="34" tracking_level="0" version="0">
+										<item class_id="35" tracking_level="0" version="0">
 											<first>IDENTITY_ATTRIBUTE</first>
 											<second>
 												<count>0</count>
@@ -1723,32 +1713,30 @@
 									<is_immutable>0</is_immutable>
 									<is_fluent>0</is_fluent>
 								</item>
-							</properties>
+							</local_properties>
+							<inherited_properties>
+								<count>0</count>
+								<bucket_count>11</bucket_count>
+								<item_version>0</item_version>
+							</inherited_properties>
 							<operations>
 								<count>0</count>
 								<item_version>0</item_version>
 							</operations>
-							<parent_name>
-								<initialized>0</initialized>
-							</parent_name>
-							<original_parent_name>
-								<initialized>0</initialized>
-							</original_parent_name>
-							<leaves>
+							<relationships>
 								<count>0</count>
+								<bucket_count>11</bucket_count>
 								<item_version>0</item_version>
-							</leaves>
-							<is_parent>0</is_parent>
+							</relationships>
 							<number_of_type_arguments>0</number_of_type_arguments>
+							<is_parent>0</is_parent>
+							<is_child>0</is_child>
 							<is_visitable>0</is_visitable>
+							<is_inheritance_root>0</is_inheritance_root>
 							<is_immutable>0</is_immutable>
 							<is_versioned>1</is_versioned>
 							<is_comparable>0</is_comparable>
 							<is_fluent>0</is_fluent>
-							<modeled_concepts>
-								<count>0</count>
-								<item_version>0</item_version>
-							</modeled_concepts>
 						</abstract_object>
 						<is_aggregate_root>0</is_aggregate_root>
 						<identity>
@@ -1807,7 +1795,7 @@
 						</module_path>
 						<simple_name></simple_name>
 					</unversioned_key>
-					<versioned_key>
+					<versioned_key class_id="36" tracking_level="0" version="0">
 						<initialized>0</initialized>
 					</versioned_key>
 				</px>
@@ -1853,7 +1841,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>4</count>
 							<item_version>0</item_version>
 							<item>
@@ -2037,32 +2029,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2106,7 +2096,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>3</count>
 							<item_version>0</item_version>
 							<item>
@@ -2317,32 +2311,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2386,7 +2378,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>3</count>
 							<item_version>0</item_version>
 							<item>
@@ -2615,32 +2611,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2684,7 +2678,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>6</count>
 							<item_version>0</item_version>
 							<item>
@@ -3007,32 +3005,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -3076,7 +3072,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>2</count>
 							<item_version>0</item_version>
 							<item>
@@ -3180,32 +3180,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -3249,7 +3247,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>6</count>
 							<item_version>0</item_version>
 							<item>
@@ -3572,32 +3574,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -3641,7 +3641,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -3695,58 +3699,49 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>std_model</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>std_model</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item class_id="37" tracking_level="0" version="0">
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>std_model</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>base</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/trivial_inheritance.smlxml b/test_data/dia_sml/expected/trivial_inheritance.smlxml
index b867a5f..b7451bc 100644
--- a/test_data/dia_sml/expected/trivial_inheritance.smlxml
+++ b/test_data/dia_sml/expected/trivial_inheritance.smlxml
@@ -56,156 +56,9 @@ in the context of inheritance.
 		</item>
 	</references>
 	<leaves class_id="15" tracking_level="0" version="0">
-		<count>12</count>
-		<bucket_count>23</bucket_count>
+		<count>0</count>
+		<bucket_count>11</bucket_count>
 		<item_version>0</item_version>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>move_ctor_empty_descendant</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>1</count>
-				<item_version>0</item_version>
-				<item>pkg1</item>
-			</module_path>
-			<simple_name>child</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>child_of_a_child2</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>child_without_members</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>second_child_without_members</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>child_of_a_child1</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>1</count>
-				<item_version>0</item_version>
-				<item>pkg4</item>
-			</module_path>
-			<simple_name>child</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>move_ctor_descendant</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>1</count>
-				<item_version>0</item_version>
-				<item>pkg3</item>
-			</module_path>
-			<simple_name>child</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>descendant2</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>descendant3</simple_name>
-		</item>
-		<item>
-			<model_name>trivial_inheritance</model_name>
-			<external_module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</external_module_path>
-			<module_path>
-				<count>0</count>
-				<item_version>0</item_version>
-			</module_path>
-			<simple_name>child_with_members</simple_name>
-		</item>
 	</leaves>
 	<modules class_id="16" tracking_level="0" version="0">
 		<count>4</count>
@@ -431,7 +284,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="28" tracking_level="0" version="0">
+						<all_properties class_id="28" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item class_id="29" tracking_level="0" version="0">
@@ -465,45 +322,30 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="32" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="32" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="33" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="33" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>1</count>
+						<relationships class_id="34" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>1</count>
-									<item_version>0</item_version>
-									<item>pkg1</item>
-								</module_path>
-								<simple_name>child</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -548,61 +390,56 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>move_ctor_base</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item class_id="35" tracking_level="0" version="0">
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>move_ctor_base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>move_ctor_base</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -648,7 +485,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -682,58 +523,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_outside</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_outside</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>parent_outside</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -777,7 +609,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -811,82 +647,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_with_members</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_with_members</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>2</count>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
 							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>child_of_a_child1</simple_name>
-							</item>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>child_of_a_child2</simple_name>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>parent_with_members</simple_name>
+									</item>
+								</second>
 							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -930,7 +733,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -964,58 +771,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_without_members</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_without_members</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>parent_without_members</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1061,7 +859,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1095,45 +897,30 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>1</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>1</count>
-									<item_version>0</item_version>
-									<item>pkg3</item>
-								</module_path>
-								<simple_name>child</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1177,61 +964,56 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</properties>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_with_members</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_with_members</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>parent_with_members</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1275,61 +1057,56 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_without_members</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_without_members</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>parent_without_members</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1373,7 +1150,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1407,58 +1188,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>third_child_with_members</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_with_members</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>third_child_with_members</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1504,7 +1276,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1538,60 +1314,50 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>1</count>
-									<item_version>0</item_version>
-									<item>pkg1</item>
-								</module_path>
-								<simple_name>parent</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
+							<item>
+								<first>2</first>
+								<second>
 									<count>1</count>
 									<item_version>0</item_version>
-									<item>pkg1</item>
-								</module_path>
-								<simple_name>parent</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>1</count>
+											<item_version>0</item_version>
+											<item>pkg1</item>
+										</module_path>
+										<simple_name>parent</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1635,7 +1401,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1669,68 +1439,30 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>3</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>second_child_without_members</simple_name>
-							</item>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>child_of_a_child1</simple_name>
-							</item>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>child_of_a_child2</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1774,61 +1506,56 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>third_child_with_members</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>parent_with_members</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>third_child_with_members</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -1872,7 +1599,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -1906,58 +1637,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>base</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2002,7 +1724,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -2038,58 +1764,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>move_ctor_base</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>move_ctor_base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>move_ctor_base</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2133,7 +1850,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -2167,45 +1888,30 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations>
+						</local_properties>
+						<inherited_properties>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>1</count>
-							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>1</count>
-									<item_version>0</item_version>
-									<item>pkg4</item>
-								</module_path>
-								<simple_name>child</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</inherited_properties>
+						<operations>
+							<count>0</count>
+							<item_version>0</item_version>
+						</operations>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2249,35 +1955,37 @@ in the context of inheritance.
 							<generation_type>2</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</properties>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2321,35 +2029,37 @@ in the context of inheritance.
 							<generation_type>2</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</properties>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2393,59 +2103,37 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</local_properties>
+						<inherited_properties>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</properties>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>2</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>descendant2</simple_name>
-							</item>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>descendant3</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>1</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2489,59 +2177,37 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>2</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>child_without_members</simple_name>
-							</item>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>child_with_members</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2585,73 +2251,56 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</properties>
-						<operations>
+						</all_properties>
+						<local_properties>
 							<count>0</count>
 							<item_version>0</item_version>
-						</operations>
-						<parent_name>
-							<initialized>1</initialized>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						</inherited_properties>
+						<operations>
+							<count>0</count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
+						</operations>
+						<relationships>
 							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
 							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>descendant3</simple_name>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>base</simple_name>
+									</item>
+								</second>
 							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2695,7 +2344,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -2729,58 +2382,49 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>descendant1</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
+							<item>
+								<first>2</first>
+								<second>
+									<count>1</count>
 									<item_version>0</item_version>
-								</module_path>
-								<simple_name>base</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</module_path>
+										<simple_name>descendant1</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2826,7 +2470,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -2860,60 +2508,50 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>1</initialized>
-							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>1</count>
-									<item_version>0</item_version>
-									<item>pkg2</item>
-								</module_path>
-								<simple_name>parent</simple_name>
-							</value>
-						</parent_name>
-						<original_parent_name>
-							<initialized>1</initialized>
+						<relationships>
+							<count>1</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<value>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
+							<item>
+								<first>2</first>
+								<second>
 									<count>1</count>
 									<item_version>0</item_version>
-									<item>pkg2</item>
-								</module_path>
-								<simple_name>parent</simple_name>
-							</value>
-						</original_parent_name>
-						<leaves>
-							<count>0</count>
-							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+									<item>
+										<model_name>trivial_inheritance</model_name>
+										<external_module_path>
+											<count>0</count>
+											<item_version>0</item_version>
+										</external_module_path>
+										<module_path>
+											<count>1</count>
+											<item_version>0</item_version>
+											<item>pkg2</item>
+										</module_path>
+										<simple_name>parent</simple_name>
+									</item>
+								</second>
+							</item>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>1</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -2958,7 +2596,11 @@ in the context of inheritance.
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -2994,56 +2636,30 @@ in the context of inheritance.
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
-							<count>2</count>
+						<relationships>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>move_ctor_descendant</simple_name>
-							</item>
-							<item>
-								<model_name>trivial_inheritance</model_name>
-								<external_module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</external_module_path>
-								<module_path>
-									<count>0</count>
-									<item_version>0</item_version>
-								</module_path>
-								<simple_name>move_ctor_empty_descendant</simple_name>
-							</item>
-						</leaves>
-						<is_parent>1</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>1</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
diff --git a/test_data/dia_sml/expected/two_layers_with_objects.smlxml b/test_data/dia_sml/expected/two_layers_with_objects.smlxml
index 8158077..33b2a62 100644
--- a/test_data/dia_sml/expected/two_layers_with_objects.smlxml
+++ b/test_data/dia_sml/expected/two_layers_with_objects.smlxml
@@ -176,7 +176,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties class_id="26" tracking_level="0" version="0">
+						<all_properties class_id="26" tracking_level="0" version="0">
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item class_id="27" tracking_level="0" version="0">
@@ -210,32 +214,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
-						<operations class_id="30" tracking_level="0" version="0">
+						</local_properties>
+						<inherited_properties class_id="30" tracking_level="0" version="0">
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
+						<operations class_id="31" tracking_level="0" version="0">
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name class_id="31" tracking_level="0" version="0">
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships class_id="32" tracking_level="0" version="0">
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
@@ -281,7 +283,11 @@
 							<generation_type>1</generation_type>
 							<origin_type>1</origin_type>
 						</type>
-						<properties>
+						<all_properties>
+							<count>0</count>
+							<item_version>0</item_version>
+						</all_properties>
+						<local_properties>
 							<count>1</count>
 							<item_version>0</item_version>
 							<item>
@@ -315,32 +321,30 @@
 								<is_immutable>0</is_immutable>
 								<is_fluent>0</is_fluent>
 							</item>
-						</properties>
+						</local_properties>
+						<inherited_properties>
+							<count>0</count>
+							<bucket_count>11</bucket_count>
+							<item_version>0</item_version>
+						</inherited_properties>
 						<operations>
 							<count>0</count>
 							<item_version>0</item_version>
 						</operations>
-						<parent_name>
-							<initialized>0</initialized>
-						</parent_name>
-						<original_parent_name>
-							<initialized>0</initialized>
-						</original_parent_name>
-						<leaves>
+						<relationships>
 							<count>0</count>
+							<bucket_count>11</bucket_count>
 							<item_version>0</item_version>
-						</leaves>
-						<is_parent>0</is_parent>
+						</relationships>
 						<number_of_type_arguments>0</number_of_type_arguments>
+						<is_parent>0</is_parent>
+						<is_child>0</is_child>
 						<is_visitable>0</is_visitable>
+						<is_inheritance_root>0</is_inheritance_root>
 						<is_immutable>0</is_immutable>
 						<is_versioned>0</is_versioned>
 						<is_comparable>0</is_comparable>
 						<is_fluent>0</is_fluent>
-						<modeled_concepts>
-							<count>0</count>
-							<item_version>0</item_version>
-						</modeled_concepts>
 					</abstract_object>
 					<type>1</type>
 				</px>
